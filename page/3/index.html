<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="theme-color" content="#222">
    <meta name="generator" content="Hexo 4.2.1">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16-next.png">
    <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#222">
    <meta name="msapplication-config" content="/images/favicon/browserconfig.xml">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
    <link rel="stylesheet" href="/lib/pace/pace-theme-mac-osx.min.css">
    <script src="/lib/pace/pace.min.js"></script>
    <script id="hexo-configurations">
        var NexT = window.NexT ||
        {};
        var CONFIG = {
            "hostname": "paynewu.com",
            "root": "/",
            "scheme": "Gemini",
            "version": "7.8.0",
            "exturl": false,
            "sidebar":
            {
                "position": "right",
                "width": 240,
                "display": "post",
                "padding": 18,
                "offset": 12,
                "onmobile": false
            },
            "copycode":
            {
                "enable": true,
                "show_result": true,
                "style": "mac"
            },
            "back2top":
            {
                "enable": true,
                "sidebar": false,
                "scrollpercent": true
            },
            "bookmark":
            {
                "enable": false,
                "color": "#222",
                "save": "auto"
            },
            "fancybox": false,
            "mediumzoom": true,
            "lazyload": false,
            "pangu": true,
            "comments":
            {
                "style": "tabs",
                "active": "valine",
                "storage": true,
                "lazyload": false,
                "nav": null
            },
            "algolia":
            {
                "hits":
                {
                    "per_page": 10
                },
                "labels":
                {
                    "input_placeholder": "Search for Posts",
                    "hits_empty": "We didn't find any results for the search: ${query}",
                    "hits_stats": "${hits} results found in ${time} ms"
                }
            },
            "localsearch":
            {
                "enable": true,
                "trigger": "auto",
                "top_n_per_article": 8,
                "unescape": false,
                "preload": false
            },
            "motion":
            {
                "enable": false,
                "async": false,
                "transition":
                {
                    "post_block": "bounceDownIn",
                    "post_header": "slideDownIn",
                    "post_body": "slideDownIn",
                    "coll_header": "slideLeftIn",
                    "sidebar": "slideUpIn"
                }
            },
            "path": "search.xml"
        };

    </script>
    <meta name="description" content="Talk is free，please state clearly">
    <meta property="og:type" content="website">
    <meta property="og:title" content="吴志鹏｜Payne-Wu">
    <meta property="og:url" content="https://paynewu.com/page/3/">
    <meta property="og:site_name" content="吴志鹏｜Payne-Wu">
    <meta property="og:description" content="Talk is free，please state clearly">
    <meta property="og:locale" content="zh_CN">
    <meta property="article:author" content="吴志鹏">
    <meta property="article:tag" content="吴志鹏">
    <meta property="article:tag" content="Payne">
    <meta property="article:tag" content="payne-wu">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="Golang">
    <meta property="article:tag" content="go">
    <meta property="article:tag" content="spider">
    <meta property="article:tag" content="crawler">
    <meta property="article:tag" content="js">
    <meta property="article:tag" content="爬虫">
    <meta property="article:tag" content=" CloudNative">
    <meta name="twitter:card" content="summary">
    <link rel="canonical" href="https://paynewu.com/page/3/">
    <script id="page-configurations">
        // https://hexo.io/docs/variables.html
        CONFIG.page = {
            sidebar: "",
            isHome: true,
            isPost: false,
            lang: 'zh-CN'
        };

    </script>
    <title>吴志鹏｜Payne-Wu</title>
    <meta name="google-site-verification" content="p_bIcnvirkFzG2dYKuNDivKD8-STet5W7D-01woA2fc" />
    <noscript>
        <style>
            .use-motion .brand,
            .use-motion .menu-item,
            .sidebar-inner,
            .use-motion .post-block,
            .use-motion .pagination,
            .use-motion .comments,
            .use-motion .post-header,
            .use-motion .post-body,
            .use-motion .collection-header
            {
                opacity: initial;
            }

            .use-motion .site-title,
            .use-motion .site-subtitle
            {
                opacity: initial;
                top: initial;
            }

            .use-motion .logo-line-before i
            {
                left: initial;
            }

            .use-motion .logo-line-after i
            {
                right: initial;
            }

        </style>
    </noscript>
    <link rel="alternate" href="/atom.xml" title="吴志鹏｜Payne-Wu" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
    <div class="container">
        <div class="headband"></div>
        <header class="header" itemscope itemtype="http://schema.org/WPHeader">
            <div class="header-inner">
                <div class="site-brand-container">
                    <div class="site-nav-toggle">
                        <div class="toggle" aria-label="切换导航栏">
                            <span class="toggle-line toggle-line-first"></span>
                            <span class="toggle-line toggle-line-middle"></span>
                            <span class="toggle-line toggle-line-last"></span>
                        </div>
                    </div>
                    <div class="site-meta">
                        <a href="/" class="brand" rel="start">
                            <span class="logo-line-before"><i></i></span>
                            <h1 class="site-title">吴志鹏｜Payne-Wu </h1>
                            <span class="logo-line-after"><i></i></span>
                        </a>
                    </div>
                    <div class="site-nav-right">
                        <div class="toggle popup-trigger">
                            <i class="fa fa-search fa-fw fa-lg"></i>
                        </div>
                    </div>
                </div>
                <nav class="site-nav">
                    <ul id="menu" class="main-menu menu">
                        <li class="menu-item menu-item-home">
                            <a href="/" rel="section">首页</a>
                        </li>
                        <li class="menu-item menu-item-archives">
                            <a href="/archives/" rel="section">文章列表</a>
                        </li>
                        <li class="menu-item menu-item-tags">
                            <a href="/tags/" rel="section">Tags Cloud</a>
                        </li>
                        <li class="menu-item menu-item-categories">
                            <a href="/categories/" rel="section">文章集合</a>
                        </li>
                        <li class="menu-item menu-item-about">
                            <a href="/about/" rel="section">关于我啊</a>
                        </li>
                        <li class="menu-item menu-item-message">
                            <a href="/message/" rel="section">留言与我</a>
                        </li>
                        <li class="menu-item menu-item-search">
                            <a role="button" class="popup-trigger">搜索 </a>
                        </li>
                    </ul>
                </nav>
                <div class="search-pop-overlay">
                    <div class="popup search-popup">
                        <div class="search-header">
                            <span class="search-icon">
                                <i class="fa fa-search"></i>
                            </span>
                            <div class="search-input-container">
                                <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
                            </div>
                            <span class="popup-btn-close">
                                <i class="fa fa-times-circle"></i>
                            </span>
                        </div>
                        <div id="search-result">
                            <div id="no-result">
                                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="back-to-top">
            <i class="fa fa-arrow-up"></i>
            <span>0%</span>
        </div>
        <div class="reading-progress-bar"></div>
        <main class="main">
            <div class="main-inner">
                <div class="content-wrap">
                    <div class="content index posts-expand">
                        <div class="carousel">
                            <div id="wowslider-container">
                                <div class="ws_images">
                                    <ul>
                                    </ul>
                                </div>
                                <div class="ws_thumbs">
                                    <div>
                                    </div>
                                </div>
                                <div class="ws_shadow"></div>
                            </div>
                        </div>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2887631422.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Redis <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2887631422.html" class="post-title-link" itemprop="url">Python连接redis多种姿势</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>示例环境</p>
                                    <figure class="highlight dart">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">python <span class="number">3.10</span></span><br><span class="line">redis <span class="number">6.2</span></span><br><span class="line">python redis <span class="number">4.1</span><span class="number">.0</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>本实例所有包</p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> StrictRedis, ConnectionPool</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</span><br><span class="line"><span class="keyword">from</span> concurrent.futures.process <span class="keyword">import</span> ProcessPoolExecutor</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2>
                                    <h3 id="Basic-Client"><a href="#Basic-Client" class="headerlink" title="Basic Client"></a>Basic Client</h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">rds = StrictRedis(</span><br><span class="line">    host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port=<span class="number">3218</span>,</span><br><span class="line">    <span class="comment"># redis 6.0 以后需要加入，默认为 default</span></span><br><span class="line">    username=<span class="string">'default'</span>,</span><br><span class="line">    password=<span class="string">'xxxxwadsad'</span>,</span><br><span class="line">    decode_responses=<span class="literal">True</span>,</span><br><span class="line">    db=<span class="number">1</span>,</span><br><span class="line">)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Basic-Client-Based-On-URL"><a href="#Basic-Client-Based-On-URL" class="headerlink" title="Basic Client Based On URL"></a>Basic Client Based On URL</h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">rds_url = <span class="string">'redis://default:xxxxwadsad@127.0.0.1:3218/1'</span></span><br><span class="line">rds = StrictRedis.from_url(rds_url)</span><br><span class="line">pprint(rds.info())</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Connection-Pool"><a href="#Connection-Pool" class="headerlink" title="Connection Pool"></a>Connection Pool</h2>
                                    <h3 id="Connection-Pool-class"><a href="#Connection-Pool-class" class="headerlink" title="Connection Pool class"></a>Connection Pool class</h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">connection_pool = ConnectionPool(</span><br><span class="line">    host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port=<span class="number">3218</span>,</span><br><span class="line">    <span class="comment"># redis 6.0 以后需要加入，默认为 default</span></span><br><span class="line">    username=<span class="string">'default'</span>,</span><br><span class="line">    password=<span class="string">'xxxxwadsad'</span>,</span><br><span class="line">    decode_responses=<span class="literal">True</span>,</span><br><span class="line">    db=<span class="number">1</span>,</span><br><span class="line">)</span><br><span class="line">connection_pool_client = StrictRedis(connection_pool=connection_pool)</span><br><span class="line">pprint(connection_pool_client.info())</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Connection-Pool-class-Base-on-URL"><a href="#Connection-Pool-class-Base-on-URL" class="headerlink" title="Connection Pool class Base on URL"></a>Connection Pool class Base on URL</h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">rds_url = <span class="string">'redis://default:xxxxwadsad@127.0.0.1:3218/1'</span></span><br><span class="line">connection_pool = ConnectionPool.from_url(rds_url)</span><br><span class="line">connection_pool_client = StrictRedis(connection_pool=connection_pool)</span><br><span class="line">pprint(connection_pool_client.info())</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2>
                                    <blockquote>
                                        <p>Batch process, Don’t forget to use <code>pipeline.execute()</code> after the batch is finished</p>
                                    </blockquote>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">pipeline = rds.pipeline(transaction=<span class="literal">True</span>)</span><br><span class="line">pipeline = connection_pool_client.pipeline(transaction=<span class="literal">True</span>)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>multiprocessing batch</p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pipeline process logic</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> ProcessPoolExecutor(max_workers=<span class="number">6</span>) <span class="keyword">as</span> p:</span><br><span class="line"></span><br><span class="line">　　　　 <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    p.submit(process_item)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>tips: IO密集型用线程、协程，CPU密集型用进程</p>
                                    </blockquote>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-01-08 23:06:49" itemprop="dateCreated datePublished" datetime="2022-01-08T23:06:49+08:00">2022-01-08</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>232</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1587148957.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 读书笔记 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1587148957.html" class="post-title-link" itemprop="url">逆商</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="—-应对逆境时候的能力"><a href="#—-应对逆境时候的能力" class="headerlink" title="— 应对逆境时候的能力"></a>— 应对逆境时候的能力</h2>
                                    <p><strong>最害怕死亡的人是那些知道自己从未真正活过的人</strong>. — 梭罗</p>
                                    <p><strong>一个人知道自己为什么而活，就可以忍受任何一种生活.</strong> —尼采</p>
                                    <h2 id="什么是逆商？"><a href="#什么是逆商？" class="headerlink" title="什么是逆商？"></a>什么是逆商？</h2>
                                    <p>一种测量工具，可以让你相较于周围的人。一套哲学，一种生活方式。怎么样看待、应对“逆境”？</p>
                                    <h3 id="CORE维度"><a href="#CORE维度" class="headerlink" title="CORE维度"></a>CORE维度</h3>
                                    <ul>
                                        <li>Control 掌控感</li>
                                        <li>Ownership 担当力</li>
                                        <li>Reach 影响度</li>
                                        <li>Endurance 持续性</li>
                                    </ul>
                                    <p><strong>Control 掌控感</strong></p>
                                    <p>所谓掌控感，是你对自己能力的确信。面对逆境时，你是否会变得束手无策？一旦你拥有掌控感，你会发现，无论遇到什么困难你都会抓住自己能够掌控的一部分。想拥有掌控感，首先就要坚信“没有什么做不到的事情”。有了这种想法，我们才会给大脑发出积极的信号，从而促进我们对问题采取措施，而不是手忙脚乱，陷入僵局。</p>
                                    <p><strong>Ownership 担当力</strong></p>
                                    <p>所谓担当力，是一个人对责任的担当能力。敢于主动担当责任的人往往具有更高的行动力。在遇到困境时，勇于担当责任的人更善于直面困境，寻找解决办法。责任意识让他们必须采取恰当的行动。也正因为如此，具有高担当力的人有更强的战胜逆境的能力。</p>
                                    <p><strong>Reach 影响度</strong></p>
                                    <p>所谓影响度，是困境对我们生活产生的影响。一个人逆商的高低，很大程度上取决于人处于困境时，是否被消磨斗志，丧失动力。逆商低的人会无限放大一件微不足道的小事，不断给大脑消极的暗示，甚至对自己的能力和产生怀疑。长时间处于这种思维状态中，日常生活会受到严重侵蚀，甚至产生心理疾病。</p>
                                    <p><strong>Endurance 持续性</strong></p>
                                    <p>所谓持续性，是逆境对于个体来说会持续多久。对于高逆商的人来说，一时处于困境之中并无大碍，他们永远相信，今天过去，明天会更美好。而低逆商的人会持续受到一次打击的影响，长时间活在逆境造成的阴影下。他们把失败的原因归结为一些不可变因素，如认定自己智力不如他人，从而放弃挣扎。久而久之，人会变得低迷懈怠，陷入死循环中。</p>
                                    <h3 id="三大支柱"><a href="#三大支柱" class="headerlink" title="三大支柱"></a>三大支柱</h3>
                                    <ul>
                                        <li>
                                            <p>认知心理：ABCDE、</p>
                                            <ul>
                                                <li>习得性无助</li>
                                                <li>归因理论和乐观精神</li>
                                                <li>心理韧性</li>
                                                <li>内外控倾向</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>健康新论（心理神经免疫学）：传递情绪化学物质会影响人的身体健康</p>
                                        </li>
                                        <li>
                                            <p>脑科学：习惯的神奇力量</p>
                                        </li>
                                    </ul>
                                    <h2 id="为什么需要逆商？"><a href="#为什么需要逆商？" class="headerlink" title="为什么需要逆商？"></a>为什么需要逆商？</h2>
                                    <p><strong>人生不断的攀越逆境</strong></p>
                                    <p>面对逆境的<strong>三种人</strong></p>
                                    <ul>
                                        <li>放弃者：只需要安逸</li>
                                        <li>扎营者：努力过后的安逸</li>
                                        <li>攀登者：一直前进</li>
                                    </ul>
                                    <h3 id="逆境来源"><a href="#逆境来源" class="headerlink" title="逆境来源"></a>逆境来源</h3>
                                    <p>社会、职场、个人</p>
                                    <h3 id="危险的岔道"><a href="#危险的岔道" class="headerlink" title="危险的岔道"></a>危险的岔道</h3>
                                    <p>停止努力，安于现状</p>
                                    <p>寄托于科技</p>
                                    <p>打击鸡血</p>
                                    <p>无助 <code>- &gt;</code> 无望的绝望循环</p>
                                    <h2 id="如何提高逆商？"><a href="#如何提高逆商？" class="headerlink" title="如何提高逆商？"></a>如何提高逆商？</h2>
                                    <h3 id="LEAD工具"><a href="#LEAD工具" class="headerlink" title="LEAD工具"></a>LEAD工具</h3>
                                    <blockquote>
                                        <p>利用LEAD工具增强掌控感，击退消极情绪</p>
                                    </blockquote>
                                    <p>LEAD是什么？</p>
                                    <ul>
                                        <li><strong>L</strong>isten 聆听（自己的逆境的反应）</li>
                                        <li><strong>E</strong>xplore 探究（对结果的担当）</li>
                                        <li><strong>A</strong>nalyze 分析</li>
                                        <li><strong>D</strong>o 做点事情</li>
                                    </ul>
                                    <p>漏斗法：引导自己抵抗重大挫折 <code>-&gt;</code> 避开受害者心态 <code>-&gt;</code> 障碍物</p>
                                    <p>分心法：停止恶化与蔓延 <code>-&gt;</code> 关注不相关的事物 <code>-&gt;</code> 弹走负面思想 <code>-&gt;</code> 积极干扰 <code>-&gt;</code> 运动改变状态</p>
                                    <p>重塑法：明确目标 <code>-&gt;</code> 渺小化问题 <code>-&gt;</code> 帮助他人</p>
                                    <h3 id="ABCDE"><a href="#ABCDE" class="headerlink" title="ABCDE"></a><strong>ABCDE</strong></h3>
                                    <p>A：Activating event</p>
                                    <p>B：Belief</p>
                                    <p>C：Consequence</p>
                                    <p>D：Disputation</p>
                                    <p>E：Energization</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-01-07 16:20:38" itemprop="dateCreated datePublished" datetime="2022-01-07T16:20:38+08:00">2022-01-07</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.2k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1520202318.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> php <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1520202318.html" class="post-title-link" itemprop="url">mac配置php环境</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="安装php"><a href="#安装php" class="headerlink" title="安装php"></a>安装php</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># homebrew 安装composer、php</span></span><br><span class="line">brew install composer</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>安装composer会自动安装php</p>
                                    </blockquote>
                                    <h2 id="配置composer"><a href="#配置composer" class="headerlink" title="配置composer"></a>配置composer</h2>
                                    <p><a href="https://developer.aliyun.com/composer" target="_blank" rel="noopener">https://developer.aliyun.com/composer</a></p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/</span><br><span class="line">composer self-update</span><br><span class="line">composer diagnose</span><br><span class="line">composer clear</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Checking-pubkeys-FAIL"><a href="#Checking-pubkeys-FAIL" class="headerlink" title="Checking pubkeys: FAIL"></a>Checking pubkeys: FAIL</h3>
                                    <figure class="highlight tex">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">Checking pubkeys: FAIL</span><br><span class="line">Missing pubkey for tags verification</span><br><span class="line">Missing pubkey for dev verification</span><br><span class="line">Run composer self-update --update-keys to set them up</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>打开<a href="https://composer.github.io/pubkeys.html" target="_blank" rel="noopener">pubkeys</a> 将图中内容放在第一次的input。</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0x352w42mj215w0j60y8.jpg" alt="image-20220404021653505"></p>
                                    <p>将图中内容放在第二次的input。</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0x35f6nmaj21820o2dmo.jpg" alt="image-20220404021716092"></p>
                                    <p><a href="https://github.com/composer/composer/issues/4839" target="_blank" rel="noopener">https://github.com/composer/composer/issues/4839</a></p>
                                    <h2 id="配置php"><a href="#配置php" class="headerlink" title="配置php"></a>配置php</h2>
                                    <figure class="highlight armasm">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">brew </span>services restart php</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="配置Xdebug"><a href="#配置Xdebug" class="headerlink" title="配置Xdebug"></a>配置Xdebug</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 下载xdebug</span></span><br><span class="line">pecl install xdebug</span><br><span class="line"><span class="comment"># 配置xdebug</span></span><br><span class="line"><span class="comment"># set xdebug ini</span></span><br><span class="line">cat &lt;&lt; EOF &gt; /opt/homebrew/etc/php/8.1/conf.d/ext-xdebug.ini</span><br><span class="line">[xdebug]</span><br><span class="line">zend_extension = <span class="string">"/opt/homebrew/Cellar/php/8.1.4/pecl/20210902/xdebug.so"</span></span><br><span class="line">xdebug.mode = <span class="string">"debug"</span></span><br><span class="line">xdebug.remote_mode = <span class="string">"req"</span></span><br><span class="line">;是否开启远程调试自动启动</span><br><span class="line">xdebug.remote_autostart = 1</span><br><span class="line">;是否开启远程调试</span><br><span class="line">xdebug.remote_enable = 1</span><br><span class="line">;允许调试的客户端IP</span><br><span class="line">xdebug.remote_host= <span class="string">"localhost"</span></span><br><span class="line">;远程调试的端口（默认9000）</span><br><span class="line">xdebug.remote_port = 9001</span><br><span class="line">;调试插件dbgp</span><br><span class="line">xdebug.remote_handler=<span class="string">"dbgp"</span></span><br><span class="line">;是否收集变量</span><br><span class="line">xdebug.collect_vars = 1</span><br><span class="line">;是否收集返回值</span><br><span class="line">xdebug.collect_return = 1</span><br><span class="line">;是否收集参数</span><br><span class="line">xdebug.collect_params = 1</span><br><span class="line">;是否开启调试内容</span><br><span class="line">xdebug.profiler_enable= 1</span><br><span class="line">;设置php显示的级别长度</span><br><span class="line">xdebug.var_display_max_depth=10</span><br><span class="line">xdebug.idekey = PHPSTROM</span><br><span class="line">EOF</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="禁止更新"><a href="#禁止更新" class="headerlink" title="禁止更新"></a>禁止更新</h2>
                                    <p>homebrew更新时会随之将路径打散，在非必要情况建议禁止自动更新php</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">brew pin php</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-29 13:48:44" itemprop="dateCreated datePublished" datetime="2021-12-29T13:48:44+08:00">2021-12-29</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>235</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2652301219.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 高质量代码修炼 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2652301219.html" class="post-title-link" itemprop="url">高质量代码修炼</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="为什么需要高质量代码？"><a href="#为什么需要高质量代码？" class="headerlink" title="为什么需要高质量代码？"></a>为什么需要高质量代码？</h2>
                                    <p>更规范更结构更便于开发更易修复与阅读</p>
                                    <p>你写的每一句代码都是你的label，你的id card</p>
                                    <h2 id="什么是高质量代码"><a href="#什么是高质量代码" class="headerlink" title="什么是高质量代码"></a>什么是高质量代码</h2>
                                    <p>没有对比就没有伤害，代码亦是如此。那么什么才是<strong>高质量，好</strong>代码呢？有没有哪些可明确度量的维度呢？</p>
                                    <ul>
                                        <li>可维护性（maintainability）</li>
                                        <li>可读性（readability）</li>
                                        <li>可扩展性（extensibility）</li>
                                        <li>灵活性（flexibility）</li>
                                        <li>简洁性（simplicity）</li>
                                        <li>可复用性（reusability）</li>
                                        <li>可测试性（testability）</li>
                                    </ul>
                                    <h2 id="如何才能编写出高质量，好代码"><a href="#如何才能编写出高质量，好代码" class="headerlink" title="如何才能编写出高质量，好代码"></a>如何才能编写出<strong>高质量，好</strong>代码</h2>
                                    <p>写出满足这些评价标准的高质量代码，我们需要掌握一些更加细化、更加能落地的编程方法论，包括<strong>面向对象设计思想、设计原则、设计模式、编码规范、重构技巧</strong>等。而所有这些编程方法论的最终目的都是为了编写出高质量的代码。</p>
                                    <p>比如，面向对象中的继承、多态能让我们写出可复用的代码；编码规范能让我们写出可读性好的代码；设计原则中的单一职责、DRY、基于接口而非实现、里式替换原则等，可以让我们写出可复用、灵活、可读性好、易扩展、易维护的代码；</p>
                                    <p>设计模式可以让我们写出易扩展的代码，持续重构可以时刻保持代码的可维护性等等</p>
                                    <h2 id="核心修炼技巧"><a href="#核心修炼技巧" class="headerlink" title="核心修炼技巧"></a>核心修炼技巧</h2>
                                    <p>发现<strong>好</strong>代码</p>
                                    <p>学习与实现”好”代码</p>
                                    <p>持续</p>
                                    <h2 id="Code-Style"><a href="#Code-Style" class="headerlink" title="Code Style"></a>Code Style</h2>
                                    <p>现在主流的编程范式或者是编程风格有三种，它们分别是函数式编程、面向过程、面向对象。</p>
                                    <p>现在比较流行的编程语言大部分都是面向对象编程语言。大部分项目也都是基于面向对象编程风格开发的。面向对象编程因为其具有丰富的特性（封装、抽象、继承、多态），可以实现很多复杂的设计思路，是很多设计原则、设计模式编码实现的基础。</p>
                                    <p>面向对象的四大特性：封装、抽象、继承、多态</p>
                                    <p>面向对象编程与面向过程编程的区别和联系面向对象分析、面向对象设计、面向对象编程接口和抽象类的区别以及各自的应用场景基于接口而非实现编程的设计思想多用组合少用继承的设计思想面向过程的贫血模型和面向对象的充血模型</p>
                                    <h3 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h3>
                                    <p>设计原则是指导我们代码设计的一些经验总结。设计原则这块儿的知识有一个非常大的特点，那就是这些原则听起来都比较抽象，定义描述都比较模糊，不同的人会有不同的解读。所以，如果单纯地去记忆定义，对于编程、设计能力的提高，意义并不大。对于每一种设计原则，我们需要掌握它的设计初衷，能解决哪些编程问题，有哪些应用场景。只有这样，我们才能在项目中灵活恰当地应用这些原则。</p>
                                    <p>你需要透彻理解并且掌握，如何应用下面这样几个常用的设计原则。</p>
                                    <ul>
                                        <li>SOLID 原则 -SRP 单一职责原则</li>
                                        <li>SOLID 原则 -OCP 开闭原则</li>
                                        <li>SOLID 原则 -LSP 里式替换原则</li>
                                        <li>SOLID 原则 -ISP 接口隔离原则</li>
                                        <li>SOLID 原则 -DIP 依赖倒置原则</li>
                                        <li>DRY 原则、KISS 原则、YAGNI 原则、LOD 法则</li>
                                    </ul>
                                    <p>SRP原则：一个类只能承担一个事情</p>
                                    <p>OCP：实现不可修改，但可面向扩展</p>
                                    <p>LSP：子类型能够替换它们的基类型</p>
                                    <p>ISP：抽象不持有特定逻辑，应持有实现的公有逻辑</p>
                                    <p>DIP：高底层不能互相依赖，应同时依赖抽象</p>
                                    <p>DRY：不做重复的事，不写重复类似的代码</p>
                                    <p>KISS：keep it simple，尽量简单的代码，让代码更容易被别人理解</p>
                                    <p>YANGNI：you ain’t gonna need it，只着眼必需的功能，不添加认为可能需要的功能</p>
                                    <p>LOD：类应减少被外界直接访问的机会，类与类之间避免直接通信</p>
                                    <h3 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h3>
                                    <p>设计模式是针对软件开发中经常遇到的一些设计问题，总结出来的一套解决方案或者设计思路。大部分设计模式要解决的都是代码的可扩展性问题。设计模式相对于设计原则来说，没有那么抽象，而且大部分都不难理解，代码实现也并不复杂。它们又可以分为三大类：创建型、结构型、行为型</p>
                                    <blockquote>
                                        <p>这一块的学习难点是了解它们都能解决哪些问题，掌握典型的应用场景，并且懂得不过度应用。</p>
                                    </blockquote>
                                    <p>经典的设计模式有 23 种。随着编程语言的演进，一些设计模式（比如 Singleton）也随之过时，甚至成了反模式，一些则被内置在编程语言中（比如 Iterator），另外还有一些新的模式诞生（比如 Monostate）。</p>
                                    <p><strong>创建型</strong></p>
                                    <ul>
                                        <li>[x] 常用的有：单例模式、工厂模式（工厂方法和抽象工厂）、建造者模式。</li>
                                        <li>[ ] 不常用的有：原型模式。</li>
                                    </ul>
                                    <p><strong>结构型</strong></p>
                                    <ul>
                                        <li>
                                            <p>[x] 常用的有：代理模式、桥接模式、装饰者模式、适配器模式。</p>
                                        </li>
                                        <li>
                                            <p>[ ] 不常用的有：门面模式、组合模式、享元模式。</p>
                                        </li>
                                    </ul>
                                    <p>行为型</p>
                                    <ul>
                                        <li>[x] 常用的有：观察者模式、模板模式、策略模式、职责链模式、迭代器模式、状态模式。</li>
                                        <li>[ ] 不常用的有：访问者模式、备忘录模式、命令模式、解释器模式、中介模式。</li>
                                    </ul>
                                    <h3 id="重构"><a href="#重构" class="headerlink" title="重构"></a>重构</h3>
                                    <p>在软件开发中，只要软件在不停地迭代，就没有一劳永逸的设计。随着需求的变化，代码的不停堆砌，原有的设计必定会存在这样那样的问题。</p>
                                    <p>针对这些问题，我们就需要进行代码重构。重构是软件开发中非常重要的一个环节。持续重构是保持代码质量不下降的有效手段，能有效避免代码腐化到无可救药的地步。</p>
                                    <p>而重构的工具就是我们前面罗列的那些<strong>面向对象设计思想、设计原则、设计模式、编码规范</strong>。</p>
                                    <p>实际上，设计思想、设计原则、设计模式一个最重要的应用场景就是在重构的时候。</p>
                                    <p>我们前面讲过，虽然使用设计模式可以提高代码的可扩展性，但过度不恰当地使用，也会增加代码的复杂度，影响代码的可读性。在开发初期，除非特别必须，我们一定不要过度设计，应用复杂的设计模式。</p>
                                    <p>而是当代码出现问题的时候，我们再针对问题，应用原则和模式进行重构。这样就能有效避免前期的过度设计。</p>
                                    <p>对于重构这部分内容，需要掌握：</p>
                                    <ul>
                                        <li>
                                            <p>重构的目的（why）、对象（what）、时机（when）、方法（how）；</p>
                                        </li>
                                        <li>
                                            <p>保证重构不出错的技术手段：单元测试和代码的可测试性；</p>
                                        </li>
                                        <li>两种不同规模的重构：大重构（大规模高层次）和小重构（小规模低层次）</li>
                                    </ul>
                                    <h2 id="五者之间的联系"><a href="#五者之间的联系" class="headerlink" title="五者之间的联系"></a>五者之间的联系</h2>
                                    <p>关于面向对象、设计原则、设计模式、编程规范和代码重构，面向对象编程因为其具有丰富的特性（封装、抽象、继承、多态），可以实现很多复杂的设计思路，是很多设计原则、设计模式等编码实现的基础。</p>
                                    <p>设计原则是指导我们代码设计的一些经验总结，对于某些场景下，是否应该应用某种设计模式，具有指导意义。</p>
                                    <p>比如，“开闭原则”是很多设计模式（策略、模板等）的指导原则。设计模式是针对软件开发中经常遇到的一些设计问题，总结出来的一套解决方案或者设计思路。应用设计模式的主要目的是提高代码的可扩展性。</p>
                                    <p>从抽象程度上来讲，设计原则比设计模式更抽象。设计模式更加具体、更加可执行。编程规范主要解决的是代码的可读性问题。</p>
                                    <p>编码规范相对于设计原则、设计模式，更加具体、更加偏重代码细节、更加能落地。持续的小重构依赖的理论基础主要就是编程规范。重构作为保持代码质量不下降的有效手段，利用的就是面向对象、设计原则、设计模式、编码规范这些理论。实际上，面向对象、设计原则、设计模式、编程规范、代码重构，这五者都是保持或者提高代码质量的方法论，本质上都是服务于<strong><br>编写高质量代码</strong>这一件事的。当我们追本逐源，看清这个本质之后，很多事情怎么做就清楚了，很多选择怎么选也清楚了。</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-28 19:40:41" itemprop="dateCreated datePublished" datetime="2021-12-28T19:40:41+08:00">2021-12-28</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>2.8k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>3 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/515113131.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Jetbrains Mono <i class="label-arrow"></i>
                                    </a>
                                    <a href="/515113131.html" class="post-title-link" itemprop="url">使用Jetbrains Mono字体</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>Jetbrains Mono 字体据说是Jetbrains 公司对于开发人员而开发的字体，当然个人觉得也不错，所以在此安装以及使用一波。分别在Jetbrains和VSCode中,Mono 相关链接如下</p>
                                    <p><a href="https://www.jetbrains.com/lp/mono/#how-to-install" target="_blank" rel="noopener">Mono</a></p>
                                    <p><a href="https://www.jetbrains.com/zh-cn/lp/mono/#how-to-install" target="_blank" rel="noopener">Mono zh-cn</a></p>
                                    <h2 id="在Jetbrains编辑器中使用"><a href="#在Jetbrains编辑器中使用" class="headerlink" title="在Jetbrains编辑器中使用"></a>在Jetbrains编辑器中使用</h2>
                                    <h3 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h3>
                                    <p><strong>step 1</strong></p>
                                    <p>Preferences/Settings -&gt; Editor -&gt; Font，右边字体中选择 <code>Jetbrains Mono</code>,</p>
                                    <blockquote>
                                        <p>我的设置</p>
                                        <p>Size：13 Line hight：1.2 Enable Ligature</p>
                                    </blockquote>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxsee1orkhj30ra0jojtc.jpg" alt="image-20211227145717002"></p>
                                    <blockquote>
                                        <p>Tip: 从 v2019.3 开始，JetBrains IDE 随附了最新版本的 JetBrains Mono。</p>
                                    </blockquote>
                                    <p><strong>step 2</strong></p>
                                    <blockquote>
                                        <p>进行了以上的设置之后可能还无法使用，此时我们需要在进一步的设置，如下</p>
                                    </blockquote>
                                    <p>Preferences/Settings -&gt; Editor -&gt; Color Scheme -&gt; Color Scheme Font</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxseoq1e4nj30ra0jo3zx.jpg" alt="image-20211227150734888"></p>
                                    <p>效果如下</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxseu12227j30ol0llabw.jpg" alt="image-20211227151240648"></p>
                                    <h2 id="在Vscode中使用"><a href="#在Vscode中使用" class="headerlink" title="在Vscode中使用"></a>在Vscode中使用</h2>
                                    <h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxsf74l0goj318q0l7gnh.jpg" alt="image-20211227152516091"></p>
                                    <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxsf7sit6nj30io08474w.jpg" alt="image-20211227152554293"></p>
                                    <blockquote>
                                        <p>为了兼容性考虑，我建议是全部安装。当然也可仅安装<code>Regular.tff</code>也可</p>
                                    </blockquote>
                                    <h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2>
                                    <p>在配置文件中修改为如下</p>
                                    <blockquote>
                                        <p>存在即修改，不存在就新增。重启VS code即可</p>
                                    </blockquote>
                                    <figure class="highlight actionscript">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="string">"editor.fontFamily"</span>: <span class="string">"JetBrains Mono, Menlo, Monaco, 'Courier New', monospace"</span>,</span><br><span class="line"><span class="string">"editor.fontLigatures"</span>: <span class="literal">true</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>显示如下所示</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxsfgpmnjhj30u50bl0tz.jpg" alt="image-20211227153428863"></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-27 14:50:19" itemprop="dateCreated datePublished" datetime="2021-12-27T14:50:19+08:00">2021-12-27</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>484</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3057642135.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 算法 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3057642135.html" class="post-title-link" itemprop="url">算法-复杂度分析</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>算法其核心主要思考的是快和省的问题，而算法复杂度可细分为<strong>时间复杂度</strong>和<strong>空间复杂度</strong>。时间复杂度是指执行所需要的工作量，空间复杂度是指执行所需要的<strong>内存</strong>空间。</p>
                                    <h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2>
                                    <h3 id="Big-O-Notation"><a href="#Big-O-Notation" class="headerlink" title="Big O Notation"></a>Big O Notation</h3>
                                    <p>所有代码的执行时间 T(n) 与每行代码的执行次数 f(n) 成正比。</p>
                                    <script type="math/tex; mode=display">T(n) = O(f(n))</script>
                                    <p>这就是大 O 时间复杂度表示法。</p>
                                    <p>大 O 时间复杂度实际上并不具体表示代码真正的执行时间，而是表示代码执行时间随数据规模增长的变化趋势，所以，也叫作渐进时间复杂度（asymptotic time complexity），简称时间复杂度。</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxp9wibw53j30oa0gcdh3.jpg" alt="image-20211224220519869"></p>
                                    <h3 id="常见时间复杂度"><a href="#常见时间复杂度" class="headerlink" title="常见时间复杂度"></a>常见时间复杂度</h3>
                                    <blockquote>
                                        <p>从小到大</p>
                                    </blockquote>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>T(n)</th>
                                                    <th>desc</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O(1)</script>
                                                    </td>
                                                    <td>Constant Complexity（常数复杂度）</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O（log n）</script>
                                                    </td>
                                                    <td>Logarithmic Complexity（对数复杂度）</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O（n）</script>
                                                    </td>
                                                    <td>Linear Complexity（线性复杂度）</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O（n ^ 2）</script>
                                                    </td>
                                                    <td>N Square Complexity（平方复杂度）</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O（n ^ 3）</script>
                                                    </td>
                                                    <td>N cubic Complexity（立方复杂度）</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O（2 ^ n）</script>
                                                    </td>
                                                    <td>Exponential Growth(指数)</td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <script type="math/tex">O（n!）</script>
                                                    </td>
                                                    <td>Factorial (阶乘)</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <blockquote>
                                        <p>并列相加，嵌套相乘</p>
                                        <p>每次折半log N,递归<strong>一般</strong>为指数</p>
                                    </blockquote>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxpaoxdc8yj30ki04y0tg.jpg" alt="image-20211224223240782"></p>
                                    <h3 id="时间复杂度分析"><a href="#时间复杂度分析" class="headerlink" title="时间复杂度分析"></a>时间复杂度分析</h3>
                                    <ol>
                                        <li>只关注循环执行次数最多代码块</li>
                                        <li>加法原则：总复杂度等于量级最大的代码块的复杂度</li>
                                        <li>乘法原则：嵌套代码的复杂度等于嵌套内外代码块复杂度的乘积</li>
                                    </ol>
                                    <h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4>
                                    <script type="math/tex; mode=display">O(1)</script>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Python</span></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line">y = <span class="number">2</span></span><br><span class="line">z = x + y</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <script type="math/tex; mode=display">O(log _ n)</script>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= <span class="number">100</span>):</span><br><span class="line">    i *= <span class="number">2</span></span><br><span class="line">    print(i)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <script type="math/tex; mode=display">O(n + m)</script>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Python</span></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line">y = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (x &lt;= <span class="number">100</span>):</span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (x &lt;= <span class="number">1000</span>):</span><br><span class="line">    y += <span class="number">1</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <script type="math/tex; mode=display">O(m * n)</script>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, x + <span class="number">1</span>):</span><br><span class="line">        print(<span class="string">f"<span class="subst">&#123;y&#125;</span> ^ <span class="subst">&#123;x&#125;</span> = <span class="subst">&#123;x * y&#125;</span>"</span>, end=<span class="string">"\t"</span>)</span><br><span class="line">    print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-------"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">9</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, x + <span class="number">1</span>):</span><br><span class="line">        print(<span class="string">f"<span class="subst">&#123;y&#125;</span> ^ <span class="subst">&#123;x&#125;</span> = <span class="subst">&#123;x * y&#125;</span>"</span>, end=<span class="string">"\t"</span>)</span><br><span class="line">    print(<span class="string">''</span>)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>tip: x 为长， y 为高</p>
                                    </blockquote>
                                    <h3 id="最好、最坏、平均复杂度"><a href="#最好、最坏、平均复杂度" class="headerlink" title="最好、最坏、平均复杂度"></a>最好、最坏、平均复杂度</h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_Girl</span><span class="params">(girl: list[int], number: int)</span> -&gt; int:</span></span><br><span class="line">    i, pos, n = <span class="number">0</span>, <span class="number">-1</span>, len(girl)</span><br><span class="line">    <span class="keyword">while</span> i &lt; n:</span><br><span class="line">        <span class="keyword">if</span> girl[i] == number:</span><br><span class="line">            pos = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> pos</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>最好情况时间复杂度（best case time complexity）：最好情况时间复杂度就是，在最理想的情况下，执行这段代码的时间复杂度</p>
                                    <p>最坏情况时间复杂度（worst case time complexity）：最坏情况时间复杂度就是，在最糟糕的情况下，执行这段代码的时间复杂度</p>
                                    <p>平均情况时间复杂度（average case time complexity）：</p>
                                    <p>最好情况时间复杂度和最坏情况时间复杂度对应的都是极端情况下的代码复杂度，发生的概率其实都并不大。为了更好地表示平均情况下的复杂度, 使用<strong>平均情况时间复杂度</strong><br>平均复杂度，顾名思义就是出现情况的概率，这个值就是概率论中的加权平均值，也叫作期望值，所以平均时间复杂度的全称应该叫加权平均时间复杂度或者期望时间复杂度。</p>
                                    <h3 id="均摊时间复杂度"><a href="#均摊时间复杂度" class="headerlink" title="均摊时间复杂度"></a>均摊时间复杂度</h3>
                                    <p>均摊时间复杂度（amortized time complexity）：</p>
                                    <p>对一个数据结构进行一组连续操作中，大部分情况下时间复杂度都很低，只有个别情况下时间复杂度比较高，而且这些操作之间存在前后连贯的时序关系，这个时候，我们就可以将这一组操作放在一块儿分析，看是否能将较高时间复杂度那次操作的耗时，平摊到其他那些时间复杂度比较低的操作上。而且，在能够应用均摊时间复杂度分析的场合，一般均摊时间复杂度就等于最好情况时间复杂度。尽管很多数据结构和算法书籍都花了很大力气来区分平均时间复杂度和均摊时间复杂度，均摊时间复杂度就是一种特殊的<strong>平均时间复杂度</strong></p>
                                    <h2 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h2>
                                    <p>空间复杂度全称就是渐进空间复杂度（asymptotic space complexity），表示算法的存储空间与数据规模之间的增长关系。</p>
                                    <h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3>
                                    <p><em>空间复杂度</em>(Space Complexity) 是对一个算法在运行过程中<strong>新开辟</strong>存储空间大小的量度.</p>
                                    <p>记做</p>
                                    <script type="math/tex; mode=display">s(n) = O(f(n))</script>
                                    <h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3>
                                    <p>不做任何优化，一般为指数阶。</p>
                                    <p><a href="https://www.bigocheatsheet.com/" target="_blank" rel="noopener">bigocheatsheet</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-24 12:26:00" itemprop="dateCreated datePublished" datetime="2021-12-24T12:26:00+08:00">2021-12-24</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.4k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1413352655.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> JavaScript <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1413352655.html" class="post-title-link" itemprop="url">JS逆向算法还原常用技巧</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>Hi，许久不见，我是Payne啊。</p>
                                    <p>ok，那么我们先说说核心本质吧，其核心本质个人认为依旧是伪装。就像爬虫为对面对反爬虫反制，从而添加特征，不断的逼近<strong>像</strong>真人。</p>
                                    <p>自然在参数、环境还原这里也是。</p>
                                    <p>无论是一下的<strong>补环境</strong>、<strong>扣代码</strong>、<strong>手动还原</strong>，也都是在模拟生成加密逻辑。</p>
                                    <h2 id="补环境"><a href="#补环境" class="headerlink" title="补环境"></a>补环境</h2>
                                    <h3 id="补环境的定义"><a href="#补环境的定义" class="headerlink" title="补环境的定义"></a>补环境的定义</h3>
                                    <p>补环境顾名思义就是，将获取到的关键JS在通过<strong>修补环境</strong>的方法在本地或服务器上能够正常运行获取到正确的返回值，从而完成参数的加密模拟。</p>
                                    <p>当然大部分情况下补环境与抠代码密不可分（一般是扣代码，然后在补环境），扣代码移步第二部分</p>
                                    <h3 id="核心本质"><a href="#核心本质" class="headerlink" title="核心本质"></a>核心本质</h3>
                                    <p>无论是缺啥补啥的前的构建错误，还是使用代理监控运行。都是在做链路追踪。在补环境这里是秉承着遇河搭桥，缺啥补啥思路。</p>
                                    <p>常用的方法一般有两个：</p>
                                    <blockquote>
                                        <p>假设获取到了核心的JS代码后</p>
                                    </blockquote>
                                    <p>一种是使用运行，从而构建错误实现报错，然后通过补方法、对象来fix。从而完成补环境，（当然这是必须的）。</p>
                                    <p>当完成以上的操作后，遇见风控、遇见伏点。可以正常通过运行，但无法获取到正确的参数。此时使用<code>Proxy</code>来监听实现监测，协助调试。</p>
                                    <h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3>
                                    <p>是方法写空方法<code>arguments</code>看传参，对象写空对象<code>Proxy</code>来相助，进行链路追踪，完成模拟</p>
                                    <figure class="highlight javascript">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="built_in">window</span> = global;</span><br><span class="line"><span class="built_in">document</span> = &#123;</span><br><span class="line">    location: &#123;<span class="string">'protocol'</span>: <span class="string">'https:'</span>&#125;,</span><br><span class="line">    referrer: <span class="string">''</span>,</span><br><span class="line">    getElementById: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getElementById:"</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    getElementsByClassName: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getElementsByClassName:"</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    getElementsByName: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getElementsByName:"</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    getElementsByTagName: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getElementsByTagName:"</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    getElementsByTagNameNS: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getElementsByTagNameNS:"</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    createElement: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"createElement:"</span>, <span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">navigator = &#123;</span><br><span class="line">    appCodeName: <span class="string">"Mozilla"</span>,</span><br><span class="line">    appName: <span class="string">"Netscape"</span>,</span><br><span class="line">    appVersion: <span class="string">"5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36"</span>,</span><br><span class="line">    language: <span class="string">"zh-CN"</span>,</span><br><span class="line">    languages: (<span class="number">2</span>)[<span class="string">'zh-CN'</span>, <span class="string">'zh'</span>],</span><br><span class="line">    platform: <span class="string">"MacIntel"</span>,</span><br><span class="line">    product: <span class="string">"Gecko"</span>,</span><br><span class="line">    productSub: <span class="string">"20030107"</span>,</span><br><span class="line">    userAgent: <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36"</span>,</span><br><span class="line">    vendor: <span class="string">"Google Inc."</span>,</span><br><span class="line">&#125;;</span><br><span class="line">screen = &#123;</span><br><span class="line">    availHeight: <span class="number">1055</span>,</span><br><span class="line">    availLeft: <span class="number">0</span>,</span><br><span class="line">    availTop: <span class="number">25</span>,</span><br><span class="line">    availWidth: <span class="number">1920</span>,</span><br><span class="line">    colorDepth: <span class="number">24</span>,</span><br><span class="line">    height: <span class="number">1080</span>,</span><br><span class="line">    pixelDepth: <span class="number">24</span>,</span><br><span class="line">    width: <span class="number">1920</span>,</span><br><span class="line">&#125;;</span><br><span class="line">location = &#123;</span><br><span class="line">    href: <span class="string">'https://www.xxx.com/website-login/captcha?redirectPath=https%3A%2F%2Fwww.xxx.com%2Fdiscovery%2Fitem%2F618bf8f60000000001027ccd'</span>,</span><br><span class="line">    hostname: <span class="string">'www.xxx.com'</span>,</span><br><span class="line">    host: <span class="string">'www.xxx.com'</span>,</span><br><span class="line">&#125;;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3>
                                    <ol>
                                        <li>缺啥补啥：通过本地运行实现错误</li>
                                    </ol>
                                    <p>Proxy</p>
                                    <p>空对象：使用proxy代理，空方法：使用其中的<code>arguments</code>，获取传入参数</p>
                                    <p>获取DOM节点：当做<code>[ ]</code>处理</p>
                                    <p>创建DOM节点：当作<code>{ }</code>处理</p>
                                    <figure class="highlight javascript">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">null_function = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 代理</span></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="function">(<span class="params">obj, obj_name</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">        <span class="keyword">get</span>: (target, key) =&gt; &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(obj_name, <span class="string">"Getting"</span>, key)</span><br><span class="line">            <span class="keyword">return</span> target[key];</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//吐环境</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">proxy</span>(<span class="params">proxy_array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; proxy_array; i++) &#123;</span><br><span class="line">        <span class="built_in">eval</span>(proxy_array[i] + <span class="string">' = new Proxy('</span> + proxy_array[i] + <span class="string">',&#123; '</span> +</span><br><span class="line">            <span class="string">'get(target,key)&#123; '</span> +</span><br><span class="line">            <span class="string">'debugger;'</span> +</span><br><span class="line">            <span class="string">'console.log("====================")'</span> +</span><br><span class="line">            <span class="string">'console.log("获取了",'</span> + proxy_array[i] + <span class="string">' 的key属性"); '</span> +</span><br><span class="line">            <span class="string">'console.log("====================")'</span> +</span><br><span class="line">            <span class="string">'return target[key]; &#125;'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//常用的proxy_array</span></span><br><span class="line"><span class="keyword">var</span> proxy_array = [<span class="string">"window"</span>, <span class="string">"document"</span>, <span class="string">"location"</span>, <span class="string">"navigator"</span>]</span><br><span class="line">proxy(proxy_array)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="抠代码"><a href="#抠代码" class="headerlink" title="抠代码"></a>抠代码</h2>
                                    <p>找到关键入口，抠下来🐶～。</p>
                                    <p>重在调试，不再抠（抠就是复制粘贴）</p>
                                    <p>小技巧：</p>
                                    <p>打开浏览器的设置，找到如下所示的<code>code filding</code> 勾选打开。JS代码收缩复制一气呵成，妙啊～</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gxnrxih3bqj308v07mweo.jpg" alt="image-20211223145757359"></p>
                                    <h2 id="手动还原"><a href="#手动还原" class="headerlink" title="手动还原"></a>手动还原</h2>
                                    <p>通过调试查看算法实现过程，结合加密库复现。</p>
                                    <blockquote>
                                        <p>Tip: 可以但没必要，手撕随爽，但可不要贪杯哦</p>
                                    </blockquote>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-23 15:19:04" itemprop="dateCreated datePublished" datetime="2021-12-23T15:19:04+08:00">2021-12-23</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>715</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1032104040.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> pymysql <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1032104040.html" class="post-title-link" itemprop="url">使用迭代器优化pymysql大量查询</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h2>
                                    <p>当我们需要使用<code>pymysql</code>进行大量数据的提取时，发现越来越慢。直到阻塞，down。</p>
                                    <h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2>
                                    <p>使用<code>SSDictCursor</code>无缓冲游标来操作，使用<code>fetchall_unbuffered</code>，来进行。同时辅以分页查询即可。</p>
                                    <p>首先是建立连接，<code>curror</code> 的选择</p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">from</span> pymysql <span class="keyword">import</span> connect, cursors</span><br><span class="line"></span><br><span class="line">client = connect(**&#123;</span><br><span class="line">    <span class="string">"host"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="string">"port"</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="string">"user"</span>: <span class="string">"root"</span>,</span><br><span class="line">    <span class="string">"password"</span>: <span class="string">"123321"</span>,</span><br><span class="line">    <span class="string">"database"</span>: <span class="string">"test"</span>,</span><br><span class="line">    <span class="string">'charset'</span>: <span class="string">'utf8'</span></span><br><span class="line">&#125;, cursorclass=cursors.SSCursor)</span><br><span class="line"></span><br><span class="line">cursor = client.cursor()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>注意在此可以选择<strong>无缓冲游标</strong>， 来操作。即<code>cursors.SSCursor</code>,<code>cursors.SSDictCursor</code>。</p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">page_count = <span class="number">1000</span></span><br><span class="line"><span class="keyword">for</span> pg <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    query_sql = <span class="string">f"""select * from xiaohongshu_comment_note_2 limit <span class="subst">&#123;page_number * page_count&#125;</span>, <span class="subst">&#123;page_count&#125;</span>;"""</span></span><br><span class="line">    cursor.execute(query_sql)</span><br><span class="line"><span class="keyword">for</span> results <span class="keyword">in</span> cursor.fetchall_unbuffered():</span><br><span class="line">    print(results)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>当然还可以在函数中这样写</p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unbuffer_query</span><span class="params">(page_count=<span class="number">1000</span>, max_page=<span class="number">1000</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :param page_count:</span></span><br><span class="line"><span class="string">    :param max_page:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> page_number <span class="keyword">in</span> range(max_page):</span><br><span class="line">        query_sql = <span class="string">f"""select * from xiaohongshu_comment_note_2 limit <span class="subst">&#123;page_number * page_count&#125;</span>, <span class="subst">&#123;page_count&#125;</span>;"""</span></span><br><span class="line">        cursor.execute(query_sql)</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">from</span> cursor.fetchall_unbuffered()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> unbuffer_query(page_count=<span class="number">999</span>, max_page=<span class="number">9999</span>):</span><br><span class="line">    print(i)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>瑞思拜～</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-10 19:25:19" itemprop="dateCreated datePublished" datetime="2021-12-10T19:25:19+08:00">2021-12-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>196</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3686442481.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> JetBrains <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3686442481.html" class="post-title-link" itemprop="url">JetBrains编辑器清理(mac)</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h2>
                                    <p>由于不可描述的原因，我需要将<code>JetBrains</code>的所有已安装的编辑器进行清理。但我们知道MAC上单纯将应用软件中的软件拖入废纸篓是无法进行彻底删除的。</p>
                                    <blockquote>
                                        <p>Tip: 有<code>Cleaner One Pro</code>或者<code>clean my mac</code> 专业版的（也就是付费版）的朋友可以直接在该软件中进行软件的卸载与清理，具体操作便不再此过多赘述</p>
                                    </blockquote>
                                    <h2 id="关键目录"><a href="#关键目录" class="headerlink" title="关键目录"></a>关键目录</h2>
                                    <figure class="highlight dart">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">~/Library/Application\ Support/JetBrains</span><br><span class="line">~/Library/Logs/JetBrains</span><br><span class="line">~/Library/Preferences/JetBrains.*</span><br><span class="line">~/Library/Caches/JetBrains</span><br><span class="line">/Applications</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3>
                                    <blockquote>
                                        <p>Tip：建议先将<code>/Applications</code> 中的内容先进行删除</p>
                                    </blockquote>
                                    <figure class="highlight groovy">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">rm -rf <span class="regexp">~/Library/</span>Application\ Support<span class="regexp">/JetBrains/</span>*</span><br><span class="line">rm -rf <span class="regexp">~/Library/</span>Logs<span class="regexp">/JetBrains/</span>*</span><br><span class="line">rm -rf <span class="regexp">~/Library/</span>Preferences/JetBrains.*</span><br><span class="line">rm -rf <span class="regexp">~/Library/</span>Caches<span class="regexp">/JetBrains/</span>*</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Evalreset-Cleanr-Script"><a href="#Evalreset-Cleanr-Script" class="headerlink" title="Evalreset Cleanr Script"></a>Evalreset Cleanr Script</h2>
                                    <h3 id="Mac-Linux"><a href="#Mac-Linux" class="headerlink" title="Mac/Linux"></a>Mac/Linux</h3>
                                    <figure class="highlight sh">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="meta">#!/usr/bin/env sh</span></span><br><span class="line"><span class="comment"># reset jetbrains ide evals</span></span><br><span class="line"></span><br><span class="line">OS_NAME=$(uname -s)</span><br><span class="line">JB_PRODUCTS=<span class="string">"IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$OS_NAME</span> == <span class="string">"Darwin"</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">'macOS:'</span></span><br><span class="line">	</span><br><span class="line">	rm -rf ~/Library/Logs/JetBrains/*</span><br><span class="line">	rm -rf ~/Library/Caches/JetBrains/*</span><br><span class="line">	rm -rf ~/Library/Preferences/JetBrains.*</span><br><span class="line">	<span class="keyword">for</span> PRD <span class="keyword">in</span> <span class="variable">$JB_PRODUCTS</span>; <span class="keyword">do</span></span><br><span class="line">    	rm -rf ~/Library/Preferences/<span class="variable">$&#123;PRD&#125;</span>*/*</span><br><span class="line">    	rm -rf ~/Library/Application\ Support/JetBrains/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$OS_NAME</span> == <span class="string">"Linux"</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">'Linux:'</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> PRD <span class="keyword">in</span> <span class="variable">$JB_PRODUCTS</span>; <span class="keyword">do</span></span><br><span class="line">    	rm -rf ~/.<span class="variable">$&#123;PRD&#125;</span>*/config/<span class="built_in">eval</span></span><br><span class="line">    	rm -rf ~/.config/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">'unsupport'</span></span><br><span class="line">	<span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'done.'</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3>
                                    <figure class="highlight vbscript">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">Set</span> oShell = <span class="built_in">CreateObject</span>(<span class="string">"WScript.Shell"</span>)</span><br><span class="line"><span class="keyword">Set</span> oFS = <span class="built_in">CreateObject</span>(<span class="string">"Scripting.FileSystemObject"</span>)</span><br><span class="line">sHomeFolder = oShell.ExpandEnvironmentStrings(<span class="string">"%USERPROFILE%"</span>)</span><br><span class="line">sJBDataFolder = oShell.ExpandEnvironmentStrings(<span class="string">"%APPDATA%"</span>) + <span class="string">"\JetBrains"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> re = <span class="keyword">New</span> <span class="built_in">RegExp</span></span><br><span class="line">re.Global     = <span class="literal">True</span></span><br><span class="line">re.IgnoreCase = <span class="literal">True</span></span><br><span class="line">re.Pattern    = <span class="string">"\.?(IntelliJIdea|GoLand|CLion|PyCharm|DataGrip|RubyMine|AppCode|PhpStorm|WebStorm|Rider).*"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> removeEval(<span class="keyword">ByVal</span> file, <span class="keyword">ByVal</span> sEvalPath)</span><br><span class="line">	bMatch = re.Test(file.Name)</span><br><span class="line">    <span class="keyword">If</span> <span class="keyword">Not</span> bMatch <span class="keyword">Then</span></span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">If</span> oFS.FolderExists(sEvalPath) <span class="keyword">Then</span></span><br><span class="line">		oFS.DeleteFolder sEvalPath, <span class="literal">True</span> </span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> oFS.FolderExists(sHomeFolder) <span class="keyword">Then</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> oFile <span class="keyword">In</span> oFS.GetFolder(sHomeFolder).SubFolders</span><br><span class="line">    	removeEval oFile, sHomeFolder + <span class="string">"\"</span> + oFile.Name + <span class="string">"\config\eval"</span></span><br><span class="line">	<span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> oFS.FolderExists(sJBDataFolder) <span class="keyword">Then</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> oFile <span class="keyword">In</span> oFS.GetFolder(sJBDataFolder).SubFolders</span><br><span class="line">	    removeEval oFile, sJBDataFolder + <span class="string">"\"</span> + oFile.Name + <span class="string">"\eval"</span></span><br><span class="line">	<span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">MsgBox</span> <span class="string">"done"</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><a href="https://shimo.im/docs/qXHrKqdrtjJX6xtX/read" target="_blank" rel="noopener">qXHrKqdrtjJX6xtX</a></p>
                                    <p><a href="http://vrg123.com/" target="_blank" rel="noopener">vrg123</a> : 4565</p>
                                    <p><a href="https://zhile.io/2020/11/18/jetbrains-eval-reset-da33a93d.html" target="_blank" rel="noopener">zhile</a></p>
                                    <p><a href="https://plugins.zhile.io" target="_blank" rel="noopener">Zhile-plug</a>: <a href="https://plugins.zhile.io" target="_blank" rel="noopener">https://plugins.zhile.io</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-10 13:32:10" itemprop="dateCreated datePublished" datetime="2021-12-10T13:32:10+08:00">2021-12-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>293</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/286144973.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> nodejs <i class="label-arrow"></i>
                                    </a>
                                    <a href="/286144973.html" class="post-title-link" itemprop="url">NodeJS 相关镜像源设置</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="npm-查看镜像源"><a href="#npm-查看镜像源" class="headerlink" title="npm 查看镜像源"></a><code>npm</code> 查看镜像源</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># npm config (set | get | delete | list | edit)</span></span><br><span class="line">npm config get (registry|sass_binary_site)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3>
                                    <p><strong>临时使用镜像</strong></p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">npm install --registry=https://registry.npmmirror.com pkg_name -g cnpm</span><br><span class="line"><span class="comment"># 创建别名</span></span><br><span class="line"><span class="built_in">alias</span> npmc=<span class="string">"npm --registry=https://registry.npmmirror.com"</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>全局配置</strong></p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># npm</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line">npm config <span class="built_in">set</span> sass_binary_site=https://npm.taobao.org/mirrors/node-sass/phantomjs_cdn</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="yarn-查看镜像源"><a href="#yarn-查看镜像源" class="headerlink" title="yarn 查看镜像源"></a><code>yarn</code> 查看镜像源</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># yarn config (set | get | delete | list | current)</span></span><br><span class="line">yarn config get（registry｜sass_binary_site)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3>
                                    <p><strong>临时使用镜像</strong></p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">yarn add --registry=https://registry.npm.taobao.org</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>全局配置</strong></p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">yarn config <span class="built_in">set</span> registry https://registry.npm.taobao.org -g</span><br><span class="line">yarn config <span class="built_in">set</span> sass_binary_site http://cdn.npm.taobao.org/dist/node-sass -g</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><code>yarn</code>使用</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 初始化项目</span></span><br><span class="line">yarn init [-y]</span><br><span class="line"><span class="comment"># 添加依赖</span></span><br><span class="line">yarn [global] add </span><br><span class="line">-D, --dev                           save package to your `devDependencies`(开发依赖)</span><br><span class="line">-P, --peer                          save package to your `peerDependencies`(对等依赖)</span><br><span class="line">-O, --optional                      save package to your `optionalDependencies`(可选依赖)</span><br><span class="line"><span class="comment"># 安装项目所有依赖 `yarn` or </span></span><br><span class="line">yarn install [--update-checksums]</span><br><span class="line"><span class="comment"># 更新</span></span><br><span class="line">yarn upgrade</span><br><span class="line"><span class="comment"># 移除</span></span><br><span class="line">yarn remove</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-10 12:34:55" itemprop="dateCreated datePublished" datetime="2021-12-10T12:34:55+08:00">2021-12-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>47</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1564497082.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 代码优化 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1564497082.html" class="post-title-link" itemprop="url">论优化</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>时代高速发展，技术日新月异。各司左手分布式，右手高并发。嘴上骂骂咧咧动不动优化的卷王，近日出现的可真不少。</p>
                                    <p>他卷任他卷，躺平治百痛，吾可被累死，但也要卷死尔等。</p>
                                    <p>那么今天咱们也聊聊“代码优化”？</p>
                                    <h2 id="如何写出更快更好的代码？"><a href="#如何写出更快更好的代码？" class="headerlink" title="如何写出更快更好的代码？"></a>如何写出更快更好的代码？</h2>
                                    <p>编程技巧</p>
                                    <ul>
                                        <li>更清晰的代码组织结构</li>
                                        <li>更明了的命名，更好的逻辑结构</li>
                                    </ul>
                                    <p>编码技巧</p>
                                    <ul>
                                        <li>更少的占用</li>
                                        <li>更快的运行</li>
                                    </ul>
                                    <p>其实说到这个往细致了说就是 <strong>算法和数据结构</strong>的事儿，但为什么我觉得差点意思呢？</p>
                                    <h2 id="优化原则"><a href="#优化原则" class="headerlink" title="优化原则"></a>优化原则</h2>
                                    <ol>
                                        <li>保证代码正常工作</li>
                                        <li>权衡“优化”代价</li>
                                        <li>定义性能指标，集中力量解决首要问题</li>
                                        <li>不要忽略可读性</li>
                                    </ol>
                                    <h2 id="优化代码"><a href="#优化代码" class="headerlink" title="优化代码"></a>优化代码</h2>
                                    <p>发现<strong>烂</strong>代码</p>
                                    <p>测试与分析</p>
                                    <ul>
                                        <li>
                                            <p>单元测试、基准测试</p>
                                        </li>
                                        <li>
                                            <p>性能分析、代码覆盖率分析、时间、空间负责度分析</p>
                                        </li>
                                    </ul>
                                    <p>修改<strong>烂</strong>代码</p>
                                    <ul>
                                        <li>更低的代码覆盖率，更多的可重用代码</li>
                                        <li>更好更省的算法</li>
                                        <li>更符合的语言特性</li>
                                        <li>更顺应度调度</li>
                                    </ul>
                                    <p>保持书写<strong>好</strong>代码的习惯</p>
                                    <h2 id="Python优化技巧"><a href="#Python优化技巧" class="headerlink" title="Python优化技巧"></a>Python优化技巧</h2>
                                    <h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3>
                                    <ul>
                                        <li>最懒的性能分析：Unix time</li>
                                        <li>内存分析：memory_profiler</li>
                                        <li>引用分析：Obj graph</li>
                                        <li>最详细的性能分析：cProfile、</li>
                                        <li>pytest</li>
                                    </ul>
                                    <h3 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h3>
                                    <ol>
                                        <li>使用尽量低和省的算法与数据结构</li>
                                        <li>尽量使用内置数据类型，尽量使用内置函数</li>
                                        <li>使用LRU_Cache 缓存数据</li>
                                        <li>尽量使用局部变量：与每个作用域内查找变量的速度有关，局部变量最快，类级属性中等，全局变量最慢</li>
                                        <li>使用函数</li>
                                        <li>提防字符串：在循环中运行 模数（%s）或 .format() 会变量，优先用 f-string</li>
                                        <li>巧用多重赋值</li>
                                        <li>使用生成器</li>
                                        <li>使用MultiProcessing克服GIL、使用线程池、使用Coroutine</li>
                                        <li>使用C/C++ 模块提高性能，使用Cython</li>
                                        <li>使用JIT</li>
                                    </ol>
                                    <p>一些分析工具：</p>
                                    <p><a href="https://github.com/nvdv/vprof" target="_blank" rel="noopener">vprof</a></p>
                                    <p><a href="https://github.com/joerick/pyinstrument" target="_blank" rel="noopener">pyinstrument</a></p>
                                    <p><a href="https://github.com/plasma-umass/scalene" target="_blank" rel="noopener">scalene</a></p>
                                    <p>阿姆达尔定律：<a href="https://en.wikipedia.org/wiki/Amdahl&#39;s%20law" target="_blank" rel="noopener">Amdahl’s law</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-09 17:25:15" itemprop="dateCreated datePublished" datetime="2021-12-09T17:25:15+08:00">2021-12-09</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>685</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1813580861.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> vim <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1813580861.html" class="post-title-link" itemprop="url">vim文本基础操作</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="文本插入"><a href="#文本插入" class="headerlink" title="文本插入"></a>文本插入</h2>
                                    <p>几种进入插入模式的方法，以便于更快捷的编辑</p>
                                    <p><code>a</code>: 用于在光标之后进入插入模式</p>
                                    <p><code>A</code>: 用于当前行行末进入插入模式（与$a等价）</p>
                                    <p><code>i</code>: 在当前位置进入插入模式</p>
                                    <p><code>I</code>: 在当前行缩进之后的行首进入插入模式</p>
                                    <p><code>o</code>: 在光标下一行新增一行并进入插入模式</p>
                                    <p><code>O</code>: 在光标上一行新增一行并进入插入模式</p>
                                    <h2 id="窗口"><a href="#窗口" class="headerlink" title="窗口"></a>窗口</h2>
                                    <p>横向分割窗口： <code>split</code> 或者<code>sp</code></p>
                                    <p>纵向分割窗口： <code>vsplit</code> 或者 <code>vsp</code></p>
                                    <h3 id="窗口跳转"><a href="#窗口跳转" class="headerlink" title="窗口跳转"></a>窗口跳转</h3>
                                    <figure class="highlight dart">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">ctrl+w j 向下移动</span><br><span class="line">ctrl+w k 向上移动</span><br><span class="line">ctrl+w h 向左移动</span><br><span class="line">ctrl+w l  向右移动</span><br><span class="line">ctrl+w t 移动到顶端</span><br><span class="line">ctrl+w b 移动到底端</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="vim-模式"><a href="#vim-模式" class="headerlink" title="vim 模式"></a>vim 模式</h2>
                                    <p>普通模式：vi file_name,主要用于文件操作如浏览、增删改查</p>
                                    <p>输入模式：在普通模式下输入 <code>i</code> 即可进入输入模式</p>
                                    <p>命令模式：在普通模式下输入 <code>:</code> 进入命令模式，使用命令进行操作</p>
                                    <p>可视模式：在普通模式中输入 <code>v</code> 进入可视模式。类似于鼠标选中进行批量操作</p>
                                    <h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2>
                                    <p><code>g</code>: 跳至行首，<code>G</code>: 跳至文末尾</p>
                                    <p><code>cc</code>：删除这一行进入修改模式</p>
                                    <p><code>dd</code>: 删除一整行</p>
                                    <p><code>uu</code>：撤销上次操作</p>
                                    <p><code>yy</code>: 复制</p>
                                    <p><code>pp</code>：粘贴</p>
                                    <blockquote>
                                        <p>tips： 这里笔者使用了组合的形式来展示，其实不然，比如删除4行，可以是<code>d4d</code>, 删除5个单词为<code>d4w</code>,</p>
                                    </blockquote>
                                    <p>当然还可以结合 可视模式（多选）来辅助批量复制粘贴等。</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-07 16:49:09" itemprop="dateCreated datePublished" datetime="2021-12-07T16:49:09+08:00">2021-12-07</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>431</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1235432439.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> uiautomator2 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1235432439.html" class="post-title-link" itemprop="url">uiautomator2使用笔记</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="uiautomator2-简介"><a href="#uiautomator2-简介" class="headerlink" title="uiautomator2 简介"></a>uiautomator2 简介</h2>
                                    <p>UiAutomator是Google提供的用来做安卓自动化测试的一个Java库，基于Accessibility服务。功能很强，可以对第三方App进行测试，获取屏幕上任意一个APP的任意一个控件属性，并对其进行任意操作。而uiautomator2便是UiAutomator的Python实现</p>
                                    <p>除了对原有的库的bug进行了修复，还增加了很多新的Feature。主要有以下部分：</p>
                                    <ul>
                                        <li>设备和开发机可以脱离数据线，通过WiFi互联（基于<a href="https://github.com/openatx/atx-agent" target="_blank" rel="noopener">atx-agent</a>）</li>
                                        <li>集成了<a href="https://github.com/openstf/minicap" target="_blank" rel="noopener">openstf/minicap</a>达到实时屏幕投频，以及实时截图</li>
                                        <li>集成了<a href="https://github.com/openstf/minitouch" target="_blank" rel="noopener">openstf/minitouch</a>达到精确实时控制设备</li>
                                        <li>修复了<a href="https://github.com/xiaocong/uiautomator" target="_blank" rel="noopener">xiaocong/uiautomator</a>经常性退出的问题</li>
                                        <li>代码进行了重构和精简，方便维护</li>
                                        <li>实现了一个设备管理平台(也支持iOS) <a href="https://github.com/openatx/atxserver2" target="_blank" rel="noopener">atxserver2</a></li>
                                        <li>扩充了toast获取和展示的功能</li>
                                    </ul>
                                    <p>相关链接如下：</p>
                                    <p><a href="https://developer.android.com/training/testing/ui-automator.html" target="_blank" rel="noopener">UiAutomator</a>：<a href="https://developer.android.com/training/testing/ui-automator.html" target="_blank" rel="noopener">https://developer.android.com/training/testing/ui-automator.html</a></p>
                                    <p><a href="https://github.com/openatx/uiautomator2" target="_blank" rel="noopener">uiautomator2</a>： <a href="https://github.com/openatx/uiautomator2" target="_blank" rel="noopener">https://github.com/openatx/uiautomator2</a></p>
                                    <p><a href="https://github.com/openatx/uiautomator2/blob/master/QUICK_REFERENCE.md" target="_blank" rel="noopener">QUICK_REFERENCE</a>： <a href="https://github.com/openatx/uiautomator2/blob/master/QUICK_REFERENCE.md" target="_blank" rel="noopener">https://github.com/openatx/uiautomator2/blob/master/QUICK_REFERENCE.md</a></p>
                                    <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                                    <p>由于python实现的，在此可以使用<code>pip</code> 直接安装即可，命令如下</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># # 如果是在Windows平台下，未做`python3` 与 `python` 的link，在这里使用`python` 而不是`python3`</span></span><br><span class="line">python3 -m pip install --upgrade uiautomator2</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>Tips： 建议使用虚拟环境</p>
                                    </blockquote>
                                    <p>开发版安装</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">python3 -m pip install --upgrade --pre uiautomator2</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>源码安装</p>
                                    <blockquote>
                                        <p>需要git客户端，若未安装git，可移步<code>https://git-scm.com/downloads</code>进行下载，</p>
                                        <p>当然，源码也可以使用zip的方式进行下载，请自行探索</p>
                                    </blockquote>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">git <span class="built_in">clone</span> https://github.com/openatx/uiautomator2</span><br><span class="line">python3 -m pip install -e uiautomator2</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="校验"><a href="#校验" class="headerlink" title="校验"></a>校验</h3>
                                    <p>先准备一台（不要两台）开启了<code>开发者选项</code>的安卓手机，连接上电脑，确保执行<code>adb devices</code>可以看到连接上的设备。如下图所示</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gx45djlejbj30mr01e0sq.jpg" alt="image-20211206153159233"></p>
                                    <p>运行<code>python3 -m uiautomator2 init</code>安装包含httprpc服务的apk到手机+<code>atx-agent, minicap, minitouch</code></p>
                                    <blockquote>
                                        <p>在过去的版本中，这一步是必须执行的，但是从1.3.0之后的版本，当运行python代码<code>u2.connect()</code>时就会自动推送这些文件了</p>
                                    </blockquote>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">import</span> uiautomator2 <span class="keyword">as</span> u2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接设备(当只有只有一台设备的时候可以为空，当有多台设备可以是设备号或ip地址)</span></span><br><span class="line">device = u2.connect()</span><br><span class="line"><span class="comment"># get uiautomator2 device info</span></span><br><span class="line">pprint(device.info)</span><br><span class="line"><span class="comment"># get device info</span></span><br><span class="line">pprint(device.device_info)</span><br><span class="line"><span class="comment"># get device windows size</span></span><br><span class="line">print(device.window_size())</span><br><span class="line"><span class="comment"># get device wlan ip</span></span><br><span class="line">pprint(device.wlan_ip)</span><br><span class="line"><span class="comment"># get serial id</span></span><br><span class="line">pprint(device.serial)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gx45jkcixoj30d906qmxa.jpg" alt="image-20211206153746081"></p>
                                    <h2 id="app开启与关闭"><a href="#app开启与关闭" class="headerlink" title="app开启与关闭"></a>app开启与关闭</h2>
                                    <p>当我们需要打开对应的app时，需要知道对应设备的包名。获取包名有两种方式</p>
                                    <ul>
                                        <li>在设备上打开对应的app，获取当前app包名(<code>app_current()</code>)</li>
                                        <li>获取全部的应用包(<code>app_list_running()</code>)</li>
                                    </ul>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 开启app</span></span><br><span class="line">app_start</span><br><span class="line"><span class="comment"># 关闭app</span></span><br><span class="line">app_stop</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3>
                                    <blockquote>
                                        <p>此时笔者的测试手机在已经打开app</p>
                                    </blockquote>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Date         : 07-12-2021 </span></span><br><span class="line"><span class="comment"># @Author       : Payne</span></span><br><span class="line"><span class="comment"># @Email        : wuzhipeng1289690157@gmail.com</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br><span class="line"><span class="keyword">import</span> uiautomator2 <span class="keyword">as</span> u2</span><br><span class="line"></span><br><span class="line"><span class="comment"># content device</span></span><br><span class="line">device = u2.connect()</span><br><span class="line">logger.info(<span class="string">f"DEVICE INFO:<span class="subst">&#123;device.info&#125;</span>"</span>)</span><br><span class="line"><span class="comment"># check current app</span></span><br><span class="line">current_app = device.app_current()</span><br><span class="line"><span class="comment"># get the package</span></span><br><span class="line">device.app_start(current_app.get(<span class="string">'package'</span>), stop=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 正态分布休眠,模拟操作</span></span><br><span class="line">time.sleep(random.uniform(<span class="number">10</span>, <span class="number">20</span>))</span><br><span class="line"><span class="comment"># stop all app</span></span><br><span class="line">device.app_stop_all()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>Tips: 复习一下adb command</p>
                                    </blockquote>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># adb 命令 -- 获取报包名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># current （需要打开app）</span></span><br><span class="line">adb -s &#123;device_serial&#125; shell dumpsys activity | grep mFocusedActivity</span><br><span class="line"><span class="comment"># all</span></span><br><span class="line">adb -s &#123;device_serial&#125; shell pm list packages</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据关键字过滤包</span></span><br><span class="line">adb -s &#123;device_serial&#125; shell pm list packages | grep “keyword”</span><br><span class="line"><span class="comment"># 查看包安装位置 </span></span><br><span class="line">adb -s &#123;device_serial&#125; shell pm list packages -f</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="点击"><a href="#点击" class="headerlink" title="点击"></a>点击</h2>
                                    <ul>
                                        <li>
                                            <p>Turn on/off screen</p>
                                            <figure class="highlight routeros">
                                                <table>
                                                    <tr>
                                                        <td class="gutter">
                                                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                        </td>
                                                        <td class="code">
                                                            <pre><span class="line">d.screen_on() # turn on the screen</span><br><span class="line">d.screen_off() # turn off the screen</span><br></pre>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </figure>
                                        </li>
                                        <li>
                                            <p>Press hard/soft key</p>
                                            <figure class="highlight lsl">
                                                <table>
                                                    <tr>
                                                        <td class="gutter">
                                                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                        </td>
                                                        <td class="code">
                                                            <pre><span class="line">d.press(<span class="string">"home"</span>) # press the home <span class="type">key</span>, with <span class="type">key</span> name</span><br><span class="line">d.press(<span class="string">"back"</span>) # press the back <span class="type">key</span>, with <span class="type">key</span> name</span><br><span class="line">d.press(<span class="number">0x07</span>, <span class="number">0x02</span>) # press keycode <span class="number">0x07</span>('<span class="number">0</span>') with META ALT(<span class="number">0x02</span>)</span><br></pre>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </figure>
                                        </li>
                                        <li>
                                            <p>These key names are currently supported:</p>
                                            <ul>
                                                <li>
                                                    <p>home、back、</p>
                                                </li>
                                                <li>
                                                    <p>left、right、up、down</p>
                                                </li>
                                                <li>
                                                    <p>center、menu、search</p>
                                                </li>
                                                <li>
                                                    <p>enter、delete ( or del)</p>
                                                </li>
                                                <li>
                                                    <p>recent (recent apps)</p>
                                                </li>
                                                <li>
                                                    <p>volume_up、volume_down、volume_mute</p>
                                                </li>
                                                <li>
                                                    <p>camera、power</p>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>Click on the screen</p>
                                        </li>
                                    </ul>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">d.click(x, y)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <ul>
                                        <li>Double click</li>
                                    </ul>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">d.double_click(x, y)</span><br><span class="line">d.double_click(x, y, 0.1) <span class="comment"># default duration between two click is 0.1s</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <ul>
                                        <li>long_click</li>
                                    </ul>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">d.long_click(x, y)</span><br><span class="line">d.long_click(x, y, 0.5) <span class="comment"># long click 0.5s (default)</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="滑动"><a href="#滑动" class="headerlink" title="滑动"></a>滑动</h2>
                                    <p><strong>Swipe</strong></p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Swipe</span></span><br><span class="line">swipe(self, fx, fy, tx, ty, duration: Optional[float] = <span class="literal">None</span>, steps: Optional[int] = <span class="literal">None</span>)</span><br><span class="line">fx, fy：起始坐标</span><br><span class="line">tx, ty：目标坐标</span><br><span class="line">duration： 持续时间（力度）</span><br><span class="line">steps： 分开滑动次数</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>swipe_ext</strong></p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">d.swipe_ext(<span class="string">"right"</span>) <span class="comment"># 手指右滑，4选1 "left", "right", "up", "down"</span></span><br><span class="line">d.swipe_ext(<span class="string">"right"</span>, scale=0.9) <span class="comment"># 默认0.9, 滑动距离为屏幕宽度的90%</span></span><br><span class="line">d.swipe_ext(<span class="string">"right"</span>, box=(0, 0, 100, 100)) <span class="comment"># 在 (0,0) -&gt; (100, 100) 这个区域做滑动</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 实践发现上滑或下滑的时候，从中点开始滑动成功率会高一些</span></span><br><span class="line">d.swipe_ext(<span class="string">"up"</span>, scale=0.8) <span class="comment"># 代码会vkk</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 还可以使用Direction作为参数</span></span><br><span class="line">from uiautomator2 import Direction</span><br><span class="line"></span><br><span class="line">d.swipe_ext(Direction.FORWARD) <span class="comment"># 页面下翻, 等价于 d.swipe_ext("up"), 只是更好理解</span></span><br><span class="line">d.swipe_ext(Direction.BACKWARD) <span class="comment"># 页面上翻</span></span><br><span class="line">d.swipe_ext(Direction.HORIZ_FORWARD) <span class="comment"># 页面水平右翻</span></span><br><span class="line">d.swipe_ext(Direction.HORIZ_BACKWARD) <span class="comment"># 页面水平左翻</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>Drag</strong></p>
                                    <figure class="highlight vim">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">d.drag(sx, <span class="keyword">sy</span>, <span class="keyword">ex</span>, ey)</span><br><span class="line">d.drag(sx, <span class="keyword">sy</span>, <span class="keyword">ex</span>, ey, <span class="number">0.5</span>) </span><br><span class="line"></span><br><span class="line">sx, <span class="keyword">sy</span>：起始坐标</span><br><span class="line"><span class="keyword">ex</span>, ey：目标坐标</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>Swipe points</strong></p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># swipe from point(x0, y0) to point(x1, y1) then to point(x2, y2)</span></span><br><span class="line"><span class="comment"># time will speed 0.2s bwtween two points</span></span><br><span class="line"><span class="comment"># swipe_points(self, points, duration: float = 0.5)</span></span><br><span class="line">d.swipe_points([(x0, y0), (x1, y1), (x2, y2)], <span class="number">0.2</span>))</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2>
                                    <p>选择器是一种在当前窗口中识别特定 UI 对象的便捷机制, 很多时候仅按照坐标时点击并不精确，通用型不强。</p>
                                    <p>选择器支持以下参数。有关详细信息，请参阅<a href="http://developer.android.com/tools/help/uiautomator/UiSelector.html" target="_blank" rel="noopener">UiSelector Java 文档</a>。</p>
                                    <ul>
                                        <li><code>text</code>, <code>textContains</code>, <code>textMatches</code>,<code>textStartsWith</code></li>
                                        <li><code>className</code>, <code>classNameMatches</code></li>
                                        <li><code>description</code>, <code>descriptionContains</code>, <code>descriptionMatches</code>,<code>descriptionStartsWith</code></li>
                                        <li><code>checkable</code>, <code>checked</code>, <code>clickable</code>,<code>longClickable</code></li>
                                        <li><code>scrollable</code>, <code>enabled</code>, <code>focusable</code>, <code>focused</code>,<code>selected</code></li>
                                        <li><code>packageName</code>, <code>packageNameMatches</code></li>
                                        <li><code>resourceId</code>, <code>resourceIdMatches</code></li>
                                        <li><code>index</code>, <code>instance</code></li>
                                    </ul>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-12-06 14:51:53" itemprop="dateCreated datePublished" datetime="2021-12-06T14:51:53+08:00">2021-12-06</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.8k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>2 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/882995737.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Redis <i class="label-arrow"></i>
                                    </a>
                                    <a href="/882995737.html" class="post-title-link" itemprop="url">redis持久化那些事儿</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="Redis-持久化"><a href="#Redis-持久化" class="headerlink" title="Redis 持久化"></a>Redis 持久化</h2>
                                    <p>redis的持久化方式有两种，一种是RDB持久化，一种是AOF持久化。</p>
                                    <h1 id="RDB快照（snapshot）"><a href="#RDB快照（snapshot）" class="headerlink" title="RDB快照（snapshot）"></a>RDB快照（snapshot）</h1>
                                    <p>redis把数据以快照的方式保存在磁盘上。默认的情况下，redis将数据保存在文件名为dump.rdb的二进制文件中。</p>
                                    <p>redis在运行时，会把内存中的数据快照保存到磁盘上，在redis重启时，会从rdb文件中读取数据还原redis数据库的状态。</p>
                                    <p>rdb是自动默认开启的，但并没有开启触发规则。</p>
                                    <h2 id="触发机制"><a href="#触发机制" class="headerlink" title="触发机制"></a>触发机制</h2>
                                    <p>RDB的触发可分为两大类，一类是自动触发，一类是手动触发。</p>
                                    <p>自动触发</p>
                                    <h3 id="自动触发"><a href="#自动触发" class="headerlink" title="自动触发"></a>自动触发</h3>
                                    <p>当数据操作满足一定的规则，自动触发。详细规则如下</p>
                                    <blockquote>
                                        <p>默认开启rdb，但没有配置规则，若需要使用或配置则需要在配置文件中将注释放开</p>
                                    </blockquote>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># RDB自动持久化规则</span></span><br><span class="line"><span class="comment"># 当900 秒内有至少有 1 个键被改动时，自动进行数据集保存操作</span></span><br><span class="line"><span class="string">save</span> <span class="number">900</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># 当 300 秒内有至少有 10 个键被改动时，自动进行数据集保存操作</span></span><br><span class="line"><span class="string">save</span> <span class="number">300</span> <span class="number">10</span></span><br><span class="line"><span class="comment"># 当 60 秒内有至少有 10000 个键被改动时，自动进行数据集保存操作</span></span><br><span class="line"><span class="string">save</span> <span class="number">60</span> <span class="number">10000</span></span><br><span class="line"><span class="comment"># RDB持久化文件名</span></span><br><span class="line"><span class="string">dbfilename</span> <span class="string">dump.rdb</span></span><br><span class="line"><span class="comment"># 数据持久化文件存储目录</span></span><br><span class="line"><span class="string">dir</span> <span class="string">/var/lib/redis</span></span><br><span class="line"><span class="comment"># bgsave发生错误时是否停止写入，通常为yes</span></span><br><span class="line"><span class="string">stop-writes-on-bgsave-error</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment"># rdb文件是否使用压缩格式</span></span><br><span class="line"><span class="string">rdbcompression</span> <span class="literal">yes</span></span><br><span class="line"><span class="comment"># 是否对rdb文件进行校验和检验，通常为yes</span></span><br><span class="line"><span class="string">rdbchecksum</span> <span class="literal">yes</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="手动触发"><a href="#手动触发" class="headerlink" title="手动触发"></a>手动触发</h3>
                                    <h4 id="save命令"><a href="#save命令" class="headerlink" title="save命令"></a>save命令</h4>
                                    <p>在客户端执行save命令，会触发一次保存快照。save命令是同步命令，在save执行时，会占用主进程，导致redis其他命令无法使用。在数据量过大时，可能会导致redis反应变慢。</p>
                                    <h4 id="bgsave命令"><a href="#bgsave命令" class="headerlink" title="bgsave命令"></a>bgsave命令</h4>
                                    <p>bgsave命令是异步操作，执行bgsave命令保存快照，可以在生成快照的同时，依然可以正常处理其他命令。bgsave子进程是由主线程fock生成的，它不影响主进程的执行，同时还可以共享主进程的数据</p>
                                    <h4 id="save和bgsave对比"><a href="#save和bgsave对比" class="headerlink" title="save和bgsave对比"></a>save和bgsave对比</h4>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>命令</th>
                                                    <th>save</th>
                                                    <th>bgsave</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>IO类型</td>
                                                    <td>同步</td>
                                                    <td>异步</td>
                                                </tr>
                                                <tr>
                                                    <td>是否阻塞redis</td>
                                                    <td>是</td>
                                                    <td>是(在生成子进程时有短暂阻塞，速度很快，基本没有影响)</td>
                                                </tr>
                                                <tr>
                                                    <td>时间复杂度</td>
                                                    <td>O(n)</td>
                                                    <td>O(n)</td>
                                                </tr>
                                                <tr>
                                                    <td>优点</td>
                                                    <td>不消耗额外内存</td>
                                                    <td>不阻塞客户端</td>
                                                </tr>
                                                <tr>
                                                    <td>缺点</td>
                                                    <td>阻塞客户端命令</td>
                                                    <td>需要fork子进程，消耗内存</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <h3 id="关闭RDB"><a href="#关闭RDB" class="headerlink" title="关闭RDB"></a>关闭RDB</h3>
                                    <p>虽然这种方式可能不需要，但若需要关闭rdb的时候，在redis-shell中只需要执行即可</p>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">config set save ""</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>当然也可以在配置文件中将 <code>save &quot;&quot;</code> 注释打开，也可以。</p>
                                    <h1 id="AOF（Append-Only-File）"><a href="#AOF（Append-Only-File）" class="headerlink" title="AOF（Append Only File）"></a>AOF（Append Only File）</h1>
                                    <blockquote>
                                        <p>默认情况下，Redis 异步转储磁盘上的数据集。RDB模式在很多应用场景中已经足够好了，但是 Redis 进程的问题或断电可能会导致几分钟的写入丢失（取决于配置的保存点）。 Append Only File 是另一种持久性模式，可提供更好的持久性。<br>例如，使用默认的数据 fsync 策略（见后面的配置文件）Redis 可能会在服务器断电等戏剧性事件中丢失一秒钟的写入，或者如果 Redis 进程本身发生问题，则会丢失一次写入，但是操作系统仍然正常运行。可以同时启用 AOF 和 RDB 持久化。如果在启动时启用了 AOF，Redis 将加载 AOF，即具有更好持久性保证的文件。</p>
                                    </blockquote>
                                    <p>AOF是通过将修改的每一条指令写入一个记录文件件appendonly.aof中(先写入os cache，每隔一段时间 fsync到磁盘)。这样子的话，在redis重启时，可以通过读取指令来重新写入数据达到重建数据库的目的。</p>
                                    <h2 id="开启AOF"><a href="#开启AOF" class="headerlink" title="开启AOF"></a>开启AOF</h2>
                                    <p>可以通过修改配置文件来打开AOF功能与命令，配置文件中如下：</p>
                                    <blockquote>
                                        <p>在配置文件中将 <code>appendonly yes</code>注释打开即可</p>
                                    </blockquote>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">appendonly yes</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>命令</p>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">config set appendonly yes</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="AOF保存策略"><a href="#AOF保存策略" class="headerlink" title="AOF保存策略"></a>AOF保存策略</h2>
                                    <ul>
                                        <li>appendfsync always：每次有新命令追加到 AOF 文件时就执行一次 fsync ，非常慢，也非常安全。</li>
                                        <li>appendfsync everysec：每秒 fsync 一次，足够快，并且在故障时只会丢失 1 秒钟的数据。</li>
                                        <li>appendfsync no：从不 fsync ，将数据交给操作系统来处理。更快，也更不安全的选择。</li>
                                    </ul>
                                    <blockquote>
                                        <p>推荐（也就是默认）的措施为每秒 fsync 一次， 这种 fsync 策略可以兼顾速度和安全性。</p>
                                    </blockquote>
                                    <h2 id="AOF重写"><a href="#AOF重写" class="headerlink" title="AOF重写"></a>AOF重写</h2>
                                    <p>由于AOF不断的将命令追加到文件的末尾，因此随着命令的不断增加，AOF文件的体积会变的越来越大。</p>
                                    <p>例如执行INCR命令执行了1000次，在AOF内会生成1000个操作命令。但实际上来说，只需要SET到当前值的命令就可以存储了，前面的999次INCR都是无意义的。</p>
                                    <blockquote>
                                        <p>实际上可能不止这一种多余的废操作，因此Redis可以对AOF文件进行重写，会把命令进行精简整合成一个新的AOF文件，新的文件里包含生成当前数据的最少命令。</p>
                                    </blockquote>
                                    <p>执行AOF重写的方式也有两种，一种是命令，一种是配置文件</p>
                                    <h3 id="配置文件配置aof重写"><a href="#配置文件配置aof重写" class="headerlink" title="配置文件配置aof重写"></a>配置文件配置aof重写</h3>
                                    <blockquote>
                                        <p>默认开启重写，但需要先开始aof</p>
                                    </blockquote>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="meta">#</span><span class="bash"> 当前大小大于指定的百分比触发重写</span></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line"><span class="meta">#</span><span class="bash"> AOF 文件指定最小大小</span></span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>将此基本大小与当前大小进行比较。如果当前大小大于指定的百分比，则触发重写。此外，您还需要为要重写的 AOF 文件指定最小大小，这对于避免重写 AOF 文件（即使达到百分比增加但仍然很小）很有用。指定百分比为零以禁用自动 AOF 重写功能。</p>
                                    </blockquote>
                                    <h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">bgrewriteaof</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h1 id="RDB-与-AOF对比"><a href="#RDB-与-AOF对比" class="headerlink" title="RDB 与 AOF对比"></a>RDB 与 AOF对比</h1>
                                    <h2 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h2>
                                    <p><strong>优点</strong></p>
                                    <ul>
                                        <li>文件紧凑，很适合进行数据备份和容灾恢复</li>
                                        <li>恢复大量数据时RDB速度快</li>
                                    </ul>
                                    <p><strong>缺点</strong></p>
                                    <ul>
                                        <li>数据量越大，二进制保存到磁盘会耗时越久</li>
                                        <li>遇见意外的情况下，如宕机等，可能导致未持久化的数据完全丢失</li>
                                    </ul>
                                    <h2 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h2>
                                    <p><strong>优点</strong></p>
                                    <ul>
                                        <li>可以使用不同的fsync策略，在默认的每秒fsync下，最多丢失1s的数据</li>
                                        <li>AOF的持久化记录是文件追加，保存速度快</li>
                                        <li>存储的是操作命令，AOF文件易读，可以轻易的进行文件分析</li>
                                    </ul>
                                    <p><strong>缺点</strong></p>
                                    <ul>
                                        <li>文件体积较RDB大</li>
                                        <li>重启时恢复数据速度较慢</li>
                                    </ul>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>类型</th>
                                                    <th>RDB</th>
                                                    <th>AOF</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>启动优先级</td>
                                                    <td>低</td>
                                                    <td>高</td>
                                                </tr>
                                                <tr>
                                                    <td>体积</td>
                                                    <td>小</td>
                                                    <td>大</td>
                                                </tr>
                                                <tr>
                                                    <td>宕机恢复速度</td>
                                                    <td>快</td>
                                                    <td>慢</td>
                                                </tr>
                                                <tr>
                                                    <td>数据安全性</td>
                                                    <td>可能丢失数据</td>
                                                    <td>每秒fsync最多丢失1s数据</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <h2 id="是rdb还是aof？"><a href="#是rdb还是aof？" class="headerlink" title="是rdb还是aof？"></a>是rdb还是aof？</h2>
                                    <p>使用可以根据需要来自行选择，如果对数据丢失不敏感的，使用rdb即可。当然在生产环境使用时，可以两种方式都启用。rdb文件可以用来做备份，aof文件来保证数据的安全性</p>
                                    <h2 id="RDB与AOF混用"><a href="#RDB与AOF混用" class="headerlink" title="RDB与AOF混用"></a>RDB与AOF混用</h2>
                                    <blockquote>
                                        <p>必须先开启aof</p>
                                    </blockquote>
                                    <pre><code>在redis4.0之后，出现了一个新的持久化选项——混合持久化。    可以通过以下配置开启混合持久化
</code></pre>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="meta">#</span><span class="bash"> 在配置文件中设置</span></span><br><span class="line">aof‐use‐rdb‐preamble yes</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>开启混合持久化后，AOF在重写时，不是单纯的把命令写入AOF文件，而是把重写这一刻之前的内存数据做RDB快照处理，在重写之后的还是继续使用AOF命令的形式保存。这样aof文件里就有历史的RDB快照和增量的AOF命令。<br>我们知道，RDB文件的恢复速度比AOF快的多，因此这种混合的模式，在redis重启的时候能大大提升效率。</p>
                                    <h1 id="Redis淘汰机制"><a href="#Redis淘汰机制" class="headerlink" title="Redis淘汰机制"></a>Redis淘汰机制</h1>
                                    <p>将内存使用限制设置为指定的字节数。当达到内存限制时，Redis 将尝试根据选择的驱逐策略删除键。</p>
                                    <p>MAXMEMORY 策略：</p>
                                    <blockquote>
                                        <p>当达到 maxmemory 时，Redis 将如何选择要删除的内容。可以从以下行为中选择一项</p>
                                    </blockquote>
                                    <p>noeviction：默认禁止驱逐数据。内存不够使用时，对申请内存的命令报错。</p>
                                    <p>volatile-lru：从设置了过期时间的数据集中淘汰最近没使用的数据。</p>
                                    <p>volatile-ttl：从设置了过期时间的数据集中淘汰即将要过期的数据。</p>
                                    <p>volatile-random：从设置了过期时间的数据中随机淘汰数据。</p>
                                    <p>allkeys-lru：淘汰最近没使用的数据。</p>
                                    <p>allkeys-random：随机淘汰数据。</p>
                                    <blockquote>
                                        <p>注意：使用上述任何一种策略，当没有合适的键用于驱逐时，Redis 将在需要更多内存的写操作时返回错误。这些通常是创建新密钥、添加数据或修改现有密钥的命令。一些示例是：SET、INCR、HSET、LPUSH、SUNIONSTORE、SORT（由于 STORE 参数）和 EXEC（如果事务包括任何需要内存的命令）。</p>
                                    </blockquote>
                                    <p>如果 Redis 无法根据策略删除键，或者如果策略设置为“noeviction”，Redis 将开始对会使用更多内存的命令（如 SET、LPUSH 等）回复错误信息，并将继续回复像 GET<br>这样的只读命令。简而言之…如果附加了副本，建议为 maxmemory 设置一个下限，以便系统上有一些空闲 RAM 用于副本输出缓冲区（但如果策略是“noeviction”，则不需要这样做）</p>
                                    <p>警告：如果您将副本附加到启用了 maxmemory 的实例，则从使用的内存计数中减去提供副本所需的输出缓冲区的大小，以便网络问题重新同步不会触发密钥被逐出的循环，并且在将副本的输出缓冲区填满，删除键的 DEL<br>触发删除更多键，依此类推，直到数据库完全清空</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-11-06 05:30:39" itemprop="dateCreated datePublished" datetime="2021-11-06T05:30:39+08:00">2021-11-06</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>3.1k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>3 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2104691580.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Visual Studio Code <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2104691580.html" class="post-title-link" itemprop="url">VsCode初始化配置</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2>
                                    <figure class="highlight json">
                                        <figcaption><span>lines</span></figcaption>
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"workbench.colorTheme"</span>: <span class="string">"Solarized Light"</span>,</span><br><span class="line">  <span class="attr">"files.autoSave"</span>: <span class="string">"afterDelay"</span>,</span><br><span class="line">  <span class="attr">"editor.formatOnSave"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"editor.fontSize"</span>: <span class="number">14</span>,</span><br><span class="line">  <span class="attr">"editor.fontFamily"</span>: <span class="string">"JetBrains Mono, Menlo, Monaco, 'Courier New', monospace"</span>,</span><br><span class="line">  <span class="attr">"editor.fontLigatures"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"search.exclude"</span>: &#123;</span><br><span class="line">    <span class="attr">"**/node_modules"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/bower_components"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/target"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/logs"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.git"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.svn"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.hg"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/CVS"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.DS_Store"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/*.js"</span>: &#123;</span><br><span class="line">      <span class="attr">"when"</span>: <span class="string">"$(basename).ts"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"**/.idea"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"files.exclude"</span>: &#123;</span><br><span class="line">    <span class="attr">"**/node_modules"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/bower_components"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/target"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/logs"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.git"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.svn"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.hg"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/CVS"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/.DS_Store"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"**/*.js"</span>: &#123;</span><br><span class="line">      <span class="attr">"when"</span>: <span class="string">"$(basename).ts"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"**/.idea"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="代码提示配置"><a href="#代码提示配置" class="headerlink" title="代码提示配置"></a>代码提示配置</h3>
                                    <p>settings -搜索-&gt; prevent -&gt; none</p>
                                    <h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2>
                                    <h3 id="Program-Language"><a href="#Program-Language" class="headerlink" title="Program Language"></a>Program Language</h3>
                                    <h4 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h4>
                                    <ul>
                                        <li>Python Docstring Generator</li>
                                        <li>Python</li>
                                        <li>Python Environment Manager</li>
                                        <li>Visual Studio IntelliCode</li>
                                        <li>Python Indent</li>
                                    </ul>
                                    <h4 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h4>
                                    <ul>
                                        <li>php-extension-pack</li>
                                    </ul>
                                    <h4 id="Cloud"><a href="#Cloud" class="headerlink" title="Cloud"></a>Cloud</h4>
                                    <ul>
                                        <li>DevOps Cloud Extension pack</li>
                                    </ul>
                                    <h4 id="Reception"><a href="#Reception" class="headerlink" title="Reception"></a>Reception</h4>
                                    <ul>
                                        <li>VS Code JavaScript (ES6) snippets</li>
                                        <li>open in browser</li>
                                        <li>auto complete Tag</li>
                                        <li>auto rename Tag</li>
                                        <li>auto close Tag</li>
                                        <li>Import Cost</li>
                                    </ul>
                                    <h4 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h4>
                                    <ul>
                                        <li>vscode-icons</li>
                                        <li>vsc-essentials</li>
                                        <li>gitlens: <code>git config pull.rebase false</code></li>
                                    </ul>
                                    <p>code studio pack</p>
                                    <h2 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h2>
                                    <h3 id="Window"><a href="#Window" class="headerlink" title="Window"></a>Window</h3>
                                    <p><code>Alt + →</code> ：代码前进下一级</p>
                                    <p><code>Alt + ←</code> ：代码返回上一级</p>
                                    <hr>
                                    <p><code>Ctrl + K + 0</code>: 收缩所有代码(0是代码折叠级别，同理可以换用1，2，3等)</p>
                                    <p><code>Ctrl + K + J</code>: 取消收缩所有代码</p>
                                    <hr>
                                    <p><code>Ctrl + K + S</code>：快捷键文档</p>
                                    <p><code>Alt + Shift + F</code> ：代码格式化</p>
                                    <p><code>Ctrl + Shift + P</code>： 显示所有命令</p>
                                    <p><code>Ctrl + P</code>： 显示所有命令</p>
                                    <h3 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h3>
                                    <ul>
                                        <li>
                                            <p><code>Ctrl + -</code>：代码返回上一级</p>
                                        </li>
                                        <li>
                                            <p><code>Ctrl + Shift + -</code>： 代码前进下一级</p>
                                        </li>
                                    </ul>
                                    <hr>
                                    <ul>
                                        <li>
                                            <p><code>Command + K + 0</code>: 收缩所有代码(0是代码折叠级别，同理可以换用1，2，3等)</p>
                                        </li>
                                        <li>
                                            <p><code>Command + K + J</code> 取消收缩所有代码</p>
                                        </li>
                                    </ul>
                                    <hr>
                                    <ul>
                                        <li>
                                            <p><code>Command + K + S</code>：快捷键文档</p>
                                        </li>
                                        <li>
                                            <p><code>Opt + Shift + F</code> ：代码格式化</p>
                                        </li>
                                        <li>
                                            <p><code>Command + Shift + P</code>： 显示所有命令</p>
                                        </li>
                                        <li>
                                            <p><code>Command + p</code> ：打开最近文件</p>
                                        </li>
                                    </ul>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-11-05 20:01:44" itemprop="dateCreated datePublished" datetime="2021-11-05T20:01:44+08:00">2021-11-05</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>710</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1614406133.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Mac <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1614406133.html" class="post-title-link" itemprop="url">Reset VsCode config</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="重置-Visual-Studio-Code所有配置"><a href="#重置-Visual-Studio-Code所有配置" class="headerlink" title="重置 Visual Studio Code所有配置"></a>重置 Visual Studio Code所有配置</h2>
                                    <p>随着使用期限的增长，各种问题便逐渐出现啦。当我们对于Visual Studio Code因为配置问题而造成使用不适，此处有一剂良药——初始化配置</p>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">rm -rf ~/.vscode</span><br><span class="line">rm -rf ~/Library/Application\ Support/Code</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-11-04 17:29:48" itemprop="dateCreated datePublished" datetime="2021-11-04T17:29:48+08:00">2021-11-04</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>92</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2559205426.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Go <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2559205426.html" class="post-title-link" itemprop="url">golang配置神器viper</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="Viper简介"><a href="#Viper简介" class="headerlink" title="Viper简介"></a>Viper简介</h2>
                                    <p>Viper是一个完整的Go语言项目的配置解决方案。它可以处理所有类型的配置需求和格式，相关链接如下</p>
                                    <p>包文档：<a href="https://pkg.go.dev/github.com/spf13/viper" target="_blank" rel="noopener">https://pkg.go.dev/github.com/spf13/viper</a></p>
                                    <p>github：<a href="https://github.com/spf13/viper" target="_blank" rel="noopener">https://github.com/spf13/viper</a></p>
                                    <h2 id="Viper的优势"><a href="#Viper的优势" class="headerlink" title="Viper的优势"></a>Viper的优势</h2>
                                    <p>在构建Golang程序时可以不必担心配置文件格式而更专注于实现。</p>
                                    <p>viper主要包含以下操作：</p>
                                    <ol>
                                        <li>查找、加载和反序列化 “json”, “toml”, “yaml”, “yml”, “properties”, “props”, “prop”, “hcl”, “tfvars”, “dotenv”, “env”, “ini”</li>
                                        <li>提供一种机制来为不同的配置选项设置默认值。</li>
                                        <li>提供一种机制来为通过命令行参数设置指定覆盖值。</li>
                                        <li>提供别名，以在不破坏现有代码的情况下轻松重命名参数。</li>
                                        <li>使区分用户何时提供与默认值相同的命令行或配置文件变得容易。</li>
                                    </ol>
                                    <p>每个项目的优先级都高于它下面的项目，Viper优先顺序。</p>
                                    <ul>
                                        <li>显式调用 <code>Set</code></li>
                                        <li>命令行参数（flag）</li>
                                        <li>环境变量</li>
                                        <li>配置文件</li>
                                        <li>key/value存储</li>
                                        <li>默认值</li>
                                    </ul>
                                    <blockquote>
                                        <p><strong>重要提示：</strong> Viper 配置键不区分大小写。正在进行关于使之成为可选项的讨论。</p>
                                    </blockquote>
                                    <h2 id="Viper使用场景"><a href="#Viper使用场景" class="headerlink" title="Viper使用场景"></a>Viper使用场景</h2>
                                    <ul>
                                        <li>设置默认值</li>
                                        <li>“json”, “toml”, “yaml”, “yml”, “properties”, “props”, “prop”, “hcl”, “tfvars”, “dotenv”, “env”, “ini”文件中读取载入</li>
                                        <li>实时观看和重新读取配置文件（可选）</li>
                                        <li>从环境变量中读取</li>
                                        <li>从远程配置系统（etcd 或 Consul）读取，并观察变化</li>
                                        <li>从命令行标志读取</li>
                                        <li>从缓冲区读取</li>
                                        <li>设置显式值</li>
                                    </ul>
                                    <blockquote>
                                        <p>Viper 可以被认为是满足所有应用程序配置需求的注册表</p>
                                    </blockquote>
                                    <h2 id="Viper的安装"><a href="#Viper的安装" class="headerlink" title="Viper的安装"></a>Viper的安装</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">go get -u -v github.com/spf13/viper</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Viper使用实例"><a href="#Viper使用实例" class="headerlink" title="Viper使用实例"></a>Viper使用实例</h2>
                                    <h3 id="使用默认值"><a href="#使用默认值" class="headerlink" title="使用默认值"></a>使用默认值</h3>
                                    <p>一个好的配置系统对于默认值拥有良好的支持，其重要性不言而喻。在Viper中的默认值使用如下</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"github.com/spf13/viper"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	viper.SetDefault(<span class="string">`Name`</span>, <span class="string">`Payne`</span>)</span><br><span class="line">	viper.SetDefault(<span class="string">`Age`</span>, <span class="number">20</span>)</span><br><span class="line">	viper.SetDefault(<span class="string">`hobby`</span>, <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="string">`First hobby`</span>:  <span class="string">`sing`</span>,</span><br><span class="line">		<span class="string">`Second hobby`</span>: <span class="string">`jump`</span>,</span><br><span class="line">		<span class="string">`Third hobby`</span>:  <span class="string">`Rap`</span>,</span><br><span class="line">		<span class="string">`fourth hobby`</span>: <span class="string">`Play Basketball`</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	fmt.Println(viper.Get(<span class="string">`Name`</span>))</span><br><span class="line">	fmt.Println(viper.Get(<span class="string">`Age`</span>))</span><br><span class="line">	fmt.Println(viper.Get(<span class="string">`hobby`</span>))</span><br><span class="line">	<span class="keyword">for</span> _, i := <span class="keyword">range</span> viper.GetStringMapString(<span class="string">`hobby`</span>) &#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="覆盖设置"><a href="#覆盖设置" class="headerlink" title="覆盖设置"></a>覆盖设置</h3>
                                    <p>这些可能来自命令行标志，也可能来自你自己的应用程序逻辑。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.Set(<span class="string">"Verbose"</span>, <span class="literal">true</span>)</span><br><span class="line">viper.Set(<span class="string">"LogFile"</span>, LogFile)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="注册和使用别名"><a href="#注册和使用别名" class="headerlink" title="注册和使用别名"></a>注册和使用别名</h3>
                                    <p>别名允许多个键引用单个值</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.RegisterAlias(<span class="string">"loud"</span>, <span class="string">"Verbose"</span>)  <span class="comment">// 注册别名（此处loud和Verbose建立了别名）</span></span><br><span class="line"></span><br><span class="line">viper.Set(<span class="string">"verbose"</span>, <span class="literal">true</span>) </span><br><span class="line">viper.Set(<span class="string">"loud"</span>, <span class="literal">true</span>)  </span><br><span class="line"></span><br><span class="line">viper.GetBool(<span class="string">"loud"</span>) <span class="comment">// true</span></span><br><span class="line">viper.GetBool(<span class="string">"verbose"</span>) <span class="comment">// true</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="配置文件使用"><a href="#配置文件使用" class="headerlink" title="配置文件使用"></a>配置文件使用</h2>
                                    <h3 id="读取配置文件"><a href="#读取配置文件" class="headerlink" title="读取配置文件"></a>读取配置文件</h3>
                                    <p>抽离统一化管理成为配置文件，将所有的配置写在文件中便于管理修改与编辑。Viper 支持 “json”, “toml”, “yaml”, “yml”, “properties”, “props”, “prop”, “hcl”, “<br>tfvars”, “dotenv”, “env”, “ini” 属性文件。Viper 可以搜索多个路径，但目前单个 Viper 实例仅支持单个配置文件。Viper<br>不会默认任何配置搜索路径，将默认决定留给应用程序。不需要任何特定路径，但应至少提供一个需要配置文件的路径。以下是如何使用 Viper 搜索和读取配置文件的示例。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// 指定配置文件路径</span></span><br><span class="line">viper.SetConfigFile(<span class="string">"./config.yaml"</span>) 			</span><br><span class="line"><span class="comment">// 配置文件名称(无扩展名)</span></span><br><span class="line">viper.SetConfigName(<span class="string">"config"</span>) 						</span><br><span class="line"><span class="comment">// 如果配置文件的名称中没有扩展名，则需要配置此项</span></span><br><span class="line">viper.SetConfigType(<span class="string">"yaml"</span>) 							</span><br><span class="line"><span class="comment">// 查找配置文件所在的路径</span></span><br><span class="line">viper.AddConfigPath(<span class="string">"/etc/appname/"</span>)   		</span><br><span class="line"><span class="comment">// 多次调用以添加多个搜索路径</span></span><br><span class="line">viper.AddConfigPath(<span class="string">"$HOME/.appname"</span>)  		</span><br><span class="line"><span class="comment">// 还可以在工作目录中查找配置</span></span><br><span class="line">viper.AddConfigPath(<span class="string">"."</span>)               		</span><br><span class="line"><span class="comment">// 查找并读取配置文件</span></span><br><span class="line">err := viper.ReadInConfig() 							</span><br><span class="line"><span class="comment">// 处理读取配置文件的错误</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123; 													</span><br><span class="line">	<span class="built_in">panic</span>(fmt.Errorf(<span class="string">"Fatal error config file: %s \n"</span>, err))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置文件读取异常处理</span></span><br><span class="line"><span class="keyword">if</span> err := viper.ReadInConfig(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> _, ok := err.(viper.ConfigFileNotFoundError); ok &#123;</span><br><span class="line">			<span class="comment">// Config file not found; ignore error if desired</span></span><br><span class="line">			log.Println(<span class="string">"no such config file"</span>)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="comment">// Config file was found but another error was produced</span></span><br><span class="line">			log.Println(<span class="string">"read config error"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		log.Fatal(err) <span class="comment">// 读取配置文件失败致命错误</span></span><br><span class="line">	&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p><strong>注意</strong>若采用<code>setConfigName</code>则只会使用第一个配置文件夹</p>
                                        <p>推荐使用<code>SetConfigFile(&quot;path/file_name&quot;)</code> 来完成配置文件的载入</p>
                                    </blockquote>
                                    <h3 id="从io-Reader读取配置"><a href="#从io-Reader读取配置" class="headerlink" title="从io.Reader读取配置"></a>从io.Reader读取配置</h3>
                                    <p>Viper预先定义了许多配置源，如文件、环境变量、标志和远程K/V存储，但也可以实现自己所需的配置源并将其提供给viper。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bytes"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"github.com/spf13/viper"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">yamlConf</span><span class="params">()</span></span> &#123;</span><br><span class="line">	viper.SetConfigType(<span class="string">"yaml"</span>) </span><br><span class="line">	ExampleYaml := []<span class="keyword">byte</span>(<span class="string">`</span></span><br><span class="line"><span class="string">name: Payne</span></span><br><span class="line"><span class="string">Age: 18</span></span><br><span class="line"><span class="string">`</span>)</span><br><span class="line">	viper.ReadConfig(bytes.NewBuffer(ExampleYaml))</span><br><span class="line">	fmt.Println(viper.Get(<span class="string">"NAME"</span>))</span><br><span class="line">	fmt.Println(viper.Get(<span class="string">"Age"</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">jsonConf</span><span class="params">()</span></span> &#123;</span><br><span class="line">	viper.SetConfigType(<span class="string">`json`</span>)</span><br><span class="line"></span><br><span class="line">	ExampleJSON := []<span class="keyword">byte</span>(<span class="string">`&#123;</span></span><br><span class="line"><span class="string"> 	"name": "payne",</span></span><br><span class="line"><span class="string"> 	"age": 21</span></span><br><span class="line"><span class="string">&#125;`</span>)</span><br><span class="line">	viper.ReadConfig(bytes.NewBuffer(ExampleJSON))</span><br><span class="line">	fmt.Println(viper.Get(<span class="string">"name"</span>))</span><br><span class="line">	fmt.Println(viper.GetInt(<span class="string">"age"</span>))</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="写入配置文件"><a href="#写入配置文件" class="headerlink" title="写入配置文件"></a>写入配置文件</h3>
                                    <p>从配置文件中读取是很有用的，但有时你想存储在运行时所作的所有修改都比较繁琐。viper提供了相关功能</p>
                                    <ul>
                                        <li>WriteConfig - 将当前的<code>viper</code>配置写入预定义的路径并覆盖（如果存在的话）。如果没有预定义的路径，则报错。</li>
                                        <li>SafeWriteConfig - 将当前的<code>viper</code>配置写入预定义的路径。如果没有预定义的路径，则报错。如果存在，将不会覆盖当前的配置文件。</li>
                                        <li>WriteConfigAs - 将当前的<code>viper</code>配置写入给定的文件路径。将覆盖给定的文件(如果它存在的话)。</li>
                                        <li>SafeWriteConfigAs - 将当前的<code>viper</code>配置写入给定的文件路径。不会覆盖给定的文件(如果它存在的话)。</li>
                                    </ul>
                                    <blockquote>
                                        <p>根据经验，标记为<code>safe</code>的所有方法都不会覆盖任何文件，而是直接创建（如果不存在），而默认行为是创建或截断。</p>
                                    </blockquote>
                                    <h3 id="监听配置文件"><a href="#监听配置文件" class="headerlink" title="监听配置文件"></a>监听配置文件</h3>
                                    <p>Viper支持在运行时实时读取配置文件的功能。</p>
                                    <p>需要重新启动服务器以使配置生效的日子已经一去不复返了，viper驱动的应用程序可以在运行时读取配置文件的更新，而不会错过任何消息。</p>
                                    <p>只需告诉viper实例watchConfig。可选地，你可以为Viper提供一个回调函数，以便在每次发生更改时运行。</p>
                                    <blockquote>
                                        <p><strong>确保在调用<code>WatchConfig()</code>之前添加了所有的配置路径。</strong></p>
                                    </blockquote>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.WatchConfig()</span><br><span class="line">viper.OnConfigChange(<span class="function"><span class="keyword">func</span><span class="params">(e fsnotify.Event)</span></span> &#123;</span><br><span class="line">  <span class="comment">// 配置文件发生变更之后会调用的回调函数</span></span><br><span class="line">	fmt.Println(<span class="string">"Config file changed:"</span>, e.Name)</span><br><span class="line">&#125;)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>实例</strong></p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"github.com/fsnotify/fsnotify"</span></span><br><span class="line">	<span class="string">"github.com/spf13/viper"</span></span><br><span class="line">	<span class="string">"log"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		viper.SetConfigFile(<span class="string">`./example/config.yaml`</span>)</span><br><span class="line">		<span class="keyword">if</span> err := viper.ReadInConfig(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> _, ok := err.(viper.ConfigFileNotFoundError); ok &#123;</span><br><span class="line">				<span class="comment">// Config file not found; ignore error if desired</span></span><br><span class="line">				log.Println(<span class="string">"no such config file"</span>)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// Config file was found but another error was produced</span></span><br><span class="line">				log.Println(<span class="string">"read config error"</span>)</span><br><span class="line">			&#125;</span><br><span class="line">			log.Fatal(err) <span class="comment">// 读取配置文件失败致命错误</span></span><br><span class="line">		&#125;</span><br><span class="line">		viper.SetDefault(<span class="string">`a`</span>, <span class="string">`b`</span>)</span><br><span class="line">		viper.WatchConfig()</span><br><span class="line">		viper.OnConfigChange(<span class="function"><span class="keyword">func</span><span class="params">(e fsnotify.Event)</span></span> &#123;</span><br><span class="line">			<span class="comment">// 配置文件发生变更之后会调用的回调函数</span></span><br><span class="line">			fmt.Println(<span class="string">"Config file changed:"</span>, e.Name)</span><br><span class="line">		&#125;)</span><br><span class="line">		fmt.Println(viper.Get(<span class="string">`port`</span>))</span><br><span class="line">		time.Sleep(time.Second * <span class="number">2</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2>
                                    <p>Viper完全支持环境变量。以下几种方法进行对ENV协作:</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// AllowEmptyEnv 告诉 Viper 将设置但为空的环境变量视为有效值，而不是回退。出于向后兼容性的原因，默认情况下这是错误的</span></span><br><span class="line">AllowEmptyEnv(allowEmptyEnv <span class="keyword">bool</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">// AutomaticEnv 使 Viper 检查环境变量是否与任何现有键（配置、默认值或标志）匹配。如果找到匹配的环境变量，则将它们加载到 Viper 中</span></span><br><span class="line">AutomaticEnv()</span><br><span class="line"></span><br><span class="line"><span class="comment">// BindEnv 将 Viper 键绑定到 ENV 变量。ENV 变量区分大小写。如果只提供了一个键，它将使用与键匹配的 env 键，大写。如果提供了更多参数，它们将表示应绑定到此键的环境变量名称，并将按指定顺序使用。当未提供 env 名称时，将在设置时使用 EnvPrefix。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BindEnv</span><span class="params">(input ...<span class="keyword">string</span>)</span> <span class="title">error</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// SetEnvPrefix 定义了 ENVIRONMENT 变量将使用的前缀</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetEnvPrefix</span><span class="params">(in <span class="keyword">string</span>)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// SetEnvKeyReplacer允许你使用strings.Replacer对象在一定程度上重写 Env 键</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetEnvKeyReplacer</span><span class="params">(r *strings.Replacer)</span></span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p><strong><em>使用ENV变量时，务必要意识到Viper将ENV变量视为区分大小写。</em></strong></p>
                                    </blockquote>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// case 1</span></span><br><span class="line">i := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  viper.SetDefault(<span class="string">`Val`</span>, <span class="string">`Original`</span>)</span><br><span class="line">  viper.BindEnv(<span class="string">`Val`</span>)</span><br><span class="line">  fmt.Println(viper.Get(<span class="string">`Val`</span>))</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通常是在应用程序之外完成的</span></span><br><span class="line">  <span class="keyword">if</span> i == <span class="number">3</span> &#123;</span><br><span class="line">    os.Setenv(<span class="string">"VAL"</span>, <span class="string">"changed"</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fmt.Println(i)</span><br><span class="line">  i += <span class="number">1</span></span><br><span class="line">  time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// case 2</span></span><br><span class="line">i := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">  viper.SetDefault(<span class="string">`Val`</span>, <span class="string">`Original`</span>)</span><br><span class="line">  viper.SetEnvPrefix(<span class="string">`CUSTOM`</span>) <span class="comment">// 将自动转为大写</span></span><br><span class="line">  viper.BindEnv(<span class="string">`Val`</span>)</span><br><span class="line">  fmt.Println(viper.Get(<span class="string">`Val`</span>))</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 通常是在应用程序之外完成的</span></span><br><span class="line">  <span class="keyword">if</span> i == <span class="number">3</span> &#123;</span><br><span class="line">    os.Setenv(<span class="string">"CUSTOM_VAL"</span>, <span class="string">"changed"</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  fmt.Println(i)</span><br><span class="line">  i += <span class="number">1</span></span><br><span class="line">  time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>当第四次输出时<code>VAL</code>,将输出<code>change</code></p>
                                        <p>小技巧：在使用环境变量的时候推荐采用全大写，避免混淆</p>
                                    </blockquote>
                                    <h2 id="使用viper获取值"><a href="#使用viper获取值" class="headerlink" title="使用viper获取值"></a>使用viper获取值</h2>
                                    <blockquote>
                                        <p>获取函数如下所示，具体作用见名思意</p>
                                    </blockquote>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">Get(key <span class="keyword">string</span>) <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">Sub(key <span class="keyword">string</span>) *Viper</span><br><span class="line">GetBool(key <span class="keyword">string</span>) <span class="keyword">bool</span></span><br><span class="line">GetDuration(key <span class="keyword">string</span>) time.Duration</span><br><span class="line">GetFloat64(key <span class="keyword">string</span>) <span class="keyword">float64</span></span><br><span class="line">GetInt(key <span class="keyword">string</span>) <span class="keyword">int</span></span><br><span class="line">GetInt32(key <span class="keyword">string</span>) <span class="keyword">int32</span></span><br><span class="line">GetInt64(key <span class="keyword">string</span>) <span class="keyword">int64</span></span><br><span class="line">GetIntSlice(key <span class="keyword">string</span>) []<span class="keyword">int</span></span><br><span class="line">GetSizeInBytes(key <span class="keyword">string</span>) <span class="keyword">uint</span></span><br><span class="line">GetString(key <span class="keyword">string</span>) <span class="keyword">string</span></span><br><span class="line">GetStringMap(key <span class="keyword">string</span>) <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">GetStringMapString(key <span class="keyword">string</span>) <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">GetStringMapStringSlice(key <span class="keyword">string</span>) <span class="keyword">map</span>[<span class="keyword">string</span>][]<span class="keyword">string</span></span><br><span class="line">GetStringSlice(key <span class="keyword">string</span>) []<span class="keyword">string</span></span><br><span class="line">GetTime(key <span class="keyword">string</span>) time.Time</span><br><span class="line">GetUint(key <span class="keyword">string</span>) <span class="keyword">uint</span></span><br><span class="line">GetUint32(key <span class="keyword">string</span>) <span class="keyword">uint32</span></span><br><span class="line">GetUint64(key <span class="keyword">string</span>) <span class="keyword">uint64</span></span><br><span class="line">InConfig(key <span class="keyword">string</span>) <span class="keyword">bool</span></span><br><span class="line">IsSet(key <span class="keyword">string</span>) <span class="keyword">bool</span></span><br><span class="line">AllSettings() <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="访问嵌套的键"><a href="#访问嵌套的键" class="headerlink" title="访问嵌套的键"></a>访问嵌套的键</h3>
                                    <p>访问器方法也接受深度嵌套键的格式化路径。例如，如果加载下面的JSON文件：</p>
                                    <figure class="highlight json">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"host"</span>: &#123;</span><br><span class="line">    <span class="attr">"address"</span>: <span class="string">"localhost"</span>,</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">5799</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"datastore"</span>: &#123;</span><br><span class="line">    <span class="attr">"metric"</span>: &#123;</span><br><span class="line">      <span class="attr">"host"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">      <span class="attr">"port"</span>: <span class="number">3099</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"warehouse"</span>: &#123;</span><br><span class="line">      <span class="attr">"host"</span>: <span class="string">"198.21.112.32"</span>,</span><br><span class="line">      <span class="attr">"port"</span>: <span class="number">2112</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>Viper可以通过传入<code>.</code>分隔的路径来访问嵌套字段：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">GetString(<span class="string">"datastore.datastore.warehouse.host"</span>) </span><br><span class="line"><span class="comment">// 返回 "198.21.112.32"</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>这遵守上面建立的优先规则；搜索路径将遍历其余配置注册表，直到找到为止。(译注：因为Viper支持从多种配置来源，例如磁盘上的配置文件&gt;命令行标志位&gt;环境变量&gt;远程Key/Value存储&gt;<br>默认值，我们在查找一个配置的时候如果在当前配置源中没找到，就会继续从后续的配置源查找，直到找到为止。)</p>
                                    <p>例如，在给定此配置文件的情况下，<code>datastore.metric.host</code>和<code>datastore.metric.port</code>均已定义（并且可以被覆盖）。如果另外在默认值中定义了<code>datastore.metric.protocol</code><br>，Viper也会找到它。然而，如果<code>datastore.metric</code>被直接赋值覆盖（被flag，环境变量，<code>set()</code>方法等等…），那么<code>datastore.metric</code><br>的所有子键都将变为未定义状态，它们被高优先级配置级别“遮蔽”（shadowed）了。最后，如果存在与分隔的键路径匹配的键，则返回其值。例如：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"datastore.metric.host"</span>: <span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="string">"host"</span>: &#123;</span><br><span class="line">        <span class="string">"address"</span>: <span class="string">"localhost"</span>,</span><br><span class="line">        <span class="string">"port"</span>: <span class="number">5799</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"datastore"</span>: &#123;</span><br><span class="line">        <span class="string">"metric"</span>: &#123;</span><br><span class="line">            <span class="string">"host"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">            <span class="string">"port"</span>: <span class="number">3099</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"warehouse"</span>: &#123;</span><br><span class="line">            <span class="string">"host"</span>: <span class="string">"198.0.0.1"</span>,</span><br><span class="line">            <span class="string">"port"</span>: <span class="number">2112</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GetString(<span class="string">"datastore.metric.host"</span>) </span><br><span class="line"><span class="comment">// 返回 "0.0.0.0"</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="提取子树"><a href="#提取子树" class="headerlink" title="提取子树"></a>提取子树</h3>
                                    <p>从Viper中提取子树，<code>viper</code>实例现在代表了以下配置：</p>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">cache1:</span></span><br><span class="line">    <span class="attr">max-items:</span> <span class="number">100</span></span><br><span class="line">    <span class="attr">item-size:</span> <span class="number">64</span></span><br><span class="line">  <span class="attr">cache2:</span></span><br><span class="line">    <span class="attr">max-items:</span> <span class="number">200</span></span><br><span class="line">    <span class="attr">item-size:</span> <span class="number">80</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>执行后：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">subv := viper.Sub(<span class="string">"app.cache1"</span>)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><code>subv</code>现在就代表：</p>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="attr">max-items:</span> <span class="number">100</span></span><br><span class="line"><span class="attr">item-size:</span> <span class="number">64</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>假设我们现在有这么一个函数：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewCache</span><span class="params">(cfg *Viper)</span> *<span class="title">Cache</span></span> &#123;...&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>它基于<code>subv</code>格式的配置信息创建缓存。现在，可以轻松地分别创建这两个缓存，如下所示：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">cfg1 := viper.Sub(<span class="string">"app.cache1"</span>)</span><br><span class="line">cache1 := NewCache(cfg1)</span><br><span class="line"></span><br><span class="line">cfg2 := viper.Sub(<span class="string">"app.cache2"</span>)</span><br><span class="line">cache2 := NewCache(cfg2)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h3>
                                    <p>你还可以选择将所有或特定的值解析到结构体、map等。</p>
                                    <p>有两种方法可以做到这一点：</p>
                                    <ul>
                                        <li><code>Unmarshal(rawVal interface{}) : error</code></li>
                                        <li><code>UnmarshalKey(key string, rawVal interface{}) : error</code></li>
                                    </ul>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">type</span> config <span class="keyword">struct</span> &#123;</span><br><span class="line">	Port <span class="keyword">int</span></span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	PathMap <span class="keyword">string</span> <span class="string">`mapstructure:"path_map"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> C config</span><br><span class="line"></span><br><span class="line">err := viper.Unmarshal(&amp;C)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	t.Fatalf(<span class="string">"unable to decode into struct, %v"</span>, err)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>如果你想要解析那些键本身就包含<code>.</code>(默认的键分隔符）的配置，你需要修改分隔符：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">v := viper.NewWithOptions(viper.KeyDelimiter(<span class="string">"::"</span>))</span><br><span class="line"></span><br><span class="line">v.SetDefault(<span class="string">"chart::values"</span>, <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">    <span class="string">"ingress"</span>: <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">        <span class="string">"annotations"</span>: <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">            <span class="string">"traefik.frontend.rule.type"</span>:                 <span class="string">"PathPrefix"</span>,</span><br><span class="line">            <span class="string">"traefik.ingress.kubernetes.io/ssl-redirect"</span>: <span class="string">"true"</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> config <span class="keyword">struct</span> &#123;</span><br><span class="line">	Chart <span class="keyword">struct</span>&#123;</span><br><span class="line">        Values <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> C config</span><br><span class="line"></span><br><span class="line">v.Unmarshal(&amp;C)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>Viper还支持解析到嵌入的结构体：</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Example config:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">module:</span></span><br><span class="line"><span class="comment">    enabled: true</span></span><br><span class="line"><span class="comment">    token: 89h3f98hbwf987h3f98wenf89ehf</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">type</span> config <span class="keyword">struct</span> &#123;</span><br><span class="line">	Module <span class="keyword">struct</span> &#123;</span><br><span class="line">		Enabled <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">		moduleConfig <span class="string">`mapstructure:",squash"`</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// moduleConfig could be in a module specific package</span></span><br><span class="line"><span class="keyword">type</span> moduleConfig <span class="keyword">struct</span> &#123;</span><br><span class="line">	Token <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> C config</span><br><span class="line"></span><br><span class="line">err := viper.Unmarshal(&amp;C)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	t.Fatalf(<span class="string">"unable to decode into struct, %v"</span>, err)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>Viper在后台使用<a href="https://github.com/mitchellh/mapstructure" target="_blank" rel="noopener">github.com/mitchellh/mapstructure</a>来解析值，其默认情况下使用<code>mapstructure</code>tag。</p>
                                    <blockquote>
                                        <p><strong>注意</strong> 当我们需要将viper读取的配置反序列到我们定义的结构体变量中时，一定要使用<code>mapstructure</code>tag！</p>
                                    </blockquote>
                                    <h3 id="序列化成字符串"><a href="#序列化成字符串" class="headerlink" title="序列化成字符串"></a>序列化成字符串</h3>
                                    <p>你可能需要将viper中保存的所有设置序列化到一个字符串中，而不是将它们写入到一个文件中。你可以将自己喜欢的格式的序列化器与<code>AllSettings()</code>返回的配置一起使用。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    yaml <span class="string">"gopkg.in/yaml.v2"</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">yamlStringSettings</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    c := viper.AllSettings()</span><br><span class="line">    bs, err := yaml.Marshal(c)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatalf(<span class="string">"unable to marshal config to YAML: %v"</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">string</span>(bs)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="远程Key-Value存储支持"><a href="#远程Key-Value存储支持" class="headerlink" title="远程Key/Value存储支持"></a>远程Key/Value存储支持</h2>
                                    <p>在Viper中启用远程支持，需要在代码中匿名导入<code>viper/remote</code>这个包。</p>
                                    <figure class="highlight haxe">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">import</span> <span class="literal">_</span> <span class="string">"github.com/spf13/viper/remote"</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>Viper将读取从Key/Value存储（例如etcd或Consul）中的路径检索到的配置字符串（如<code>JSON</code>、<code>TOML</code>、<code>YAML</code>、<code>HCL</code>、<code>envfile</code>和<code>Java properties</code><br>格式）。这些值的优先级高于默认值，但是会被从磁盘、flag或环境变量检索到的配置值覆盖。（译注：也就是说Viper加载配置值的优先级为：磁盘上的配置文件&gt;命令行标志位&gt;环境变量&gt;远程Key/Value存储&gt;默认值。）</p>
                                    <p>Viper使用<a href="https://github.com/bketelsen/crypt" target="_blank" rel="noopener">crypt</a>从K/V存储中检索配置，这意味着如果你有正确的gpg密匙，你可以将配置值加密存储并自动解密。加密是可选的。</p>
                                    <p>你可以将远程配置与本地配置结合使用，也可以独立使用。</p>
                                    <p><code>crypt</code>有一个命令行助手，你可以使用它将配置放入K/V存储中。<code>crypt</code>默认使用在<a href="http://127.0.0.1:4001/" target="_blank" rel="noopener">http://127.0.0.1:4001</a>的etcd。</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">$ go get github.com/bketelsen/crypt/bin/crypt</span><br><span class="line">$ crypt <span class="built_in">set</span> -plaintext /config/hugo.json /Users/hugo/settings/config.json</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>确认值已经设置：</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">$ crypt get -plaintext /config/hugo.json</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>有关如何设置加密值或如何使用Consul的示例，请参见<code>crypt</code>文档。</p>
                                    <h3 id="远程Key-Value存储示例-未加密"><a href="#远程Key-Value存储示例-未加密" class="headerlink" title="远程Key/Value存储示例-未加密"></a>远程Key/Value存储示例-未加密</h3>
                                    <h4 id="etcd"><a href="#etcd" class="headerlink" title="etcd"></a>etcd</h4>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.AddRemoteProvider(<span class="string">"etcd"</span>, <span class="string">"http://127.0.0.1:4001"</span>,<span class="string">"/config/hugo.json"</span>)</span><br><span class="line">viper.SetConfigType(<span class="string">"json"</span>) <span class="comment">// 因为在字节流中没有文件扩展名，所以这里需要设置下类型。支持的扩展名有 "json", "toml", "yaml", "yml", "properties", "props", "prop", "env", "dotenv"</span></span><br><span class="line">err := viper.ReadRemoteConfig()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h4 id="Consul"><a href="#Consul" class="headerlink" title="Consul"></a>Consul</h4>
                                    <p>你需要 Consul Key/Value存储中设置一个Key保存包含所需配置的JSON值。例如，创建一个key<code>MY_CONSUL_KEY</code>将下面的值存入Consul key/value 存储：</p>
                                    <figure class="highlight">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.AddRemoteProvider("consul", "localhost:8500", "MY_CONSUL_KEY")</span><br><span class="line">viper.SetConfigType("json") // 需要显示设置成json</span><br><span class="line">err: = viper.ReadRemoteConfig()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h4 id="Firestore"><a href="#Firestore" class="headerlink" title="Firestore"></a>Firestore</h4>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.AddRemoteProvider(<span class="string">"firestore"</span>, <span class="string">"google-cloud-project-id"</span>, <span class="string">"collection/document"</span>)</span><br><span class="line">viper.SetConfigType(<span class="string">"json"</span>) <span class="comment">// 配置的格式: "json", "toml", "yaml", "yml"</span></span><br><span class="line">err := viper.ReadRemoteConfig()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>当然，你也可以使用<code>SecureRemoteProvider</code>。</p>
                                    <h3 id="远程Key-Value存储示例-加密"><a href="#远程Key-Value存储示例-加密" class="headerlink" title="远程Key/Value存储示例-加密"></a>远程Key/Value存储示例-加密</h3>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">viper.AddSecureRemoteProvider(<span class="string">"etcd"</span>,<span class="string">"http://127.0.0.1:4001"</span>,<span class="string">"/config/hugo.json"</span>,<span class="string">"/etc/secrets/mykeyring.gpg"</span>)</span><br><span class="line">viper.SetConfigType(<span class="string">"json"</span>) <span class="comment">// 因为在字节流中没有文件扩展名，所以这里需要设置下类型。支持的扩展名有 "json", "toml", "yaml", "yml", "properties", "props", "prop", "env", "dotenv"</span></span><br><span class="line">err := viper.ReadRemoteConfig()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="监控etcd中的更改-未加密"><a href="#监控etcd中的更改-未加密" class="headerlink" title="监控etcd中的更改-未加密"></a>监控etcd中的更改-未加密</h3>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// 或者你可以创建一个新的viper实例</span></span><br><span class="line"><span class="keyword">var</span> runtime_viper = viper.New()</span><br><span class="line"></span><br><span class="line">runtime_viper.AddRemoteProvider(<span class="string">"etcd"</span>, <span class="string">"http://127.0.0.1:4001"</span>, <span class="string">"/config/hugo.yml"</span>)</span><br><span class="line">runtime_viper.SetConfigType(<span class="string">"yaml"</span>) <span class="comment">// 因为在字节流中没有文件扩展名，所以这里需要设置下类型。支持的扩展名有 "json", "toml", "yaml", "yml", "properties", "props", "prop", "env", "dotenv"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一次从远程读取配置</span></span><br><span class="line">err := runtime_viper.ReadRemoteConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反序列化</span></span><br><span class="line">runtime_viper.Unmarshal(&amp;runtime_conf)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启一个单独的goroutine一直监控远端的变更</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">	    time.Sleep(time.Second * <span class="number">5</span>) <span class="comment">// 每次请求后延迟一下</span></span><br><span class="line"></span><br><span class="line">	    <span class="comment">// 目前只测试了etcd支持</span></span><br><span class="line">	    err := runtime_viper.WatchRemoteConfig()</span><br><span class="line">	    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	        log.Errorf(<span class="string">"unable to read remote config: %v"</span>, err)</span><br><span class="line">	        <span class="keyword">continue</span></span><br><span class="line">	    &#125;</span><br><span class="line"></span><br><span class="line">	    <span class="comment">// 将新配置反序列化到我们运行时的配置结构体中。你还可以借助channel实现一个通知系统更改的信号</span></span><br><span class="line">	    runtime_viper.Unmarshal(&amp;runtime_conf)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="基于Viper实现的环境变量动态链接"><a href="#基于Viper实现的环境变量动态链接" class="headerlink" title="基于Viper实现的环境变量动态链接"></a>基于Viper实现的环境变量动态链接</h2>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"github.com/spf13/viper"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// DynamicEnv is a dynamic adapter that interoperates with environment variables</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DynamicEnv</span><span class="params">(envName, Prefix <span class="keyword">string</span>, defaultVal <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">   viper.SetDefault(envName, defaultVal)</span><br><span class="line">   viper.SetEnvPrefix(Prefix)</span><br><span class="line">   viper.BindEnv(envName)</span><br><span class="line">   <span class="keyword">return</span> viper.Get(envName)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-10-18 17:09:16" itemprop="dateCreated datePublished" datetime="2021-10-18T17:09:16+08:00">2021-10-18</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>3.6k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>3 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1475843192.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Go <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1475843192.html" class="post-title-link" itemprop="url">go日志库之logrus</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>无路是在开发、测试、亦或者调试有一好的日志，都会事半功倍。本节我来学习一下 go 语言明星日志库 logrus。相关链接如下所示<br><a href="https://github.com/sirupsen/logrus" target="_blank" rel="noopener" title="github">github</a>: <a href="https://github.com/sirupsen/logrus" target="_blank" rel="noopener">https://github.com/sirupsen/logrus</a><br><a href="https://pkg.go.dev/logur.dev/adapter/logrus" target="_blank" rel="noopener" title="pkg">pkg</a>： <a href="https://pkg.go.dev/logur.dev/adapter/logrus" target="_blank" rel="noopener">https://pkg.go.dev/logur.dev/adapter/logrus</a></p>
                                    <h2 id="Logrus-简介"><a href="#Logrus-简介" class="headerlink" title="Logrus 简介"></a>Logrus 简介</h2>
                                    <p>Logrus 是 Go 语言结构化的 logger，与标准库 logger 完全 API 兼容。</p>
                                    <p>它有以下特点：</p>
                                    <ul>
                                        <li>完全兼容标准日志库，拥有七种日志级别：<code>Trace</code>, <code>Debug</code>, <code>Info</code>, <code>Warning</code>, <code>Error</code>, <code>Fatal</code>and <code>Panic</code>。</li>
                                        <li>可选的日志输出格式，内置了两种日志格式 JSONFormater 和 TextFormatter，还可以自定义日志格式</li>
                                        <li>Field 机制，通过 Filed 机制进行结构化的日志记录</li>
                                        <li>可扩展的 Hook 机制，允许使用者通过 Hook 的方式将日志分发到任意地方，如本地文件系统，logstash，elasticsearch 或者 mq 等，或者通过 Hook 定义日志内容和格式等</li>
                                        <li>线程安全</li>
                                    </ul>
                                    <h2 id="logrus-的安装"><a href="#logrus-的安装" class="headerlink" title="logrus 的安装"></a>logrus 的安装</h2>
                                    <p>logrus 安装也非常的简单，直接使用<code>go get</code>即可，安装命令如下所示</p>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">go get -v -u logur.dev/adapter/logrus</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>其中</p>
                                        <p><code>-v</code> 为显示包安装信息</p>
                                        <p><code>-u</code> 为安装最新版</p>
                                    </blockquote>
                                    <h2 id="logrus-的使用"><a href="#logrus-的使用" class="headerlink" title="logrus 的使用"></a>logrus 的使用</h2>
                                    <p>介绍的包的使用，或许可以从几个维度，初始化、基本使用、骚操作及拓展。源于包使用，但不限于包使用</p>
                                    <h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3>
                                    <p>logrus 相关于初始化的方面，一共有三种方式。基于<code>New()</code>、<code>Logger</code>、<code>不操作</code></p>
                                    <h4 id="直接使用"><a href="#直接使用" class="headerlink" title="直接使用"></a>直接使用</h4>
                                    <p>直接使用相对来说更便捷，更清亮。也是相对来说性能最高的，但不足也显而易言，那就是不能有更自由的操作了，如设置 log Level、Hook、Format 等等。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">logrus.Trace(<span class="string">"trace msg"</span>)</span><br><span class="line">logrus.Tracef(<span class="string">"trace %v"</span>, <span class="string">"msg"</span>)</span><br><span class="line"></span><br><span class="line">logrus.Debug(<span class="string">"debug msg"</span>)</span><br><span class="line">logrus.Debugf(<span class="string">"debug %v"</span>, <span class="string">"msg"</span>)</span><br><span class="line"></span><br><span class="line">logrus.Info(<span class="string">"info msg"</span>)</span><br><span class="line">logrus.Infof(<span class="string">"info %v"</span>, <span class="string">"msg"</span>)</span><br><span class="line"></span><br><span class="line">logrus.Warn(<span class="string">"warn msg"</span>)</span><br><span class="line">logrus.Warnf(<span class="string">"warn %v"</span>, <span class="string">"msg"</span>)</span><br><span class="line"></span><br><span class="line">logrus.Error(<span class="string">"error msg"</span>)</span><br><span class="line">logrus.Errorf(<span class="string">"error %v"</span>, <span class="string">"msg"</span>)</span><br><span class="line"></span><br><span class="line">logrus.Fatal(<span class="string">"fatal msg"</span>)</span><br><span class="line">logrus.Fatalf(<span class="string">"fatal  %v"</span>, <span class="string">"msg"</span>)</span><br><span class="line"></span><br><span class="line">logrus.Panic(<span class="string">"panic msg"</span>)</span><br><span class="line">logrus.Panicf(<span class="string">"panic  %v"</span>, <span class="string">"msg"</span>)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>当然根据默认的规则会忽略掉一些输出信息</p>
                                    </blockquote>
                                    <h4 id="使用-New-初始化于定制"><a href="#使用-New-初始化于定制" class="headerlink" title="使用 New 初始化于定制"></a>使用 New 初始化于定制</h4>
                                    <p>相对直接使用，使用 New 初始化，拥有更多的操作空间。</p>
                                    <p>首先声明一个全局变量<code>log</code>，代码如下所示</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">var</span> log = logrus.New()</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>常规情况下对于日志的定制主要在以下几个方面</p>
                                    <ul>
                                        <li>日志可见等级</li>
                                        <li>日志格式配置</li>
                                        <li>执行调用信息</li>
                                        <li>日志另存为</li>
                                    </ul>
                                    <p><strong>日志可见等级</strong></p>
                                    <blockquote>
                                        <p>相关源码如下</p>
                                    </blockquote>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	<span class="comment">// PanicLevel level, highest level of severity. Logs and then calls panic with the</span></span><br><span class="line">	<span class="comment">// message passed to Debug, Info, ...</span></span><br><span class="line">	PanicLevel Level = <span class="literal">iota</span></span><br><span class="line">	<span class="comment">// FatalLevel level. Logs and then calls `logger.Exit(1)`. It will exit even if the</span></span><br><span class="line">	<span class="comment">// logging level is set to Panic.</span></span><br><span class="line">	FatalLevel</span><br><span class="line">	<span class="comment">// ErrorLevel level. Logs. Used for errors that should definitely be noted.</span></span><br><span class="line">	<span class="comment">// Commonly used for hooks to send errors to an error tracking service.</span></span><br><span class="line">	ErrorLevel</span><br><span class="line">	<span class="comment">// WarnLevel level. Non-critical entries that deserve eyes.</span></span><br><span class="line">	WarnLevel</span><br><span class="line">	<span class="comment">// InfoLevel level. General operational entries about what's going on inside the</span></span><br><span class="line">	<span class="comment">// application.</span></span><br><span class="line">	InfoLevel</span><br><span class="line">	<span class="comment">// DebugLevel level. Usually only enabled when debugging. Very verbose logging.</span></span><br><span class="line">	DebugLevel</span><br><span class="line">	<span class="comment">// TraceLevel level. Designates finer-grained informational events than the Debug.</span></span><br><span class="line">	TraceLevel</span><br><span class="line">)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>简而言之，登记越高（数字越大），显示的等级越全。如 6 显示所有的日志，0 只显示<code>Panic</code></p>
                                    <p>设置可见等级之需要在<code>log.SetLevel()</code><em>（log 为<code>var log = logrus.New()</code>而来）</em>设置整形(6-0)即可。</p>
                                    <p><strong>日志格式化配置</strong></p>
                                    <p>日志格式化主要分为文本格式化、JSON 格式化、自定义格式化或第三方插件格式化</p>
                                    <p>如下</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// log.SetFormatter(&amp;logrus.TextFormatter&#123;</span></span><br><span class="line"><span class="comment">//		DisableColors: false,</span></span><br><span class="line"><span class="comment">//		FullTimestamp: true,</span></span><br><span class="line"><span class="comment">//	&#125;)</span></span><br><span class="line"><span class="keyword">type</span> TextFormatter <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// Set to true to bypass checking for a TTY before outputting colors.</span></span><br><span class="line">	ForceColors <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Force disabling colors.</span></span><br><span class="line">	DisableColors <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Force quoting of all values</span></span><br><span class="line">	ForceQuote <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// DisableQuote disables quoting for all values.</span></span><br><span class="line">	<span class="comment">// DisableQuote will have a lower priority than ForceQuote.</span></span><br><span class="line">	<span class="comment">// If both of them are set to true, quote will be forced on all values.</span></span><br><span class="line">	DisableQuote <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Override coloring based on CLICOLOR and CLICOLOR_FORCE. - https://bixense.com/clicolors/</span></span><br><span class="line">	EnvironmentOverrideColors <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Disable timestamp logging. useful when output is redirected to logging</span></span><br><span class="line">	<span class="comment">// system that already adds timestamps.</span></span><br><span class="line">	DisableTimestamp <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Enable logging the full timestamp when a TTY is attached instead of just</span></span><br><span class="line">	<span class="comment">// the time passed since beginning of execution.</span></span><br><span class="line">	FullTimestamp <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// TimestampFormat to use for display when a full timestamp is printed.</span></span><br><span class="line">	<span class="comment">// The format to use is the same than for time.Format or time.Parse from the standard</span></span><br><span class="line">	<span class="comment">// library.</span></span><br><span class="line">	<span class="comment">// The standard Library already provides a set of predefined format.</span></span><br><span class="line">	TimestampFormat <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// The fields are sorted by default for a consistent output. For applications</span></span><br><span class="line">	<span class="comment">// that log extremely frequently and don't use the JSON formatter this may not</span></span><br><span class="line">	<span class="comment">// be desired.</span></span><br><span class="line">	DisableSorting <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// The keys sorting function, when uninitialized it uses sort.Strings.</span></span><br><span class="line">	SortingFunc <span class="function"><span class="keyword">func</span><span class="params">([]<span class="keyword">string</span>)</span></span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Disables the truncation of the level text to 4 characters.</span></span><br><span class="line">	DisableLevelTruncation <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// PadLevelText Adds padding the level text so that all the levels output at the same length</span></span><br><span class="line">	<span class="comment">// PadLevelText is a superset of the DisableLevelTruncation option</span></span><br><span class="line">	PadLevelText <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// QuoteEmptyFields will wrap empty fields in quotes if true</span></span><br><span class="line">	QuoteEmptyFields <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Whether the logger's out is to a terminal</span></span><br><span class="line">	isTerminal <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// FieldMap allows users to customize the names of keys for default fields.</span></span><br><span class="line">	<span class="comment">// As an example:</span></span><br><span class="line">	<span class="comment">// formatter := &amp;TextFormatter&#123;</span></span><br><span class="line">	<span class="comment">//     FieldMap: FieldMap&#123;</span></span><br><span class="line">	<span class="comment">//         FieldKeyTime:  "@timestamp",</span></span><br><span class="line">	<span class="comment">//         FieldKeyLevel: "@level",</span></span><br><span class="line">	<span class="comment">//         FieldKeyMsg:   "@message"&#125;&#125;</span></span><br><span class="line">	FieldMap FieldMap</span><br><span class="line"></span><br><span class="line">	<span class="comment">// CallerPrettyfier can be set by the user to modify the content</span></span><br><span class="line">	<span class="comment">// of the function and file keys in the data when ReportCaller is</span></span><br><span class="line">	<span class="comment">// activated. If any of the returned value is the empty string the</span></span><br><span class="line">	<span class="comment">// corresponding key will be removed from fields.</span></span><br><span class="line">	CallerPrettyfier <span class="function"><span class="keyword">func</span><span class="params">(*runtime.Frame)</span> <span class="params">(function <span class="keyword">string</span>, file <span class="keyword">string</span>)</span></span></span><br><span class="line"></span><br><span class="line">	terminalInitOnce sync.Once</span><br><span class="line"></span><br><span class="line">	<span class="comment">// The max length of the level text, generated dynamically on init</span></span><br><span class="line">	levelTextMaxLength <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>格式 JSON 化</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// log.SetFormatter(&amp;logrus.JSONFormatter&#123;&#125;)</span></span><br><span class="line"><span class="keyword">type</span> JSONFormatter <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// TimestampFormat sets the format used for marshaling timestamps.</span></span><br><span class="line">	<span class="comment">// The format to use is the same than for time.Format or time.Parse from the standard</span></span><br><span class="line">	<span class="comment">// library.</span></span><br><span class="line">	<span class="comment">// The standard Library already provides a set of predefined format.</span></span><br><span class="line">	TimestampFormat <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// DisableTimestamp allows disabling automatic timestamps in output</span></span><br><span class="line">	DisableTimestamp <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// DisableHTMLEscape allows disabling html escaping in output</span></span><br><span class="line">	DisableHTMLEscape <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// DataKey allows users to put all the log entry parameters into a nested dictionary at a given key.</span></span><br><span class="line">	DataKey <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// FieldMap allows users to customize the names of keys for default fields.</span></span><br><span class="line">	<span class="comment">// As an example:</span></span><br><span class="line">	<span class="comment">// formatter := &amp;JSONFormatter&#123;</span></span><br><span class="line">	<span class="comment">//   	FieldMap: FieldMap&#123;</span></span><br><span class="line">	<span class="comment">// 		 FieldKeyTime:  "@timestamp",</span></span><br><span class="line">	<span class="comment">// 		 FieldKeyLevel: "@level",</span></span><br><span class="line">	<span class="comment">// 		 FieldKeyMsg:   "@message",</span></span><br><span class="line">	<span class="comment">// 		 FieldKeyFunc:  "@caller",</span></span><br><span class="line">	<span class="comment">//    &#125;,</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line">	FieldMap FieldMap</span><br><span class="line"></span><br><span class="line">	<span class="comment">// CallerPrettyfier can be set by the user to modify the content</span></span><br><span class="line">	<span class="comment">// of the function and file keys in the json data when ReportCaller is</span></span><br><span class="line">	<span class="comment">// activated. If any of the returned value is the empty string the</span></span><br><span class="line">	<span class="comment">// corresponding key will be removed from json fields.</span></span><br><span class="line">	CallerPrettyfier <span class="function"><span class="keyword">func</span><span class="params">(*runtime.Frame)</span> <span class="params">(function <span class="keyword">string</span>, file <span class="keyword">string</span>)</span></span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// PrettyPrint will indent all json logs</span></span><br><span class="line">	PrettyPrint <span class="keyword">bool</span></span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><a href="https://github.com/sirupsen/logrus#formatters" target="_blank" rel="noopener">https://github.com/sirupsen/logrus#formatters</a></p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1guu60plma8j60l00740to02.jpg" alt="image-20210926173746478"></p>
                                    <p><strong>写入文件夹 SetOutput</strong></p>
                                    <p>O_RDONLY：只读模式(read-only)</p>
                                    <p>O_WRONLY：只写模式(write-only)</p>
                                    <p>O_RDWR：读写模式(read-write)</p>
                                    <p>O_APPEND：追加模式(append)</p>
                                    <p>O_CREATE：文件不存在就创建(create a new file if none exists.)</p>
                                    <p>O_EXCL：与 O_CREATE 一起用，构成一个新建文件的功能，它要求文件必须不存在(used with O_CREATE, file must not exist)</p>
                                    <p>O_SYNC：同步方式打开，即不使用缓存，直接写入硬盘 O_TRUNC：打开并清空文件</p>
                                    <p>示例代码如下</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	logDirPath := <span class="string">`log/`</span> + time.Now().Format(<span class="string">"2006-01-02"</span>)</span><br><span class="line">	logFilePath := filepath.Join(logDirPath, time.Now().Format(<span class="string">`15`</span>))</span><br><span class="line">	os.MkdirAll(logFilePath, <span class="number">0775</span>)</span><br><span class="line">	file, err := os.OpenFile(logFilePath + <span class="string">`/`</span> + time.Now().Format(<span class="string">`04`</span>) + <span class="string">`.log`</span>, os.O_RDWR|os.O_CREATE|os.O_APPEND, <span class="number">0644</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Error(<span class="string">`open file error`</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	log.SetOutput(file)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><code>log.SetReportCaller()</code>: 显示调用关系，开启这个模式会增加性能开销(成本在 20% 到 40% 之间)。</p>
                                    <p><strong>Hook</strong></p>
                                    <p>logrus 通过实现 <code>Hook</code>接口扩展 hook 机制,可以根据需求将日志分发到任意的存储介质, 比如 es, mq 或者监控报警系统,及时获取异常日志。可以说极大的提高了日志系统的可扩展性。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">type</span> Hook <span class="keyword">interface</span> &#123;</span><br><span class="line">  <span class="comment">// 定义哪些等级的日志触发 hook 机制</span></span><br><span class="line">	Levels() []Level</span><br><span class="line">  <span class="comment">// hook 触发器的具体执行操作</span></span><br><span class="line">  <span class="comment">// 如果 Fire 执行失败,错误日志会重定向到标准错误流</span></span><br><span class="line">	Fire(*Entry) error</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>具体 Hook 示列可参考 <a href="https://github.com/sirupsen/logrus/blob/master/hooks/syslog/README.md" target="_blank" rel="noopener">https://github.com/sirupsen/logrus/blob/master/hooks/syslog/README.md</a></p>
                                    <h2 id="referer"><a href="#referer" class="headerlink" title="referer"></a>referer</h2>
                                    <p><a href="https://blog.csdn.net/wangzhezhilu001/article/details/95363789" target="_blank" rel="noopener">https://blog.csdn.net/wangzhezhilu001/article/details/95363789</a></p>
                                    <p><a href="https://blog.csdn.net/sserf/article/details/103388133" target="_blank" rel="noopener">https://blog.csdn.net/sserf/article/details/103388133</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-09-25 06:59:56" itemprop="dateCreated datePublished" datetime="2021-09-25T06:59:56+08:00">2021-09-25</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.7k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>2 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2341116369.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 爬虫 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2341116369.html" class="post-title-link" itemprop="url">js调试小笔记</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="操作键"><a href="#操作键" class="headerlink" title="操作键"></a>操作键</h2>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1guna6e3v4wj60bm01imwy02.jpg" alt="image-20210920184244435"></p>
                                    <p><strong>resume/pause script execution</strong>: 恢复/暂停脚本执行</p>
                                    <p><strong>step over next function call</strong>: 跨过，实际表现是不遇到函数时，执行下一步。遇到函数时，不进入函数直接执行下一步。</p>
                                    <p><strong>step into next function call</strong>: 跨入，实际表现是不遇到函数时，执行下一步。遇到到函数时，进入函数执行上下文。</p>
                                    <p><strong>step out of current function</strong>:跳出当前函数</p>
                                    <p><strong>deactivate breakpoints</strong>:停用断点</p>
                                    <p><strong>don‘t pause on exceptions</strong>:不暂停异常捕获</p>
                                    <h2 id="Watch"><a href="#Watch" class="headerlink" title="Watch"></a>Watch</h2>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1guna86ju6bj6042016gld02.jpg" alt="image-20210920184426027"></p>
                                    <p>变量监听</p>
                                    <p>定位到关键值时加入Watch中实现实时监听，可根据监听内容变化预估此变化。</p>
                                    <h2 id="BreakPoints"><a href="#BreakPoints" class="headerlink" title="BreakPoints"></a>BreakPoints</h2>
                                    <p>所有断点列表，且自动按照执行顺序排序</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1guna98mrchj60jm082mxp02.jpg" alt="image-20210920184528622"></p>
                                    <h2 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h2>
                                    <p>该范围内所有变量的值</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gunafyd9hhj60kc0mc40502.jpg" alt="image-20210920185155365"></p>
                                    <h2 id="调用栈"><a href="#调用栈" class="headerlink" title="调用栈"></a>调用栈</h2>
                                    <p><strong>一个 procedure（通常译作“过程”）吃进来一些参数，干一些事情，再吐出去一个返回值（或者什么也不吐）</strong></p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gunaocua19j60co02m3ye02.jpg" alt="image-20210920185959949"></p>
                                    <h2 id="XHR-fetch-Breakpints"><a href="#XHR-fetch-Breakpints" class="headerlink" title="XHR/fetch Breakpints"></a>XHR/fetch Breakpints</h2>
                                    <p>XHR/fetch Breakpints：请求断点（拦截），当发生符合要求的将触发定位到请求发送前一步</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gunaonikx8j60kw03kaa902.jpg" alt="image-20210920190017589"></p>
                                    <h2 id="DOM-Break-points"><a href="#DOM-Break-points" class="headerlink" title="DOM Break points"></a>DOM Break points</h2>
                                    <p>当符合条件时触发定位到BOM</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gunau1dh9bj60ay038q2y02.jpg" alt="image-20210920190528135"></p>
                                    <h2 id="Global-Listeners"><a href="#Global-Listeners" class="headerlink" title="Global Listeners"></a>Global Listeners</h2>
                                    <p>全局时间监听，包含所有时间，如点击、滑动等</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gunavas820j60g80ect9a02.jpg" alt="image-20210920190640937"></p>
                                    <h2 id="Event-Listener-Break-points"><a href="#Event-Listener-Break-points" class="headerlink" title="Event Listener Break points"></a>Event Listener Break points</h2>
                                    <p>事件侦听器断点，监听所有事件与断点实现。</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gunawqe43pj60gw0nyjsk02.jpg" alt="image-20210920190803044"></p>
                                    <h3 id="预览几种不同的breakpoint类型"><a href="#预览几种不同的breakpoint类型" class="headerlink" title="预览几种不同的breakpoint类型"></a>预览几种不同的breakpoint类型</h3>
                                    <p>众人皆知的breakpoint类型是line-of-code。但是line-of-code型breakpoint有的时候没法设置（<strong>其实就是没法在代码左边点出一个绿点来</strong><br>），或者如果你正在使用一个大型的代码库。通过学习如何和何时使用这些不同类型的breakpoint debug，会大大节约你的时间。</p>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>断点类型</th>
                                                    <th>当你想Pause的时候使用</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Line-of-code</td>
                                                    <td>代码具体某一行（<strong>其实就是没法在代码左边点出一个绿点来</strong>）</td>
                                                </tr>
                                                <tr>
                                                    <td>Conditional line-of-code</td>
                                                    <td>代码具体某一行，但是只有在一些条件为true时</td>
                                                </tr>
                                                <tr>
                                                    <td>DOM</td>
                                                    <td>在改变或者移除一个DOM节点或者它的DOM子节点时</td>
                                                </tr>
                                                <tr>
                                                    <td>XHR</td>
                                                    <td>当一个XHR URL包含一个string pattern</td>
                                                </tr>
                                                <tr>
                                                    <td>Event Listener</td>
                                                    <td>在运行了某个特定事件后的代码上，例如click事件触发</td>
                                                </tr>
                                                <tr>
                                                    <td>Exception</td>
                                                    <td>在抛出了一个caught或者uncaught的exception时</td>
                                                </tr>
                                                <tr>
                                                    <td>Function</td>
                                                    <td>当一个函数被调用时</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <h2 id="this指向"><a href="#this指向" class="headerlink" title="this指向"></a>this指向</h2>
                                    <p>全局作用域 this = window</p>
                                    <p>局部作用域 this = 调用者</p>
                                    <p>类的方法里面 this = 类自己</p>
                                    <h2 id="referer"><a href="#referer" class="headerlink" title="referer"></a>referer</h2>
                                    <p><a href="https://blog.csdn.net/xc_zhou/article/details/106269239" target="_blank" rel="noopener">https://blog.csdn.net/xc_zhou/article/details/106269239</a></p>
                                    <p><a href="https://blog.csdn.net/qq_27324983/article/details/102467199" target="_blank" rel="noopener">https://blog.csdn.net/qq_27324983/article/details/102467199</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-09-20 18:40:06" itemprop="dateCreated datePublished" datetime="2021-09-20T18:40:06+08:00">2021-09-20</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.2k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1336292242.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 数据库 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1336292242.html" class="post-title-link" itemprop="url">MySQL存储引擎</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <blockquote>
                                        <p>Server version: 8.0.20 Source distribution</p>
                                    </blockquote>
                                    <p><code>SHOW ENGINES</code></p>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th style="text-align:left">Engine</th>
                                                    <th style="text-align:left">Support</th>
                                                    <th style="text-align:left">Comment</th>
                                                    <th style="text-align:left">Transactions</th>
                                                    <th style="text-align:left">XA</th>
                                                    <th style="text-align:left">Savepoints</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td style="text-align:left">FEDERATED</td>
                                                    <td style="text-align:left">NO</td>
                                                    <td style="text-align:left">Federated MySQL storage engine</td>
                                                    <td style="text-align:left"><em>NULL</em></td>
                                                    <td style="text-align:left"><em>NULL</em></td>
                                                    <td style="text-align:left">*</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <p>NULL* | |<br>| MEMORY | YES | Hash based, stored in memory, useful for temporary… | NO | NO | NO | |<br>| InnoDB | DEFAULT | Supports transactions, row-level locking, and fore… | YES | YES | YES | |<br>| PERFORMANCE_SCHEMA | YES | Performance Schema | NO | NO | NO | |<br>| MyISAM | YES | MyISAM storage engine | NO | NO | NO | |<br>| MRG_MYISAM | YES | Collection of identical MyISAM tables | NO | NO | NO | |<br>| BLACKHOLE | YES | /dev/null storage engine (anything you write to it… | NO | NO | NO | |<br>| CSV | YES | CSV storage engine | NO | NO | NO | |<br>| ARCHIVE | YES | Archive storage engine | NO | NO | NO | |</p>
                                    <p>MySQL中常用的存储引擎有InnoDB、MyISAM、MEMORY、ARCHIVE和CSV</p>
                                    <h2 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h2>
                                    <h3 id="InnoDB存储引擎"><a href="#InnoDB存储引擎" class="headerlink" title="InnoDB存储引擎"></a>InnoDB存储引擎</h3>
                                    <p>支持事务 锁级别为行锁，比MyISAM存储引擎支持更高的并发 能够通过二进制日志恢复数据 支持外键操作<br>在索引存储上，索引和数据存储在同一个文件中，默认按照B+Tree组织索引的结构。同时，主键索引的叶子节点存储完整的数据记录，非主键索引的叶子节点存储主键的值。</p>
                                    <p><strong>在MySQL 5.6版本之后，默认使用InnoDB存储引擎。</strong></p>
                                    <p><strong>在MySQL 5.6版本之后，InnoDB存储引擎支持全文索引。</strong></p>
                                    <h3 id="MyISAM存储引擎"><a href="#MyISAM存储引擎" class="headerlink" title="MyISAM存储引擎"></a>MyISAM存储引擎</h3>
                                    <p>不支持事务。</p>
                                    <p>锁级别为表锁，在要求高并发的场景下不太适用。</p>
                                    <p>如果数据文件损坏，难以恢复数据。</p>
                                    <p>不支持外键。</p>
                                    <p>在索引存储上，索引文件与数据文件分离。</p>
                                    <p>支持全文索引。</p>
                                    <h3 id="MEMORY存储引擎"><a href="#MEMORY存储引擎" class="headerlink" title="MEMORY存储引擎"></a>MEMORY存储引擎</h3>
                                    <p>不支持TEXT和BLOB数据类型，只支持固定长度的字符串类型。例如，在MEMORY存储引擎中，会将VARCHAR类型自动转化成CHAR类型。</p>
                                    <p>锁级别为表锁，在高并发场景下会成为瓶颈。</p>
                                    <p>通常会被作为临时表使用，存储查询数据时产生中间结果。</p>
                                    <p>数据存储在内存中，重启服务器后数据会丢失。如果是需要持久化的数据，不适合存储在MEMORY存储引擎的数据表中。</p>
                                    <h3 id="ARCHIVE存储引擎"><a href="#ARCHIVE存储引擎" class="headerlink" title="ARCHIVE存储引擎"></a>ARCHIVE存储引擎</h3>
                                    <p>支持数据压缩，在存储数据前会对数据进行压缩处理，适合存储归档的数据。</p>
                                    <p>只支持数据的插入和查询，插入数据后，不能对数据进行更改和删除，而只能查询。</p>
                                    <p>只支持在整数自增类型的字段上添加索引。</p>
                                    <h3 id="CSV存储引擎"><a href="#CSV存储引擎" class="headerlink" title="CSV存储引擎"></a>CSV存储引擎</h3>
                                    <p>主要存储的是csv格式的文本数据，可以直接打开存储的文件进行编辑。</p>
                                    <p>可以将MySQL中某个数据表中的数据直接导出为csv文件，也可以将.csv文件导入数据表中。</p>
                                    <p><a href="https://dev.mysql.com/doc/refman/8.0/en/storage-engines.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/8.0/en/storage-engines.html</a></p>
                                    <p><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2021-09-10 02:21:20" itemprop="dateCreated datePublished" datetime="2021-09-10T02:21:20+08:00">2021-09-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.4k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <script>
                            document.querySelectorAll('.random').forEach(item => item.src = "https://picsum.photos/id/" + Math.floor(Math.random() * Math.floor(300)) + "/200/133")

                        </script>
                        <nav class="pagination">
                            <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
                        </nav>
                    </div>
                    <script>
                        window.addEventListener('tabs:register', () =>
                        {
                            let
                            {
                                activeClass
                            } = CONFIG.comments;
                            if (CONFIG.comments.storage)
                            {
                                activeClass = localStorage.getItem('comments_active') || activeClass;
                            }
                            if (activeClass)
                            {
                                let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
                                if (activeTab)
                                {
                                    activeTab.click();
                                }
                            }
                        });
                        if (CONFIG.comments.storage)
                        {
                            window.addEventListener('tabs:click', event =>
                            {
                                if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
                                let commentClass = event.target.classList[1];
                                localStorage.setItem('comments_active', commentClass);
                            });
                        }

                    </script>
                </div>
                <div class="toggle sidebar-toggle">
                    <span class="toggle-line toggle-line-first"></span>
                    <span class="toggle-line toggle-line-middle"></span>
                    <span class="toggle-line toggle-line-last"></span>
                </div>
                <aside class="sidebar">
                    <div class="sidebar-inner">
                        <ul class="sidebar-nav motion-element">
                            <li class="sidebar-nav-toc"> 文章目录 </li>
                            <li class="sidebar-nav-overview"> 站点概览 </li>
                        </ul>
                        <!--noindex-->
                        <div class="post-toc-wrap sidebar-panel">
                        </div>
                        <!--/noindex-->
                        <div class="site-overview-wrap sidebar-panel">
                            <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <img class="site-author-image" itemprop="image" alt="吴志鹏" src="/images/favicon/android-chrome-512x512.png">
                                <p class="site-author-name" itemprop="name">吴志鹏</p>
                                <div class="site-description" itemprop="description">Talk is free，please state clearly</div>
                            </div>
                            <div class="site-state-wrap motion-element">
                                <nav class="site-state">
                                    <div class="site-state-item site-state-posts">
                                        <a href="/archives/">
                                            <span class="site-state-item-count">136</span>
                                            <span class="site-state-item-name">日志</span>
                                        </a>
                                    </div>
                                    <div class="site-state-item site-state-categories">
                                        <a href="/categories/">
                                            <span class="site-state-item-count">158</span>
                                            <span class="site-state-item-name">分类</span></a>
                                    </div>
                                    <div class="site-state-item site-state-tags">
                                        <a href="/tags/">
                                            <span class="site-state-item-count">89</span>
                                            <span class="site-state-item-name">标签</span></a>
                                    </div>
                                </nav>
                            </div>
                            <div class="links-of-author motion-element">
                                <span class="links-of-author-item">
                                    <a href="https://github.com/Payne-Wu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Payne-Wu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
                                </span>
                                <span class="links-of-author-item">
                                    <a href="mailto:wuzhipeng1289690157@gmail.com" title="E-Mail → mailto:wuzhipeng1289690157@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
                                </span>
                                <span class="links-of-author-item">
                                    <a href="https://www.zhihu.com/people/wu-zhi-peng-72-78" title="ZhiHu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;wu-zhi-peng-72-78" rel="noopener" target="_blank"><i class="fa fa-magic fa-fw"></i>ZhiHu</a>
                                </span>
                                <span class="links-of-author-item">
                                    <a href="https://weibo.com/u/6987234483" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6987234483" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
                                </span>
                            </div>
                        </div>
                    </div>
                </aside>
                <div id="sidebar-dimmer"></div>
            </div>
        </main>
        <footer class="footer">
            <div class="footer-inner">
                <div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span>
                    <span class="with-love">
                        <i class="fa fa-heart"></i>
                    </span>
                    <span class="author" itemprop="copyrightHolder">PayneWu</span>
                    <span class="post-meta-divider">|</span>
                    <span class="post-meta-item-icon">
                        <i class="fa fa-chart-area"></i>
                    </span>
                    <span title="站点总字数">255k</span>
                    <span class="post-meta-divider">|</span>
                    <span class="post-meta-item-icon">
                        <i class="fa fa-coffee"></i>
                    </span>
                    <span title="站点阅读时长">3:51</span>
                </div>
                <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">湘ICP备2021019893号-1 </a>
                </div>
                <div style="display: none;">
                    <script src="//s95.cnzz.com/z_stat.php?id=true&web_id=true"></script>
                </div>
            </div>
        </footer>
    </div>
    <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/.js"></script>
    <script src="/js/schemes/pisces.js"></script>
    <script src="/.js"></script>
    <script src="/js/next-boot.js"></script>
    <script src="/.js"></script>
    <script>
        (function ()
        {
            var canonicalURL, curProtocol;
            //Get the <link> tag
            var x = document.getElementsByTagName("link");
            //Find the last canonical URL
            if (x.length > 0)
            {
                for (i = 0; i < x.length; i++)
                {
                    if (x[i].rel.toLowerCase() == 'canonical' && x[i].href)
                    {
                        canonicalURL = x[i].href;
                    }
                }
            }
            //Get protocol
            if (!canonicalURL)
            {
                curProtocol = window.location.protocol.split(':')[0];
            }
            else
            {
                curProtocol = canonicalURL.split(':')[0];
            }
            //Get current URL if the canonical URL does not exist
            if (!canonicalURL) canonicalURL = window.location.href;
            //Assign script content. Replace current URL with the canonical URL
            ! function ()
            {
                var e = /([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,
                    r = canonicalURL,
                    t = document.referrer;
                if (!e.test(r))
                {
                    var n = (String(curProtocol).toLowerCase() === 'https') ? "https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif" : "//api.share.baidu.com/s.gif";
                    t ? (n += "?r=" + encodeURIComponent(document.referrer), r && (n += "&l=" + r)) : r && (n += "?l=" + r);
                    var i = new Image;
                    i.src = n
                }
            }(window);
        })();

    </script>
    <script src="/js/local-search.js"></script>
    <script src="/.js"></script>
</body>

</html>
