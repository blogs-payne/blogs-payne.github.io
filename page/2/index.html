<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="theme-color" content="#222">
    <meta name="generator" content="Hexo 4.2.1">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16-next.png">
    <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#222">
    <meta name="msapplication-config" content="/images/favicon/browserconfig.xml">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
    <link rel="stylesheet" href="/lib/pace/pace-theme-mac-osx.min.css">
    <script src="/lib/pace/pace.min.js"></script>
    <script id="hexo-configurations">
        var NexT = window.NexT ||
        {};
        var CONFIG = {
            "hostname": "paynewu.com",
            "root": "/",
            "scheme": "Gemini",
            "version": "7.8.0",
            "exturl": false,
            "sidebar":
            {
                "position": "right",
                "width": 240,
                "display": "post",
                "padding": 18,
                "offset": 12,
                "onmobile": false
            },
            "copycode":
            {
                "enable": true,
                "show_result": true,
                "style": "mac"
            },
            "back2top":
            {
                "enable": true,
                "sidebar": false,
                "scrollpercent": true
            },
            "bookmark":
            {
                "enable": false,
                "color": "#222",
                "save": "auto"
            },
            "fancybox": false,
            "mediumzoom": true,
            "lazyload": false,
            "pangu": true,
            "comments":
            {
                "style": "tabs",
                "active": "valine",
                "storage": true,
                "lazyload": false,
                "nav": null
            },
            "algolia":
            {
                "hits":
                {
                    "per_page": 10
                },
                "labels":
                {
                    "input_placeholder": "Search for Posts",
                    "hits_empty": "We didn't find any results for the search: ${query}",
                    "hits_stats": "${hits} results found in ${time} ms"
                }
            },
            "localsearch":
            {
                "enable": true,
                "trigger": "auto",
                "top_n_per_article": 8,
                "unescape": false,
                "preload": false
            },
            "motion":
            {
                "enable": false,
                "async": false,
                "transition":
                {
                    "post_block": "bounceDownIn",
                    "post_header": "slideDownIn",
                    "post_body": "slideDownIn",
                    "coll_header": "slideLeftIn",
                    "sidebar": "slideUpIn"
                }
            },
            "path": "search.xml"
        };

    </script>
    <meta name="description" content="Talk is free，please state clearly">
    <meta property="og:type" content="website">
    <meta property="og:title" content="吴志鹏｜Payne-Wu">
    <meta property="og:url" content="https://paynewu.com/page/2/">
    <meta property="og:site_name" content="吴志鹏｜Payne-Wu">
    <meta property="og:description" content="Talk is free，please state clearly">
    <meta property="og:locale" content="zh_CN">
    <meta property="article:author" content="吴志鹏">
    <meta property="article:tag" content="吴志鹏">
    <meta property="article:tag" content="Payne">
    <meta property="article:tag" content="payne-wu">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="Golang">
    <meta property="article:tag" content="go">
    <meta property="article:tag" content="spider">
    <meta property="article:tag" content="crawler">
    <meta property="article:tag" content="js">
    <meta property="article:tag" content="爬虫">
    <meta property="article:tag" content=" CloudNative">
    <meta name="twitter:card" content="summary">
    <link rel="canonical" href="https://paynewu.com/page/2/">
    <script id="page-configurations">
        // https://hexo.io/docs/variables.html
        CONFIG.page = {
            sidebar: "",
            isHome: true,
            isPost: false,
            lang: 'zh-CN'
        };

    </script>
    <title>吴志鹏｜Payne-Wu</title>
    <meta name="google-site-verification" content="p_bIcnvirkFzG2dYKuNDivKD8-STet5W7D-01woA2fc" />
    <noscript>
        <style>
            .use-motion .brand,
            .use-motion .menu-item,
            .sidebar-inner,
            .use-motion .post-block,
            .use-motion .pagination,
            .use-motion .comments,
            .use-motion .post-header,
            .use-motion .post-body,
            .use-motion .collection-header
            {
                opacity: initial;
            }

            .use-motion .site-title,
            .use-motion .site-subtitle
            {
                opacity: initial;
                top: initial;
            }

            .use-motion .logo-line-before i
            {
                left: initial;
            }

            .use-motion .logo-line-after i
            {
                right: initial;
            }

        </style>
    </noscript>
    <link rel="alternate" href="/atom.xml" title="吴志鹏｜Payne-Wu" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
    <div class="container">
        <div class="headband"></div>
        <header class="header" itemscope itemtype="http://schema.org/WPHeader">
            <div class="header-inner">
                <div class="site-brand-container">
                    <div class="site-nav-toggle">
                        <div class="toggle" aria-label="切换导航栏">
                            <span class="toggle-line toggle-line-first"></span>
                            <span class="toggle-line toggle-line-middle"></span>
                            <span class="toggle-line toggle-line-last"></span>
                        </div>
                    </div>
                    <div class="site-meta">
                        <a href="/" class="brand" rel="start">
                            <span class="logo-line-before"><i></i></span>
                            <h1 class="site-title">吴志鹏｜Payne-Wu </h1>
                            <span class="logo-line-after"><i></i></span>
                        </a>
                    </div>
                    <div class="site-nav-right">
                        <div class="toggle popup-trigger">
                            <i class="fa fa-search fa-fw fa-lg"></i>
                        </div>
                    </div>
                </div>
                <nav class="site-nav">
                    <ul id="menu" class="main-menu menu">
                        <li class="menu-item menu-item-home">
                            <a href="/" rel="section">首页</a>
                        </li>
                        <li class="menu-item menu-item-archives">
                            <a href="/archives/" rel="section">文章列表</a>
                        </li>
                        <li class="menu-item menu-item-tags">
                            <a href="/tags/" rel="section">Tags Cloud</a>
                        </li>
                        <li class="menu-item menu-item-categories">
                            <a href="/categories/" rel="section">文章集合</a>
                        </li>
                        <li class="menu-item menu-item-about">
                            <a href="/about/" rel="section">关于我啊</a>
                        </li>
                        <li class="menu-item menu-item-message">
                            <a href="/message/" rel="section">留言与我</a>
                        </li>
                        <li class="menu-item menu-item-search">
                            <a role="button" class="popup-trigger">搜索 </a>
                        </li>
                    </ul>
                </nav>
                <div class="search-pop-overlay">
                    <div class="popup search-popup">
                        <div class="search-header">
                            <span class="search-icon">
                                <i class="fa fa-search"></i>
                            </span>
                            <div class="search-input-container">
                                <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
                            </div>
                            <span class="popup-btn-close">
                                <i class="fa fa-times-circle"></i>
                            </span>
                        </div>
                        <div id="search-result">
                            <div id="no-result">
                                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="back-to-top">
            <i class="fa fa-arrow-up"></i>
            <span>0%</span>
        </div>
        <div class="reading-progress-bar"></div>
        <main class="main">
            <div class="main-inner">
                <div class="content-wrap">
                    <div class="content index posts-expand">
                        <div class="carousel">
                            <div id="wowslider-container">
                                <div class="ws_images">
                                    <ul>
                                    </ul>
                                </div>
                                <div class="ws_thumbs">
                                    <div>
                                    </div>
                                </div>
                                <div class="ws_shadow"></div>
                            </div>
                        </div>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/655772200.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> sekiro <i class="label-arrow"></i>
                                    </a>
                                    <a href="/655772200.html" class="post-title-link" itemprop="url">kubernetes部署sekiro集群</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="Sekiro简介"><a href="#Sekiro简介" class="headerlink" title="Sekiro简介"></a>Sekiro简介</h2>
                                    <blockquote>
                                        <p>开抄！以下来自sekiro官方文档 <a href="https://sekiro.virjar.com/sekiro-doc/index.html" target="_blank" rel="noopener">https://sekiro.virjar.com/sekiro-doc/index.html</a></p>
                                    </blockquote>
                                    <p>SEKIRO 是一个android下的API服务暴露框架，可以用在app逆向、app数据抓取、android群控等场景。同时Sekiro也是目前公开方案唯一稳定的JSRPC框架。</p>
                                    <ol>
                                        <li>对网络环境要求低，sekiro 使用长链接管理服务（可以理解为每个APP内置内网穿透功能），使得 Android 手机可以分布于全国各地，甚至全球各地。手机掺合在普通用户群体，方便实现反抓突破，更加适合获取下沉数据。</li>
                                        <li>不依赖 hook 框架，就曾经的 Hermes 系统来说，和 xposed 框架深度集成，在当今 hook 框架遍地开花的环境下，框架无法方便迁移。所以在 Sekiro 的设计中，只提供了 RPC 功能了。</li>
                                        <li>纯异步调用，在 Hermes 和其他曾经出现过的框架中，基本都是同步调用。虽然说签名计算可以达到上百 QPS，但是如果用来做业务方法调用的话，由于调用过程穿透到目标 app 的服务器，会有大量请求占用线程。系统吞吐存在上线(<br>hermes 系统达到 2000QPS 的时候，基本无法横向扩容和性能优化了)。但是 Sekiro 全程使用 NIO，理论上其吞吐可以把资源占满。</li>
                                        <li>client 实时状态，在 Hermes 系统我使用 http 进行调用转发，通过手机上报心跳感知手机存活状态。心跳时间至少 20s，这导致服务器调度层面对手机在线状态感知不及时，请求过大的时候大量转发调用由于 client 掉线<br>timeout。在 Sekiro 长链接管理下，手机掉线可以实时感知。不再出现由于框架层面机制导致 timeout<br>5.<br>群控能力，一台Sekiro服务器可以轻松管理上万个手机节点或者浏览器节点，且保证他们的RPC调用没有资源干扰。你不需要关心这些节点的物理网络拓扑结构。不需要管理这些手机什么时候上线和下线。如果你是用naohttpd方案，你可能需要为手机提供一个内网环境，然后配置一套内网穿透。一个内网一个机房，你需要管理哪些机房有哪些手机。当你的手机达到一百台之后，对应的物理网络环境就将会比较复杂，且需要开发一个独立系统管理了。如果你使用的时FridaRPC方案，你可能还需要为每几个手机配置一台电脑。然后电脑再配置内网穿透，这让大批量机器管理的拓扑结构更加复杂。这也会导致手机天然集中在一个机房，存在IP、基站、Wi-Fi、定位等环境本身对抗。</li>
                                        <li>多语言扩展能力。Sekiro的客户端lib库，目前已知存在Android(java)、IOS(objective-c)、js(浏览器)<br>、易语言等多种客户端（不是所有的都是Sekiro官方实现）。Sekiro本身提供一个二进制协议（非常简单的二进制协议规则），只要你的语言支持socket(应该所有语言都支持)<br>，那么你就可以轻松为Sekiro实现对应客户端。接入Sekiro，享受Sekiro本身统一机群管理的好处。在Sekiro的roadmap中，我们会基于frida<br>Socket实现frida的客户端，完成Frida分析阶段的代码平滑迁移到Sekiro的生产环境。尽请期待<br>7.<br>客户端接入异步友好。Sekiro全程异步IO设计，这一方面保证整个框架的性能，另一方面更加贴近一般的app或者浏览器本身的异步环境。如果rpc调用用在签名计算上面，大部分签名仅仅是一个算法或者一个so的函数调用。那么同步调用就可以达到非常高的并发。但是如果你想通过rpc调用业务的API（如直接根据参数调用最网络框架的上层API，把参数编解码、加解密都，逻辑拼装都看作黑盒）。此时普通同步调用将会非常麻烦和非常消耗客户端性能。异步转同步的lock信号量机制、同步线程等待导致的线程资源占用和处理任务挤压等风险。FridaRPC支持异步，但是由于他的跨语言问题，并不好去构造异步的callback。目前nanohttpd或者FridaPRC，均大部分情况用在简单的签名函数计算上面。而Sekiro大部分用在上游业务逻辑的直接RPC场景上。</li>
                                        <li>API友好（仅对AndroidAPI），我们为了编程方面和代码优雅，封装了一套开箱即用的API，基于SekiroAPI开发需求将会是非常快乐的。</li>
                                    </ol>
                                    <p>简而言之呢，Sekiro是一个virjar开发的一款强大稳定的rpc服务暴露框架</p>
                                    <h2 id="Kubernetes上部署"><a href="#Kubernetes上部署" class="headerlink" title="Kubernetes上部署"></a>Kubernetes上部署</h2>
                                    <p>首先，我们需要有一个 Kubernetes 集群，可以自己搭建，也可以使用 Minikube 或者用阿里云、腾讯云、Azure 等服务商直接提供的 Kubernetes 服务。 另外我们需要能使用 <code>kubectl</code> 连接和控制当前的集群，</p>
                                    <ul>
                                        <li>搭建 Kubernetes 集群：<a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/" target="_blank" rel="noopener">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/</a></li>
                                        <li>
                                            <p>Minikube：<a href="https://kubernetes.io/docs/tutorials/hello-minikube/" target="_blank" rel="noopener">https://kubernetes.io/docs/tutorials/hello-minikube/</a></p>
                                        </li>
                                        <li>
                                            <p>基于Kubeadmin实现Kubernetes 集群搭建： <a href="https://paynewu.com/18864.html">https://paynewu.com/18864.html</a></p>
                                        </li>
                                    </ul>
                                    <p>上面的内容准备就绪之后，就可以开始 Kubernetes 搭建。搭建完成之后就开始部署Sekiro吧</p>
                                    <p>在Kubernetes中容器环境部署那就离不开image，Sekiro的image为</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">registry.cn-beijing.aliyuncs.com/virjar/sekiro-server:latest</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>无论是Docker、还是podman、亦或者是其他的容器。现成的景象就用这个</p>
                                    </blockquote>
                                    <p>Kubernetes部署服务的常用的有三种形式</p>
                                    <ul>
                                        <li>kubectl cli部署</li>
                                        <li>基于YAML文件格式部署</li>
                                        <li>基于JSON文件格式部署</li>
                                    </ul>
                                    <h3 id="部署服务"><a href="#部署服务" class="headerlink" title="部署服务"></a>部署服务</h3>
                                    <p>首先为此创建一个名为<code>crawleruntil</code> 的 namespace</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">kubectl create namespace crawleruntil</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h1434e1lltj20ws02mjro.jpg" alt="image-20220410033511352"></p>
                                    <blockquote>
                                        <p>因为我已经有<code>crawleruntil</code>这个namespace以及其他的服务，为了方便就不删了在演示了，将图中的sekiro即可</p>
                                    </blockquote>
                                    <p>至此已经完成四分之一了，接下来进行Sekiro的部署，yaml文件如下</p>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">crawleruntil</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">sekiro</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">sekiro</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">sekiro</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">registry.cn-beijing.aliyuncs.com/virjar/sekiro-server:latest</span></span><br><span class="line">          <span class="attr">imagePullPolicy:</span> <span class="string">Always</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5601</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5602</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5603</span></span><br><span class="line">          <span class="attr">resources:</span></span><br><span class="line">            <span class="attr">requests:</span></span><br><span class="line">              <span class="attr">memory:</span> <span class="string">"1Gi"</span></span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">"0.5"</span></span><br><span class="line">            <span class="attr">limits:</span></span><br><span class="line">              <span class="attr">memory:</span> <span class="string">"2Gi"</span></span><br><span class="line">              <span class="attr">cpu:</span> <span class="string">"1"</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">Always</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">crawleruntil</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">sekiro</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">5601</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">nio</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5601</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">5602</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">server</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5602</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">5603</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">ws</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5603</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>将其复制到服务器上，然后使用命令<code>kubectl apply -f 此文件名</code>，当然<code>kubectl create -f 此文件名</code>也可以大差不差。</p>
                                    <p>稍等几秒甚至是一两分钟，看看</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h143bhpa1bj21h80h8tc1.jpg" alt="image-20220410034203246"></p>
                                    <p>确认使用<code>kubectl get all -n crawleruntil</code> 中显示的内容中有STATUS均为<code>Running</code>, 代表就部署成功了</p>
                                    <p>当然这还并不足以使服务可用，因为sekiro它运行在容器内的网络，暂时还无法在本地、或者远程反问服务。此时就需要将服务暴露出去。以便于使用</p>
                                    <h3 id="服务暴露"><a href="#服务暴露" class="headerlink" title="服务暴露"></a>服务暴露</h3>
                                    <p>暴露服务有NotePort, LoadBalance， 此外externalIPs也可以使各类service对外提供服务。当然最推荐的还是<code>Ingress</code>, 关于Ingress是什么感兴趣的请自行搜索。</p>
                                    <p>首先先需要部署ingress collector，请搜索。部署完成后可采用如下YAML进行ingress服务暴露</p>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># https</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">sekiro-ingress</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">crawleruntil</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/ingress.class:</span> <span class="string">traefik</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">server</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/asyncInvoke</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">nio</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/websocket</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">ws</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>此时访问你外网地址, 就会发现。（80需要有权限打开访问哦）</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h143oadhvcj20u809wt90.jpg" alt="image-20220410035421312"></p>
                                    <p>ok，部署完成了！ sekiro就可以食用啦。</p>
                                    <p>以上明显还不够，主要是两个问题</p>
                                    <p>没有身份验证： 那么就意味着任何人都可以调用你的这个接口，岂不是…</p>
                                    <p>某些网页端的JS有证书，这样部署的sekiro无法使用此场景，需要为之加上tls证书。</p>
                                    <h3 id="Ingress-网页添加认证"><a href="#Ingress-网页添加认证" class="headerlink" title="Ingress 网页添加认证"></a>Ingress 网页添加认证</h3>
                                    <p>想偷懒的可以直接使用这三条命令。认证令牌创建一步到位</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">yum -y install httpd</span><br><span class="line"><span class="built_in">echo</span> `<span class="built_in">echo</span> $(hostname) | base64` | htpasswd -ic ./auth  `<span class="built_in">echo</span> $(<span class="built_in">echo</span> $(hostname) | base64)`</span><br><span class="line">kubectl create secret generic basic-auth-secret --from-file auth --namespace=crawleruntil</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>我这里默认采用机器的hostname base64后的字符为用户名与密码。</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="built_in">echo</span> `<span class="built_in">echo</span> $(hostname) | base64` ：密码改这里面的内容</span><br><span class="line">./auth  `<span class="built_in">echo</span> $(<span class="built_in">echo</span> $(hostname) | base64)`： 用户名这里面的内容</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>然后直接使用<code>kubectl create secret generic basic-auth-secret --from-file auth --namespace=crawleruntil</code></p>
                                    <p>创建一个名为<code>basic-auth-secret</code> <code>generic</code>类型的secret。</p>
                                    <blockquote>
                                        <p>注意需要将namespace 指定为crawleruntil，实现同意命名空间</p>
                                    </blockquote>
                                    <p>将它挂到Ingress上去，</p>
                                    <p>Ingress YAML如下</p>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># https</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">sekiro-ingress</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">crawleruntil</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/ingress.class:</span> <span class="string">traefik</span></span><br><span class="line">    <span class="attr">traefik.ingress.kubernetes.io/auth-type:</span> <span class="string">"basic"</span></span><br><span class="line">    <span class="attr">traefik.ingress.kubernetes.io/auth-secret:</span> <span class="string">"basic-auth-secret"</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">server</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/asyncInvoke</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">nio</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/websocket</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">ws</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>打开一个<strong>无痕浏览器</strong>，此时你就可以发现</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h14440ycgvj21l80mkgmj.jpg" alt="image-20220410040928885"></p>
                                    <p>这玩意需要认证了，cool～</p>
                                    <h3 id="域名解析与TLS网络证书"><a href="#域名解析与TLS网络证书" class="headerlink" title="域名解析与TLS网络证书"></a>域名解析与TLS网络证书</h3>
                                    <p>域名：首先你得需要有域名，这个去阿里云、腾讯云、华为云还是等等买就是咯。</p>
                                    <p>证书：将你申请点TLS证书下载到本地，具体请搜索</p>
                                    <p>创建证书的secret, 如下</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">kubectl create secret tls tls-sekiro-paynewu-com --key sekiro.paynewu.com.key --cert=sekiro.paynewu.com_bundle.crt --namespace crawleruntil</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>最终的Ingress YAML如下</p>
                                    <figure class="highlight yaml">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Ingress</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">sekiro-ingress</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">crawleruntil</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/ingress.class:</span> <span class="string">traefik</span></span><br><span class="line">    <span class="attr">traefik.ingress.kubernetes.io/auth-type:</span> <span class="string">"basic"</span></span><br><span class="line">    <span class="attr">traefik.ingress.kubernetes.io/auth-secret:</span> <span class="string">"basic-auth-secret"</span></span><br><span class="line">    <span class="attr">traefik.frontend.rule.type:</span> <span class="string">PathPrefixStrip</span></span><br><span class="line">    <span class="attr">traefik.ingress.kubernetes.io/redirect-entry-point:</span> <span class="string">https</span></span><br><span class="line">    <span class="attr">traefik.backend.circuitbreaker:</span> <span class="string">"NetworkErrorRatio() &gt; 0.5"</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">tls:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">hosts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">sekiro.paynewu.com</span></span><br><span class="line">      <span class="attr">secretName:</span> <span class="string">tls-sekiro-paynewu-com</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">host:</span> <span class="string">sekiro.paynewu.com</span></span><br><span class="line">      <span class="attr">http:</span></span><br><span class="line">        <span class="attr">paths:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">server</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/asyncInvoke</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">nio</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">pathType:</span> <span class="string">Prefix</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/websocket</span></span><br><span class="line">            <span class="attr">backend:</span></span><br><span class="line">              <span class="attr">service:</span></span><br><span class="line">                <span class="attr">name:</span> <span class="string">sekiro</span></span><br><span class="line">                <span class="attr">port:</span></span><br><span class="line">                  <span class="attr">name:</span> <span class="string">ws</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>根路径</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h144c38mn9j20p80ce3yz.jpg" alt="image-20220410041714078"></p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h144qrtmxlj214009edgc.jpg" alt="image-20220410043120299"></p>
                                    <h3 id="注入验证"><a href="#注入验证" class="headerlink" title="注入验证"></a>注入验证</h3>
                                    <p>将 <a href="https://sekiro.virjar.com/sekiro-doc/assets/sekiro_web_client.js" target="_blank" rel="noopener">https://sekiro.virjar.com/sekiro-doc/assets/sekiro_web_client.js</a> 中的文件复制到控制台，执行</p>
                                    <p>然后在控制台调用</p>
                                    <figure class="highlight shell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">var client = new SekiroClient("wss://域名/websocket?group=ws-group-test&amp;clientId=" + guid());</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>校验</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h144u1tj0yj217w07egm8.jpg" alt="image-20220410043429585"></p>
                                    <p>完成～</p>
                                    <h2 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h2>
                                    <p><a href="https://github.com/virjar/sekiro" target="_blank" rel="noopener">Sekiro GitHub</a></p>
                                    <p>其他部署都可以看看邱佬的</p>
                                    <ul>
                                        <li><a href="https://mp.weixin.qq.com/s/m0M_-vlaqFuVufEX6XOwRQ" target="_blank" rel="noopener">linunx/win10搭建sekiro服务+web/app注入实战</a>（上）</li>
                                        <li><a href="https://mp.weixin.qq.com/s/Y1KAs3_PHLmV16BjDPyBZQ" target="_blank" rel="noopener">linunx/win10搭建sekiro服务+web/app注入实战</a>（下）</li>
                                        <li><a href="https://mp.weixin.qq.com/s/XKA3dk_s5EqWOTep1SvI4g" target="_blank" rel="noopener">sekiro服务器配置nginx反向代理升级为https</a></li>
                                    </ul>
                                    <p><a href="https://doc.traefik.io/traefik/v1.7/user-guide/kubernetes/#basic-authentication" target="_blank" rel="noopener">basic-authentication</a></p>
                                    <p><a href="https://doc.traefik.io/traefik/v1.7/configuration/backends/kubernetes/#security-headers-annotations" target="_blank" rel="noopener">security-headers-annotations</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-04-10 03:12:18" itemprop="dateCreated datePublished" datetime="2022-04-10T03:12:18+08:00">2022-04-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>3.6k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>3 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1872139441.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> HomeBrew <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1872139441.html" class="post-title-link" itemprop="url">HomeBrew使用技巧</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p><a href="https://github.com/Homebrew/brew" target="_blank" rel="noopener">GitHub</a></p>
                                    <p><a href="https://brew.sh/" target="_blank" rel="noopener">HomeBrew官方地址</a></p>
                                    <p><a href="https://docs.brew.sh/" target="_blank" rel="noopener">docs</a></p>
                                    <p><a href="https://docs.brew.sh/Formula-Cookbook#homebrew-terminology" target="_blank" rel="noopener">docs-Formula-Cookbook</a></p>
                                    <p><a href="https://brew.idayer.com/" target="_blank" rel="noopener">brew.idayer</a></p>
                                    <h2 id="Homebrew是什么"><a href="#Homebrew是什么" class="headerlink" title="Homebrew是什么"></a>Homebrew是什么</h2>
                                    <p>Homebrew简单来说他是类似于<code>yum、apt</code>,mac的包管理工具，使用它我们可以非常简单、丝滑的下载大部分的包、或者软件</p>
                                    <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 官方</span></span><br><span class="line">/bin/bash -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>"</span></span><br><span class="line"><span class="comment"># cdn</span></span><br><span class="line">/bin/bash -c <span class="string">"<span class="variable">$(curl -fsSL https://cdn.jsdelivr.net/gh/ineo6/homebrew-install/install.sh)</span>"</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>完成安装后使用</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">brew update &amp;&amp; brew upgrade &amp;&amp; brew doctor &amp;&amp; brew -v</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="使用技巧"><a href="#使用技巧" class="headerlink" title="使用技巧"></a>使用技巧</h2>
                                    <h3 id="配置阿里云镜像"><a href="#配置阿里云镜像" class="headerlink" title="配置阿里云镜像"></a>配置阿里云镜像</h3>
                                    <p>配置阿里云mirror：<a href="https://developer.aliyun.com/mirror/homebrew" target="_blank" rel="noopener">https://developer.aliyun.com/mirror/homebrew</a></p>
                                    <p>完成后记得使用如下命令进行更新</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">brew update; brew upgrade; brew cleanup; brew doctor</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="防止更新特定的自制配方"><a href="#防止更新特定的自制配方" class="headerlink" title="防止更新特定的自制配方"></a>防止更新特定的自制配方</h3>
                                    <p>如果要避免更新某些公式，可以使用以下brew命令将当前版本保持不变：</p>
                                    <figure class="highlight apache">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="attribute">brew</span> pin<span class="meta"> [name]</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>当然，您可以取消固定公式以再次对其进行更新：</p>
                                    <figure class="highlight apache">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="attribute">brew</span> unpin<span class="meta"> [formula]</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 查看使用brew安装的服务列表</span></span><br><span class="line">brew services list</span><br><span class="line"> <span class="comment"># 启动服务（仅启动不注册）</span></span><br><span class="line">brew services run formula|--all</span><br><span class="line"><span class="comment"># 启动服务，并注册</span></span><br><span class="line">brew services start formula|--all</span><br><span class="line"><span class="comment"># 停止服务，并取消注册</span></span><br><span class="line">brew services stop formula|--all</span><br><span class="line"><span class="comment"># 重启服务，并注册</span></span><br><span class="line">brew services restart formula|--all</span><br><span class="line"><span class="comment"># 清除已卸载应用的无用的配置</span></span><br><span class="line">brew services cleanup</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="基于软连接实现多版本控制"><a href="#基于软连接实现多版本控制" class="headerlink" title="基于软连接实现多版本控制"></a>基于软连接实现多版本控制</h3>
                                    <p>当hombrew中有多个版本时，可以基于<code>link</code> or <code>unlink</code> 实现包版本的控制</p>
                                    <blockquote>
                                        <ul>
                                            <li>当并不需要配置环境变量时</li>
                                        </ul>
                                    </blockquote>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">brew link [name]</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Linux-下Homebrew安装"><a href="#Linux-下Homebrew安装" class="headerlink" title="Linux 下Homebrew安装"></a>Linux 下Homebrew安装</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Debian or Ubuntu</span></span><br><span class="line">sudo apt-get install -y build-essential procps curl file git</span><br><span class="line"><span class="comment"># Fedora, CentOS, or Red Hat</span></span><br><span class="line">sudo yum groupinstall -y <span class="string">'Development Tools'</span></span><br><span class="line">sudo yum install -y procps-ng curl file git libxcrypt-compat</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><a href="https://docs.brew.sh/Homebrew-on-Linux#requirements" target="_blank" rel="noopener">https://docs.brew.sh/Homebrew-on-Linux#requirements</a></p>
                                    <h2 id="TAP"><a href="#TAP" class="headerlink" title="TAP"></a>TAP</h2>
                                    <figure class="highlight armasm">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="symbol">homebrew</span>/cask</span><br><span class="line"><span class="symbol">homebrew</span>/core</span><br><span class="line"><span class="symbol">homebrew</span>/services</span><br><span class="line"><span class="symbol">isacikgoz</span>/taps</span><br><span class="line"><span class="symbol">mongodb</span>/<span class="keyword">brew</span></span><br><span class="line"><span class="keyword">petere/postgresql</span></span><br><span class="line"><span class="keyword">shivammathur/php</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-04-04 01:13:22" itemprop="dateCreated datePublished" datetime="2022-04-04T01:13:22+08:00">2022-04-04</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>419</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2953982116.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 云源生 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2953982116.html" class="post-title-link" itemprop="url">云源生相关技术栈</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="虚拟化系统"><a href="#虚拟化系统" class="headerlink" title="虚拟化系统"></a>虚拟化系统</h2>
                                    <ul>
                                        <li>进程虚拟化</li>
                                        <li><strong>Namespaces</strong> 进行虚拟化隔离</li>
                                        <li>Control Groups 进行对资源的限制，</li>
                                        <li>联合文件 UFS（Union File Systems)来快速构建（可复用的镜像层）</li>
                                    </ul>
                                    <h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2>
                                    <p>Docker的前世今生</p>
                                    <p>Docker的架构与容器生命周期：created、running、stopped、paused、deleted</p>
                                    <p>Docker 环境搭建</p>
                                    <p>Docker 基本操作</p>
                                    <p>Dockerfile 编写与各指令使用</p>
                                    <p>Docker 网络</p>
                                    <p>Docker 存储</p>
                                    <p>Docker 编排：Docker、Docker-compose、Docker-Swarm</p>
                                    <p>Docker DevOpts</p>
                                    <h2 id="Kubernetes"><a href="#Kubernetes" class="headerlink" title="Kubernetes"></a>Kubernetes</h2>
                                    <p>Kubernetes 的前世今生（Borg 系统）</p>
                                    <p>Kubernetes 架构与生命周期</p>
                                    <p>Kubernetes 基本术语</p>
                                    <p>Kubernetes 环境搭建</p>
                                    <p>Pod</p>
                                    <ul>
                                        <li>什么是Pod</li>
                                        <li>Pod使用</li>
                                        <li>Pod生命周期</li>
                                        <li>Pod健康检查</li>
                                        <li>Pod 调度<ul>
                                                <li>调度器：Deployment、ReplicationController、ReplicaSet、StatefulSets、DaemonSet、Jobs、CronJobs</li>
                                                <li>Pod、Node 亲和性</li>
                                                <li>Pod调度优先级</li>
                                                <li>污点和容忍</li>
                                            </ul>
                                        </li>
                                        <li>Pod扩缩容机制</li>
                                    </ul>
                                    <p>Kubernetes 网络</p>
                                    <ul>
                                        <li>
                                            <p>Services</p>
                                        </li>
                                        <li>
                                            <p>DNS</p>
                                        </li>
                                        <li>Ingress</li>
                                    </ul>
                                    <p>Kubernetes 存储</p>
                                    <ul>
                                        <li>存储机制</li>
                                        <li>存储卷：PV、PVC、StorageClass</li>
                                        <li>GlusterFS</li>
                                        <li>CSI</li>
                                    </ul>
                                    <p>Kubernetes 安全</p>
                                    <ul>
                                        <li>API Server认证与授权</li>
                                        <li>Admission Control</li>
                                        <li>Service Account</li>
                                        <li>Secret</li>
                                    </ul>
                                    <p>Kubernetes 运维管理与监控</p>
                                    <ul>
                                        <li>Helm</li>
                                        <li>DevOps</li>
                                        <li>Dashboard</li>
                                        <li>Prometheus（thanos） + Granfana</li>
                                        <li>Kafka、ElasticSearch、FileBaet、Kibana</li>
                                    </ul>
                                    <p>Kubernetes组件及运行机制</p>
                                    <ul>
                                        <li>API Server</li>
                                        <li>Controller Manager</li>
                                        <li>Scheduler</li>
                                        <li>kubelet</li>
                                        <li>Kube-proxy</li>
                                        <li>etcd</li>
                                        <li>Kubernetes调度器与控制器</li>
                                    </ul>
                                    <p>服务治理-Istio</p>
                                    <p>Envoy</p>
                                    <h2 id="学习资源"><a href="#学习资源" class="headerlink" title="学习资源"></a>学习资源</h2>
                                    <p>官方网站：<a href="https://kubernetes.io" target="_blank" rel="noopener">https://kubernetes.io</a></p>
                                    <p>GitHub: <a href="http://github.com/kubernetes" target="_blank" rel="noopener">http://github.com/kubernetes</a></p>
                                    <p>aliyun：<a href="https://help.aliyun.com/product/85222.html" target="_blank" rel="noopener">https://help.aliyun.com/product/85222.html</a></p>
                                    <h3 id="书"><a href="#书" class="headerlink" title="书"></a>书</h3>
                                    <h3 id="Docker-1"><a href="#Docker-1" class="headerlink" title="Docker"></a>Docker</h3>
                                    <p><a href="https://yeasy.gitbook.io/docker_practice/" target="_blank" rel="noopener">Docker从入门到实践</a></p>
                                    <p>深入浅出Docker</p>
                                    <p>Docker容器与容器云</p>
                                    <p>第一本Docker书</p>
                                    <h3 id="Kubernetes-1"><a href="#Kubernetes-1" class="headerlink" title="Kubernetes"></a>Kubernetes</h3>
                                    <p><a href="https://jimmysong.io/kubernetes-handbook/" target="_blank" rel="noopener">Kubernetes Handbook</a></p>
                                    <p><a href="https://jimmysong.io/istio-handbook/" target="_blank" rel="noopener">istio-handbook</a></p>
                                    <p>Kubernetes权威指南</p>
                                    <p>Kubernetes进阶实战</p>
                                    <p>Kubernetes网络权威指南</p>
                                    <p>Kubernetes生产化与实践之路</p>
                                    <p>深入剖析Kubernetes</p>
                                    <p>Kubernetes源码剖析</p>
                                    <p>Kubernetes in Action</p>
                                    <p>云原生服务网格istio</p>
                                    <p>性能之巅：洞悉系统、企业与云计算洞悉系统、企业与云计算</p>
                                    <p>BPF之巅洞悉Linux系统和应用性能</p>
                                    <h2 id="社区"><a href="#社区" class="headerlink" title="社区"></a>社区</h2>
                                    <p><a href="https://www.kubernetes.org.cn/" target="_blank" rel="noopener">https://www.kubernetes.org.cn/</a></p>
                                    <p><a href="https://jimmysong.io/" target="_blank" rel="noopener">https://jimmysong.io/</a></p>
                                    <h2 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h2>
                                    <p><a href="https://www.bilibili.com/video/BV13Q4y1C7hS" target="_blank" rel="noopener">https://www.bilibili.com/video/BV13Q4y1C7hS</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-04-02 22:10:28" itemprop="dateCreated datePublished" datetime="2022-04-02T22:10:28+08:00">2022-04-02</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.3k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3033307908.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 爬虫 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3033307908.html" class="post-title-link" itemprop="url">爬虫需要学什么，怎么学？</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>爬虫需要学什么，怎么学？小子不才，今日与诸位妄谈<code>爬虫需要学什么，怎么学？</code> 这一话题，个人拙见将自我的学习路程分为如下几个阶段</p>
                                    <ul>
                                        <li>第一层：编程语言</li>
                                        <li>第二层：网络知识，各工具熟练使用</li>
                                        <li>第三层：高性能的爬虫</li>
                                        <li>第四层：JS逆向</li>
                                        <li>第五层：小程序逆向</li>
                                        <li>第六层：Android逆向</li>
                                        <li>第七层：分布式爬虫</li>
                                        <li>第八层：爬虫架构</li>
                                        <li>第九层：工具链构建</li>
                                    </ul>
                                    <h2 id="第一层：编程语言"><a href="#第一层：编程语言" class="headerlink" title="第一层：编程语言"></a>第一层：编程语言</h2>
                                    <p>编程语言自然不必多说，至少得会一门语言。推荐的语言有Java、Python、Go、JS</p>
                                    <p>编程语言可简单细分为如下步骤</p>
                                    <ul>
                                        <li>语言背景与历史</li>
                                        <li>环境搭建</li>
                                        <li>常量变量</li>
                                        <li>基础数据类型（bytes、String、int、bool）等</li>
                                        <li>运算与运算符（<code>+、-、*、÷、｜、&amp;、^、</code>）、位运算</li>
                                        <li>条件分支语句（if、switch等）</li>
                                        <li>循环语句（forloop、while loop）</li>
                                        <li>函数、匿名函数、嵌套函数、闭包</li>
                                        <li>常见算法（递归、分治、回溯）、排序算法、动态规划、贪心算法、遍历算法</li>
                                        <li>错误、异常处理</li>
                                        <li>文件操作</li>
                                        <li>并发编程</li>
                                        <li>网络编程</li>
                                        <li>面向对象</li>
                                        <li>runtime</li>
                                        <li>gc</li>
                                        <li>数据库与中间件（MySQL、MongoDB、Redis、ES）</li>
                                    </ul>
                                    <blockquote>
                                        <p>广度优先，重复学</p>
                                    </blockquote>
                                    <h2 id="第二层：网络知识与各工具使用"><a href="#第二层：网络知识与各工具使用" class="headerlink" title="第二层：网络知识与各工具使用"></a>第二层：网络知识与各工具使用</h2>
                                    <ul>
                                        <li>网络模型，ISO、TCP/IP</li>
                                        <li>网络协议：HTTP、HTTPS</li>
                                        <li>网络知识：URN、URI、URL</li>
                                        <li>认证：cookie、session、Token、JWT</li>
                                    </ul>
                                    <h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3>
                                    <p>浏览器：Chrome</p>
                                    <p>抓包工具：Fiddler、Charles、Mitmproxy（中间人抓包原理，网络原理）</p>
                                    <p>Postman</p>
                                    <p>学完这部分，恭喜你。你已经可以独立开发一个简单的爬虫了</p>
                                    <p>爬虫基本开发步骤如下：</p>
                                    <p>网络抓包，确定目标地址（URN）</p>
                                    <p>发送请求，获取响应</p>
                                    <p>解析响应、获取数据</p>
                                    <p>数据存储（将提取的数据存储到txt或JSON、MySQL、MongoDB、Redis、ES）</p>
                                    <h2 id="第三层：高性能的爬虫"><a href="#第三层：高性能的爬虫" class="headerlink" title="第三层：高性能的爬虫"></a>第三层：高性能的爬虫</h2>
                                    <p>在完成了第二层之后，在其到基础上加速爬虫</p>
                                    <ul>
                                        <li>进程、线程、协程</li>
                                        <li>并发并行</li>
                                        <li>阻塞非阻塞、I/O模型</li>
                                    </ul>
                                    <h2 id="第四层：JS逆向"><a href="#第四层：JS逆向" class="headerlink" title="第四层：JS逆向"></a>第四层：JS逆向</h2>
                                    <p>——“想爬？偏不给你爬！”</p>
                                    <ul>
                                        <li>
                                            <p>反抓包</p>
                                            <ul>
                                                <li>
                                                    <p>证书</p>
                                                </li>
                                                <li>
                                                    <p>双向验证</p>
                                                </li>
                                                <li>竟然不用HTTP(S)！RPC来搅局？</li>
                                            </ul>
                                        </li>
                                    </ul>
                                    <p>反请求</p>
                                    <ul>
                                        <li>
                                            <p>请求头反抓</p>
                                            <ul>
                                                <li>UA</li>
                                                <li>Sign、token、sale</li>
                                                <li>Header</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>代码防护</p>
                                            <ul>
                                                <li>布局混淆</li>
                                                <li>数字混淆</li>
                                                <li>字符串混淆</li>
                                                <li>控制流混淆</li>
                                                <li>预防混淆</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>验证码</p>
                                            <ul>
                                                <li>
                                                    <p>识别点选或输入型</p>
                                                </li>
                                                <li>
                                                    <p>滑轨、滑块型</p>
                                                </li>
                                                <li>
                                                    <p>计算型</p>
                                                </li>
                                                <li>
                                                    <p>空值补齐型</p>
                                                </li>
                                                <li>
                                                    <p>空间推理型</p>
                                                </li>
                                                <li>
                                                    <p>短信或语音验证型</p>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>数据防护</p>
                                            <ul>
                                                <li>动态字体</li>
                                                <li>CSS偏移</li>
                                                <li>内容加密映射</li>
                                                <li>SVG映射等</li>
                                                <li>内容图片化</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>反调试</p>
                                            <ul>
                                                <li>控制台检测</li>
                                                <li>无限debugger来了！</li>
                                                <li>函数居然被重写？</li>
                                                <li>不讲武德，参数生产后删除js！</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>其他反抓</p>
                                            <ul>
                                                <li>风控（如IP、用户行为）</li>
                                                <li>浏览器指纹</li>
                                                <li>代码运行环境检测等</li>
                                                <li>JS虚拟机、jsvm、jsvmp</li>
                                                <li>wasm</li>
                                            </ul>
                                        </li>
                                    </ul>
                                    <p>金盆洗手？自动化工具来助威！ RPC半真半假远程调用</p>
                                    <p>加密算法怎么定位？奇银技巧来助威！ Hook、各种搜索断点、debug（XHR、事件）中场休息助一臂之力</p>
                                    <p>插桩妙调，算法自吐</p>
                                    <p>代码怎么扣？环境怎么补？加密算法怎么还原？？</p>
                                    <p>AST混淆代码对抗，逐一击破，稳扎稳扎。相信自己会逐渐强大</p>
                                    <h2 id="第五层：小程序逆向"><a href="#第五层：小程序逆向" class="headerlink" title="第五层：小程序逆向"></a>第五层：小程序逆向</h2>
                                    <p>在完成第四层JS逆向的基础上，来看看新宠儿小程序？</p>
                                    <p>小程序包如何来，小程序又是如何验证的？</p>
                                    <p>小程序项目结构又如何？</p>
                                    <p>静态调试，全局游走gank</p>
                                    <h2 id="第六层：Android逆向"><a href="#第六层：Android逆向" class="headerlink" title="第六层：Android逆向"></a>第六层：Android逆向</h2>
                                    <p>新的征程？！</p>
                                    <p>Android正向开发也要学！apk、四大组件、项目布局、配置</p>
                                    <p>反编译神器jadx初尝</p>
                                    <p>又抓不到包了啊！</p>
                                    <ul>
                                        <li>不走代理端口了啊</li>
                                        <li>证书校验</li>
                                        <li>居然魔改网络协议？</li>
                                    </ul>
                                    <p>居然还有代码壳，保护代码</p>
                                    <p>“强盗打劫！，移花接木”</p>
                                    <ul>
                                        <li>
                                            <p>Frida</p>
                                        </li>
                                        <li>
                                            <p>ratel</p>
                                        </li>
                                        <li>
                                            <p>Xpose</p>
                                        </li>
                                    </ul>
                                    <p>smail、汇编、C/C++、So</p>
                                    <p>IDA动静调试一探究竟</p>
                                    <p>AOSP</p>
                                    <p>完了，芭比扣了</p>
                                    <blockquote>
                                        <p>补补Java、JNI、Android吧</p>
                                    </blockquote>
                                    <h2 id="第七层：分布式爬虫"><a href="#第七层：分布式爬虫" class="headerlink" title="第七层：分布式爬虫"></a>第七层：分布式爬虫</h2>
                                    <p>任务过多，工人不够？</p>
                                    <p>消息队列抽离任务全局可用，一代多</p>
                                    <p>任务supervisor一带多</p>
                                    <p>配上docker虚拟化,K8s虚拟化，一起拥抱云源生</p>
                                    <p>有始有终，奴奴++</p>
                                    <h2 id="第八层：爬虫架构"><a href="#第八层：爬虫架构" class="headerlink" title="第八层：爬虫架构"></a>第八层：爬虫架构</h2>
                                    <p>跑在云上等，网络角逐者</p>
                                    <p>云监控：<a href="https://thanos.io/" target="_blank" rel="noopener">thanos</a> 、<a href="https://grafana.com/" target="_blank" rel="noopener">grafana</a></p>
                                    <p>日志监控：<a href="https://kafka.apache.org/" target="_blank" rel="noopener">Kafka</a>、<a href="https://www.elastic.co/cn/elasticsearch/" target="_blank" rel="noopener">ElasticSearch</a>、<a href="https://www.elastic.co/cn/beats/filebeat" target="_blank" rel="noopener">FileBaet</a>、<a href="https://www.elastic.co/cn/kibana/" target="_blank" rel="noopener">kibana</a></p>
                                    <h2 id="第九层：工具链构建"><a href="#第九层：工具链构建" class="headerlink" title="第九层：工具链构建"></a>第九层：工具链构建</h2>
                                    <p>UA Pool</p>
                                    <p>Proxy Pool</p>
                                    <p>Account Pool</p>
                                    <p>DL识别验证码</p>
                                    <p>智能解析算法</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-31 12:27:40" itemprop="dateCreated datePublished" datetime="2022-03-31T12:27:40+08:00">2022-03-31</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.7k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>2 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3780016964.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Apache Kafka <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3780016964.html" class="post-title-link" itemprop="url">Kafka线上部署</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>工欲善其事，必先利其器。先把Kafka跑起来！为了资源更有效的利用，需要考虑磁盘、网络带宽</p>
                                    <h2 id="资源规划"><a href="#资源规划" class="headerlink" title="资源规划"></a>资源规划</h2>
                                    <h3 id="磁盘容量"><a href="#磁盘容量" class="headerlink" title="磁盘容量"></a>磁盘容量</h3>
                                    <p>需要考虑几个因素：</p>
                                    <ul>
                                        <li>新增消息数</li>
                                        <li>消息留存时间</li>
                                        <li>平均消息大小</li>
                                        <li>备份数</li>
                                        <li>是否启用压缩</li>
                                    </ul>
                                    <p>计算公式为：新增消息数 <em> 消息留存时间 </em> 平均消息大小 <em> 备份数 </em> 压缩率 * （1 + 10 %）(索引以及其他数据)</p>
                                    <p>假设有个业务每天需要向 Kafka 集群发送 1 亿条消息，每条消息保存两份以防止数据丢失，另外消息默认保存两周时间。现在假设消息的平均大小是 1KB，那么你能说出你的 Kafka 集群需要为这个业务预留多少磁盘空间吗？</p>
                                    <p>每天 1 亿条 1KB 大小的消息，保存两份且留存两周的时间，那么总的空间大小就等于</p>
                                    <p>$10 ^ 8 <em> 1 </em> 2 = 2 * 10^8 KB = 0.2 TB$</p>
                                    <p>加上索引以及其他类型数据 在原有基础上增加 <em>10%</em>,那就是0.22TB</p>
                                    <p>保留两周：0.22TB * 14 = 3.08 TB</p>
                                    <p>压缩率为80%： 3.08 * 0.8 = 2.464 TB ≈ 2.5 TB</p>
                                    <p>保险起见建议预留3 TB的存储空间</p>
                                    <h3 id="网络带宽"><a href="#网络带宽" class="headerlink" title="网络带宽"></a>网络带宽</h3>
                                    <p>对于 Kafka 这种通过网络大量进行数据传输的框架而言，带宽特别容易成为瓶颈。事实上，在接触的真实案例当中，带宽资源不足导致 Kafka 出现性能问题的比例<strong>至少占 60% 以上</strong>。</p>
                                    <p>当规划带宽时到不如说是部署kafka<strong>服务器数量</strong></p>
                                    <p>通常情况下只能假设 Kafka 会用到 70% 的带宽资源，因为总要为其他应用或进程留一些资源。根据实际使用经验，超过 70% 的阈值就有网络丢包的可能性了，故 70% 的设定是一个比较合理的值，也就是说单台 Kafka<br>服务器最多也就能使用大约 700Mb 的带宽资源。</p>
                                    <p>稍等，这只是它能使用的最大带宽资源，你不能让 Kafka 服务器常规性使用这么多资源，故通常要再额外预留出 2/3 的资源，即单台服务器使用带宽 700Mb / 3 ≈ 240Mbps。需要提示的是，这里的 2/3<br>其实是相当保守的，你可以结合你自己机器的使用情况酌情减少此值。</p>
                                    <p>好了，有了 240Mbps，我们就可以计算 1 小时内处理 1TB 数据所需的服务器数量了。根据这个目标，我们每秒需要处理 2336Mb 的数据，除以 240，约等于 10 台服务器。如果消息还需要额外复制两份，那么总的服务器台数还要乘以<br>3，即 30 台。</p>
                                    <h2 id="参数配置"><a href="#参数配置" class="headerlink" title="参数配置"></a>参数配置</h2>
                                    <figure class="highlight dart">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">config</span><br><span class="line">├── connect-console-sink.properties </span><br><span class="line">├── connect-console-source.properties</span><br><span class="line">├── connect-distributed.properties</span><br><span class="line">├── connect-file-sink.properties</span><br><span class="line">├── connect-file-source.properties</span><br><span class="line">├── connect-log4j.properties</span><br><span class="line">├── connect-mirror-maker.properties</span><br><span class="line">├── connect-standalone.properties</span><br><span class="line">├── consumer.properties</span><br><span class="line">├── kraft</span><br><span class="line">│   ├── README.md</span><br><span class="line">│   ├── broker.properties</span><br><span class="line">│   ├── controller.properties</span><br><span class="line">│   └── server.properties</span><br><span class="line">├── log4j.properties </span><br><span class="line">├── producer.properties</span><br><span class="line">├── server.properties </span><br><span class="line">├── tools-log4j.properties</span><br><span class="line">├── trogdor.conf</span><br><span class="line">└── zookeeper.properties</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="JVM-参数与垃圾回收算法"><a href="#JVM-参数与垃圾回收算法" class="headerlink" title="JVM 参数与垃圾回收算法"></a>JVM 参数与垃圾回收算法</h3>
                                    <p>Kafka 服务器端代码是用 Scala 语言编写的，但终归还是会编译成 <code>.Class</code> 文件在 JVM 上运行，因此 JVM 参数设置对于 Kafka 集群的重要性不言而喻。</p>
                                    <p>JVM 端设置，堆大小这个参数至关重要，无脑通用的建议：将 JVM 堆大小设置成 6GB</p>
                                    <p>垃圾回收器的设置，也就是平时常说的 GC 设置。</p>
                                    <p>手动设置使用 G1 收集器。在没有任何调优的情况下，G1 表现得要比 CMS 出色，主要体现在更少的 Full GC，需要调整的参数更少等，所以使用 G1 就好了。</p>
                                    <p>KAFKA_HEAP_OPTS：指定堆大小。</p>
                                    <p>KAFKA_JVM_PERFORMANCE_OPTS：指定 GC 参数。</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="built_in">export</span> KAFKA_HEAP_OPTS=--Xms6g  --Xmx6g</span><br><span class="line"><span class="built_in">export</span> KAFKA_JVM_PERFORMANCE_OPTS= -server -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35 -XX:+ExplicitGCInvokesConcurrent -Djava.awt.headless=<span class="literal">true</span></span><br><span class="line">kafka-server-start.sh <span class="variable">$&#123;KAFKA_HOME&#125;</span>/config/server.properties</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="操作系统参数"><a href="#操作系统参数" class="headerlink" title="操作系统参数"></a>操作系统参数</h3>
                                    <p>通常情况下，Kafka 并不需要设置太多的 系统参数</p>
                                    <p>下面这几个在此较为重要：</p>
                                    <ul>
                                        <li>文件描述符限制：比如ulimit -n 1000000</li>
                                        <li>文件系统类型： 根据官网的测试报告，XFS 的性能要强于 ext4，所以生产环境最好还是使用 XFS甚至是ZFS。</li>
                                        <li>swap：建议将 swappniess 配置成一个接近 0 但不为 0 的值，比如 1。</li>
                                        <li>提交时间：适当的增加提交间隔来降低物理磁盘的写操作</li>
                                    </ul>
                                    <h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 安装jdk</span></span><br><span class="line">sudo yum group install -y <span class="string">"development tools"</span></span><br><span class="line">sudo yum install -y java-1.8.0-openjdk.x86_64</span><br><span class="line"><span class="comment"># 下载kafka</span></span><br><span class="line">wget -c https://mirrors.tuna.tsinghua.edu.cn/apache/kafka/3.1.0/kafka_2.13-3.1.0.tgz</span><br><span class="line"><span class="comment"># 解压缩</span></span><br><span class="line">tar -zxf kafka_2.13-3.1.0.tgz -C /usr/<span class="built_in">local</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置环境变量</span></span><br><span class="line"><span class="comment"># kafka env config </span></span><br><span class="line"><span class="built_in">export</span> KAFKA_HOME=/usr/<span class="built_in">local</span>/kafka_2.13-3.1.0</span><br><span class="line"><span class="built_in">export</span> KAFKA_BIN=<span class="variable">$&#123;KAFKA_HOME&#125;</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;KAFKA_BIN&#125;</span>:PATH</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化</span></span><br><span class="line">kafka-storage.sh format -c <span class="variable">$&#123;KAFKA_HOME&#125;</span>/config/kraft/server.properties -t `kafka-storage.sh random-uuid`</span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">kafka-server-start.sh <span class="variable">$&#123;KAFKA_HOME&#125;</span>/config/kraft/server.properties</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 创建quickstart-events主题</span></span><br><span class="line">kafka-topics.sh --create --topic quickstart-events --bootstrap-server localhost:9092</span><br><span class="line"></span><br><span class="line">kafka-console-producer.sh --topic quickstart-events --bootstrap-server localhost:9092</span><br><span class="line"></span><br><span class="line">kafka-console-consumer.sh --topic quickstart-events --from-beginning --bootstrap-server localhost:9092</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Kafka监控工具"><a href="#Kafka监控工具" class="headerlink" title="Kafka监控工具"></a>Kafka监控工具</h2>
                                    <ul>
                                        <li>JMXTool: 可以实时查看kafka JMX 指标，但仅限于简单的监控场景</li>
                                        <li><a href="https://github.com/didi/LogiKM" target="_blank" rel="noopener">Logi-KM</a>: didi开源的<strong>一站式<code>Apache Kafka</code>集群指标监控与运维管控平台</strong></li>
                                        <li><a href="https://github.com/jmxtrans/jmxtrans" target="_blank" rel="noopener">JMXTrans</a> + InfluxDB + Grafana</li>
                                        <li><a href="https://github.com/smartloli/EFAK" target="_blank" rel="noopener">EFAK</a>：</li>
                                        <li><a href="https://www.kafkatool.com/" target="_blank" rel="noopener">Kafka tool</a>：</li>
                                        <li><a href="https://github.com/yahoo/CMAK" target="_blank" rel="noopener">CMAK</a>：雅虎源的kafka监控器，阿里在用</li>
                                    </ul>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-30 13:12:50" itemprop="dateCreated datePublished" datetime="2022-03-30T13:12:50+08:00">2022-03-30</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.5k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2037230795.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Apache Kafka <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2037230795.html" class="post-title-link" itemprop="url">Kafka发行版本与版本号</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="Kafka-发行版本"><a href="#Kafka-发行版本" class="headerlink" title="Kafka 发行版本"></a>Kafka 发行版本</h2>
                                    <h3 id="Apache-Kafka"><a href="#Apache-Kafka" class="headerlink" title="Apache Kafka"></a>Apache Kafka</h3>
                                    <p>Apache Kafka 是最“正宗”的 Kafka，也应该最熟悉的发行版。</p>
                                    <p>自 Kafka 开源伊始，它便在 Apache 基金会孵化并最终毕业成为顶级项目，它也被称为社区版 Kafka。咱们专栏就是以这个版本的 Kafka<br>作为模板来学习的。更重要的是，它是后面其他所有发行版的基础。也就是说，后面提到的发行版要么是原封不动地继承了 Apache Kafka，要么是在此之上扩展了新功能，总之 Apache Kafka 是我们学习和使用 Kafka 的基础</p>
                                    <h4 id="优"><a href="#优" class="headerlink" title="优"></a>优</h4>
                                    <p>对 Apache Kafka 而言，它现在依然是开发人数最多、版本迭代速度最快的 Kafka。在 2018 年度 Apache 基金会邮件列表开发者数量最多的 Top 5 排行榜中，Kafka 社区邮件组排名第二位。如果你使用 Apache<br>Kafka 碰到任何问题并提交问题到社区，社区都会比较及时地响应你。这对于我们 Kafka 普通使用者来说无疑是非常友好的。</p>
                                    <h4 id="劣"><a href="#劣" class="headerlink" title="劣"></a><strong>劣</strong></h4>
                                    <p><em>Apache Kafka</em> 的劣势在于它仅仅提供最最基础的组件，特别是对于前面提到的 <em>Kafka Connect</em> 而言，社区版 <em>Kafka</em><br>只提供一种连接器，即读写磁盘文件的连接器，而没有与其他外部系统交互的连接器，在实际使用过程中需要自行编写代码实现，这是它的一个劣势。</p>
                                    <p>另外 <em>Apache Kafka</em> 没有提供任何监控框架或工具。显然在线上环境不加监控肯定是不可行的，你必然需要借助第三方的监控框架实现对 <em>Kafka</em> 的监控。好消息是目前有一些开源的监控框架可以帮助用于监控 <em>Kafka</em>（比如 <em><br>Kafka manager</em>）。</p>
                                    <blockquote>
                                        <p>总而言之，如果仅仅需要一个消息引擎系统亦或是简单的流处理应用场景，同时需要对系统有较大把控度，那么推荐你使用 Apache Kafka。</p>
                                    </blockquote>
                                    <h3 id="Confluent-Kafka"><a href="#Confluent-Kafka" class="headerlink" title="Confluent Kafka"></a>Confluent Kafka</h3>
                                    <p>它主要从事商业化 Kafka 工具开发，并在此基础上发布了 Confluent Kafka。Confluent Kafka 提供了一些 Apache Kafka 没有的高级特性，</p>
                                    <p>比如跨数据中心备份、Schema 注册中心以及集群监控工具等。</p>
                                    <h4 id="优-1"><a href="#优-1" class="headerlink" title="优"></a>优</h4>
                                    <p>Confluent Kafka 目前分为免费版和企业版两种。</p>
                                    <p>前者和 Apache Kafka 非常相像，除了常规的组件之外，免费版还包含 Schema 注册中心和 REST proxy 两大功能。</p>
                                    <p>前者是帮助你集中管理 Kafka 消息格式以实现数据前向 / 后向兼容；</p>
                                    <p>后者用开放 HTTP 接口的方式允许你通过网络访问 Kafka 的各种功能，这两个都是 Apache Kafka 所没有的。</p>
                                    <p>除此之外，免费版包含了更多的连接器，它们都是 Confluent 公司开发并认证过的，可以免费使用它们。</p>
                                    <p>至于企业版，它提供的功能就更多了。最有用的当属跨数据中心备份和集群监控两大功能了。</p>
                                    <p>多个数据中心之间数据的同步以及对集群的监控历来是 Kafka 的痛点，Confluent Kafka 企业版提供了强大的解决方案帮助你“干掉”它们</p>
                                    <h4 id="劣-1"><a href="#劣-1" class="headerlink" title="劣"></a>劣</h4>
                                    <p>Confluent 公司暂时没有发展国内业务的计划，相关的资料以及技术支持都很欠缺，很多国内 Confluent Kafka 使用者甚至无法找到对应的中文文档，因此目前 Confluent Kafka 在国内的普及率是比较低的。</p>
                                    <blockquote>
                                        <p>如果需要用到 Kafka 的一些高级特性，那么推荐使用 Confluent Kafka。</p>
                                    </blockquote>
                                    <h3 id="Cloudera-Hortonworks-Kafka"><a href="#Cloudera-Hortonworks-Kafka" class="headerlink" title="Cloudera/Hortonworks Kafka"></a>Cloudera/Hortonworks Kafka</h3>
                                    <p>Cloudera 提供的 CDH 和 Hortonworks 提供的 HDP 是非常著名的大数据平台，里面集成了目前主流的大数据框架，能够帮助用户实现从分布式存储、集群调度、流处理到机器学习、实时数据库等全方位的数据处理。</p>
                                    <p>很多创业公司在搭建数据平台时首选就是这两个产品。不管是 CDH 还是 HDP 里面都集成了 Apache Kafka，因此把这两款产品中的 Kafka 称为 CDH Kafka 和 HDP Kafka。</p>
                                    <h4 id="优-2"><a href="#优-2" class="headerlink" title="优"></a>优</h4>
                                    <p>大数据平台天然集成了 Apache Kafka，通过便捷化的界面操作将 Kafka 的安装、运维、管理、监控全部统一在控制台中。所有的操作都可以在前端 UI 界面上完成，而不必去执行复杂的 Kafka 命令。</p>
                                    <h4 id="劣-2"><a href="#劣-2" class="headerlink" title="劣"></a>劣</h4>
                                    <p>这样做的结果是直接降低了你对 Kafka 集群的掌控程度。</p>
                                    <p>另一个弊端在于它的滞后性。</p>
                                    <p>由于它有自己的发布周期，因此是否能及时地包含最新版本的 Kafka 就成为了一个问题。比如 CDH 6.1.0 版本发布时 Apache Kafka 已经演进到了 2.1.0 版本，但 CDH 中的 Kafka 依然是 2.0.0<br>版本，显然那些在 Kafka 2.1.0 中修复的 Bug 只能等到 CDH 下次版本更新时才有可能被真正修复。</p>
                                    <h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3>
                                    <ul>
                                        <li>
                                            <p>Apache Kafka，也称社区版 Kafka。</p>
                                            <ul>
                                                <li>优势在于迭代速度快，社区响应度高，使用它可以让你有更高的把控度</li>
                                                <li>缺陷在于仅提供基础核心组件，缺失一些高级的特性。</li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p>Confluent Kafka，Confluent 公司提供的 Kafka。</p>
                                            <ul>
                                                <li>优势在于集成了很多高级特性且由 Kafka 原班人马打造，质量上有保证</li>
                                                <li>缺陷在于相关文档资料不全，普及率较低，没有太多可供参考的范例。</li>
                                            </ul>
                                        </li>
                                        <li>CDH/HDP Kafka，大数据云公司提供的 Kafka，内嵌 Apache Kafka。<ul>
                                                <li>优势在于操作简单，节省运维成本</li>
                                                <li>缺陷在于把控度低，演进速度较慢。</li>
                                            </ul>
                                        </li>
                                    </ul>
                                    <h2 id="kafka-版本号"><a href="#kafka-版本号" class="headerlink" title="kafka 版本号"></a>kafka 版本号</h2>
                                    <h3 id="Kafka-版本命名"><a href="#Kafka-版本命名" class="headerlink" title="Kafka 版本命名"></a>Kafka 版本命名</h3>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0qywsepyjj21660eignb.jpg" alt="image-20220329191711226"></p>
                                    <p>其中前半部分为 Scala语言版本，后才为kafka版本，如上图所示</p>
                                    <blockquote>
                                        <p>他们均符合x.y.z 命名规范</p>
                                    </blockquote>
                                    <h3 id="Kafka-版本演进"><a href="#Kafka-版本演进" class="headerlink" title="Kafka 版本演进"></a>Kafka 版本演进</h3>
                                    <p>Kafka 目前总共演进了 7 个大版本，分别是 0.7.x、0.8.x、0.9.x、0.10.x、0.11.x、1.x 、 2.x，3.x 其中的小版本和 Patch 版本很</p>
                                    <p>多。</p>
                                    <blockquote>
                                        <p>本文书写 时最新版本为 3.10（2022-03-29）</p>
                                    </blockquote>
                                    <h4 id="0-7-x版本"><a href="#0-7-x版本" class="headerlink" title="0.7.x版本"></a>0.7.x版本</h4>
                                    <p>很老的Kafka版本，它只有基本的<strong>消息队列</strong>功能，连消息副本机制都没有，不建议使用。</p>
                                    <h4 id="0-8-x版本"><a href="#0-8-x版本" class="headerlink" title="0.8.x版本"></a>0.8.x版本</h4>
                                    <p>两个重要特性，</p>
                                    <p>一个是Kafka 0.8.0增加了副本机制，</p>
                                    <p>另一个是Kafka 0.8.2.0引入了新版本Producer API。</p>
                                    <p>新旧版本Producer API如下：</p>
                                    <figure class="highlight dart">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">//旧版本Producer</span></span><br><span class="line">kafka.javaapi.producer.Producer&lt;K,V&gt; </span><br><span class="line"></span><br><span class="line"><span class="comment">//新版本Producer</span></span><br><span class="line">org.apache.kafka.clients.producer.KafkaProducer&lt;K,V&gt;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>与旧版本相比，新版本Producer<br>API有点不同，一是连接Kafka方式上，旧版本的生产者及消费者API连接的是Zookeeper，而新版本则连接的是Broker；二是新版Producer采用异步方式发送消息，比之前同步发送消息的性能有所提升。但此时的新版Producer<br>API尚不稳定，不建议生产使用。</p>
                                    <h4 id="0-9-x版本"><a href="#0-9-x版本" class="headerlink" title="0.9.x版本"></a>0.9.x版本</h4>
                                    <p>Kafka 0.9 是一个重大的版本迭代，增加了非常多的新特性，主要体现在三个方面：</p>
                                    <ul>
                                        <li><strong>安全方面</strong>：在0.9.0之前，Kafka安全方面的考虑几乎为0。Kafka 0.9.0 在安全认证、授权管理、数据加密等方面都得到了支持，包括支持Kerberos等。</li>
                                        <li><strong>新版本Consumer API</strong>：Kafka 0.9.0 重写并提供了新版消费端API，使用方式也是从连接Zookeeper切到了连接Broker，但是此时新版Consumer<br>API也不太稳定、存在不少Bug，生产使用可能会比较痛苦；而0.9.0版本的Producer API已经比较稳定了，生产使用问题不大。</li>
                                        <li><strong>Kafka Connect</strong>：Kafka 0.9.0 引入了新的组件 Kafka Connect ，用于实现Kafka与其他外部系统之间的数据抽取。</li>
                                    </ul>
                                    <h4 id="0-10-x版本"><a href="#0-10-x版本" class="headerlink" title="0.10.x版本"></a>0.10.x版本</h4>
                                    <p>Kafka 0.10 是一个重要的大版本，因为Kafka 0.10.0.0 引入了 Kafka Streams，使得Kafka不再仅是一个消息引擎，而是往一个分布式流处理平台方向发展。0.10 大版本包含两个小版本：0.10.1 和<br>0.10.2，它们的主要功能变更都是在 Kafka Streams 组件上。</p>
                                    <p>值得一提的是，自 0.10.2.2 版本起，新版本 Consumer API 已经比较稳定了，而且 Producer API 的性能也得到了提升，因此对于使用 0.10.x 大版本的用户，建议使用或升级到 Kafka 0.10.2.2<br>版本。</p>
                                    <h4 id="0-11-x版本"><a href="#0-11-x版本" class="headerlink" title="0.11.x版本"></a>0.11.x版本</h4>
                                    <p>Kafka 0.11 是一个里程碑式的大版本，主要有两个大的变更，一是Kafka从这个版本开始支持 <strong>Exactly-Once 语义</strong><br>即精准一次语义，主要是实现了Producer端的消息幂等性，以及事务特性，这对于Kafka流式处理具有非常大的意义。</p>
                                    <p>另一个重大变更是<strong>Kafka消息格式的重构</strong>，Kafka 0.11主要为了实现Producer幂等性与事务特性，重构了投递消息的数据结构。这一点非常值得关注，因为Kafka<br>0.11之后的消息格式发生了变化，所以我们要特别注意Kafka不同版本间消息格式不兼容的问题。</p>
                                    <h4 id="1-x版本"><a href="#1-x版本" class="headerlink" title="1.x版本"></a>1.x版本</h4>
                                    <p>Kafka 1.x 更多的是Kafka Streams方面的改进，以及Kafka Connect的改进与功能完善等。但仍有两个重要特性，一是Kafka 1.0.0实现了<strong>磁盘的故障转移</strong><br>，当Broker的某一块磁盘损坏时数据会自动转移到其他正常的磁盘上，Broker还会正常工作，这在之前版本中则会直接导致Broker宕机，因此Kafka的可用性与可靠性得到了提升；</p>
                                    <p>二是Kafka 1.1.0开始支持<strong>副本跨路径迁移</strong><br>，分区副本可以在同一Broker不同磁盘目录间进行移动，这对于磁盘的<a href="https://cloud.tencent.com/product/clb?from=10680" target="_blank" rel="noopener">负载均衡</a>非常有意义。</p>
                                    <h4 id="2-x版本"><a href="#2-x版本" class="headerlink" title="2.x版本"></a>2.x版本</h4>
                                    <p>Kafka 2.x 更多的也是Kafka Streams、Connect方面的性能提升与功能完善，以及安全方面的增强等。一个使用特性，Kafka<br>2.1.0开始支持ZStandard的压缩方式，提升了消息的压缩比，显著减少了磁盘空间与网络io消耗。</p>
                                    <h4 id="3-x版本"><a href="#3-x版本" class="headerlink" title="3.x版本"></a>3.x版本</h4>
                                    <ul>
                                        <li>不再支持 Java 8 和 Scala 2.12</li>
                                        <li>Kafka Raft 支持元数据主题的快照以及自我管理的仲裁中的其他改进</li>
                                        <li>为默认启用的 Kafka 生产者提供更强的交付保证</li>
                                        <li>弃用消息格式 v0 和 v1</li>
                                        <li>OffsetFetch 和 FindCoordinator 请求的优化</li>
                                        <li>更灵活的 Mirror Maker 2 配置和 Mirror Maker 1 的弃用</li>
                                        <li>能够在 Kafka Connect 中的一次调用中重新启动连接器的任务</li>
                                        <li>现在默认启用连接器日志上下文和连接器客户端覆盖</li>
                                        <li>Kafka Streams 中时间戳同步的增强语义</li>
                                        <li>改进了 Stream 的 TaskId 的公共 API</li>
                                        <li>Kafka 中的默认 serde 变为 null</li>
                                    </ul>
                                    <h3 id="Kafka版本建议"><a href="#Kafka版本建议" class="headerlink" title="Kafka版本建议"></a>Kafka版本建议</h3>
                                    <ol>
                                        <li>遵循一个基本原则，Kafka客户端版本和服务端版本应该保持一致，否则可能会遇到一些问题。</li>
                                        <li>根据是否用到了Kafka的一些新特性来选择，假如要用到Kafka生产端的消息幂等性，那么建议选择Kafka 0.11 或之后的版本。</li>
                                        <li>选择一个自己熟悉且稳定的版本，如果说没有比较熟悉的版本，建议选择一个较新且稳定、使用比较广泛的版本。</li>
                                    </ol>
                                    <h2 id="referer"><a href="#referer" class="headerlink" title="referer"></a>referer</h2>
                                    <p><a href="https://cloud.tencent.com/developer/article/1596747" target="_blank" rel="noopener">Apache Kafka 版本演进及特性介绍</a></p>
                                    <p><a href="https://archive.apache.org/dist/kafka/3.0.0/RELEASE_NOTES.html" target="_blank" rel="noopener">RELEASE_NOTES</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-29 18:57:28" itemprop="dateCreated datePublished" datetime="2022-03-29T18:57:28+08:00">2022-03-29</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>4.3k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>4 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2370345191.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> calendar <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2370345191.html" class="post-title-link" itemprop="url">中国节假日订阅</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>在一般情况下iPhone的日历是无法显示中国节假日等信息，就非常容易的忘掉一些重要的节日（我对于节日就是后知后觉的），那么有什么办法可以在iPhone原有的基础上加上这属于咱们中国节假日呢。方法当然是有滴，毕竟只要思想不滑坡办法总比问题多嘛。</p>
                                    <p>在全球最大的同性交友网站github闲逛时，一个偶然的机会发现它——china-holiday-calender</p>
                                    <p>基于订阅的方式，实现组件化的方式嵌入到iPhone原生的日历，cool～</p>
                                    <ol>
                                        <li>节假日信息来自<a href="http://www.gov.cn/" target="_blank" rel="noopener">中国政府网</a>，一手信息、权威准确</li>
                                        <li>包含最近3年的节假日信息，机器人自动维护，更新及时</li>
                                        <li>日历标题包含放假、补班的天数信息</li>
                                        <li>日历标题包含放假、补班等关键字，方便脚本开发。例如使用<code>iPhone</code>的<code>快捷指令</code>应用编写工作日闹钟</li>
                                        <li>每个补班日程自动设置上班提醒，默认时间为<code>09:00~18:00</code>、提前一个小时提醒</li>
                                        <li>支持个性化定制补班日程的开始、结束时间和提醒时间(例如提前一天提醒)</li>
                                    </ol>
                                    <p>订阅地址如下：</p>
                                    <ul>
                                        <li>国内订阅地址(<strong>支持定制补班日程</strong>): <a href="https://www.shuyz.com/githubfiles/china-holiday-calender/master/holidayCal.ics" target="_blank" rel="noopener">https://www.shuyz.com/githubfiles/china-holiday-calender/master/holidayCal.ics</a></li>
                                        <li>jsDelivr订阅地址: <a href="https://cdn.jsdelivr.net/gh/lanceliao/china-holiday-calender/holidayCal.ics" target="_blank" rel="noopener">https://cdn.jsdelivr.net/gh/lanceliao/china-holiday-calender/holidayCal.ics</a></li>
                                        <li>GitHub订阅地址(科学上网): <a href="https://raw.githubusercontent.com/lanceliao/china-holiday-calender/master/holidayCal.ics" target="_blank" rel="noopener">https://raw.githubusercontent.com/lanceliao/china-holiday-calender/master/holidayCal.ics</a></li>
                                        <li>Telegram讨论组: <a href="https://t.me/joinchat/EwhMZRVB7xI4OpuXLXukkw" target="_blank" rel="noopener">https://t.me/joinchat/EwhMZRVB7xI4OpuXLXukkw</a></li>
                                    </ul>
                                    <blockquote>
                                        <p>任选其一，主要推荐<code>国内订阅地址(**支持定制补班日程**)</code> ，其次是<code>jsDelivr订阅地址</code></p>
                                    </blockquote>
                                    <h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2>
                                    <ol>
                                        <li>打开日历app（返回首页，如下图所示），点击中间的 “日历”（如下图红色方框所示）</li>
                                    </ol>
                                    <p><img src="/Users/payne/Library/Application Support/typora-user-images/image-20220320072755412.png" alt="image-20220320072755412" style="zoom:50%;" /></p>
                                    <ol>
                                        <li>在日历设置页（如下图所示），点击左下角添加日历 -&gt; 添加订阅日历（如下图红色方框所示）</li>
                                    </ol>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0fzw21zjxj20ki0wctat.jpg" alt="image-20220320072952006" style="zoom:50%;" /></p>
                                    <ol>
                                        <li>将网址输入框中，如下图所示</li>
                                    </ol>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0fzz2wstcj20kw0yc75v.jpg" alt="image-20220320073246216" style="zoom:50%;" /></p>
                                    <ol>
                                        <li>输入 <code>https://www.shuyz.com/githubfiles/china-holiday-calender/master/holidayCal.ics</code> 点击订阅即可</li>
                                    </ol>
                                    <p>完成啦～</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0g03s8iaaj20u01sztcp.jpg" alt="image-20220320073717862" style="zoom:33%;" /></p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0g05fnmg3j21az0u00w8.jpg" alt="image-20220320073853232"></p>
                                    <p>macbook pro 日历</p>
                                    <h2 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h2>
                                    <p>china-holiday-calender: <a href="https://github.com/lanceliao/china-holiday-calender" target="_blank" rel="noopener">https://github.com/lanceliao/china-holiday-calender</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-20 07:11:39" itemprop="dateCreated datePublished" datetime="2022-03-20T07:11:39+08:00">2022-03-20</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.1k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1131385920.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 监控 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1131385920.html" class="post-title-link" itemprop="url">监控系统</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>俗话说“无监控,不运维”， 一套监控预警系统尤为重要</p>
                                    <h2 id="日志监控系统"><a href="#日志监控系统" class="headerlink" title="日志监控系统"></a>日志监控系统</h2>
                                    <p>目前市面上日志监控系统主要是以Elastic家族实现的日志系统，比较盛名的有</p>
                                    <ul>
                                        <li>ELK</li>
                                        <li>EFK</li>
                                        <li>KEFK</li>
                                    </ul>
                                    <p>其中</p>
                                    <p>E为Elastic Search，也就是咱们常说的es</p>
                                    <p>L为logstash，数据处理管道</p>
                                    <p>F为Filebaet，轻量型日志采集器：用于转发和汇总日志与文件</p>
                                    <p>K为Kibana，可拓展的用户展示界面</p>
                                    <blockquote>
                                        <p>主要思路基于ETL抽取（extract）、转换（transform）、加载（load）</p>
                                    </blockquote>
                                    <h3 id="ox1-ELK架构"><a href="#ox1-ELK架构" class="headerlink" title="ox1: ELK架构"></a>ox1: ELK架构</h3>
                                    <h4 id="最简"><a href="#最简" class="headerlink" title="最简"></a>最简</h4>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h04qn1an8lj20nz0fmjry.jpg" alt="image-20220310134833384"></p>
                                    <p><strong>优点</strong></p>
                                    <p>部署简单，轻量</p>
                                    <p><strong>缺点</strong></p>
                                    <p>Logstash同时兼顾了抽取（extract）、转换（transform）、加载（load）。较为损耗资源</p>
                                    <h4 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h4>
                                    <p>基于TCP推送至LogStash</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h04qrlcl18j20j90ad74q.jpg" alt="image-20220310135258151"></p>
                                    <p>优点：较于最简版，大大的减少了服务器负载</p>
                                    <p>缺点：基于SDK开发，有代码侵入。耦合性强</p>
                                    <h3 id="Ox2-EFK"><a href="#Ox2-EFK" class="headerlink" title="Ox2: EFK"></a>Ox2: EFK</h3>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h04r199hvkj20u10nrgnj.jpg" alt="image-20220310140216214"></p>
                                    <p>优点：代码无侵入、占用资源少</p>
                                    <p>缺点：日志数据共享困难；FileBaet只能配置一个output源</p>
                                    <h3 id="0x3-KEFK"><a href="#0x3-KEFK" class="headerlink" title="0x3: KEFK"></a>0x3: KEFK</h3>
                                    <p>Kafka、ElasticSearch、FileBaet、Kibana</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h04r6v0l5oj20va0gx755.jpg" alt="image-20220310140739079"></p>
                                    <p>优点：基于消息队列实现共享，稳定性能性高</p>
                                    <p>缺点：组件多，运维成本大</p>
                                    <h2 id="GPL"><a href="#GPL" class="headerlink" title="GPL"></a>GPL</h2>
                                    <p><a href="https://grafana.com/" target="_blank" rel="noopener">Granfan</a></p>
                                    <p><a href="https://prometheus.io/" target="_blank" rel="noopener">Prometheus</a></p>
                                    <p><a href="https://grafana.com/oss/loki/" target="_blank" rel="noopener">loki</a></p>
                                    <h3 id="GTL"><a href="#GTL" class="headerlink" title="GTL"></a>GTL</h3>
                                    <p><a href="https://grafana.com/" target="_blank" rel="noopener">Granfan</a></p>
                                    <p><a href="https://thanos.io/" target="_blank" rel="noopener">thanos</a>：Thanos 是一组组件，可以组成一个具有无限存储容量的高度可用的指标系统，可以在现有的 Prometheus 部署之上无缝添加。</p>
                                    <p><a href="https://grafana.com/oss/loki/" target="_blank" rel="noopener">loki</a></p>
                                    <h2 id="GTI与Zabbix"><a href="#GTI与Zabbix" class="headerlink" title="GTI与Zabbix"></a>GTI与<strong>Zabbix</strong></h2>
                                    <p><a href="https://www.influxdata.com/" target="_blank" rel="noopener">influxdb</a>+<a href="https://docs.influxdata.com/telegraf/" target="_blank" rel="noopener">telegraf</a>+Grafana</p>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>telegraf+influxdb+Grafana</th>
                                                    <th>Zabbix</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>部署及使用简单</td>
                                                    <td>部署使用相对复杂</td>
                                                </tr>
                                                <tr>
                                                    <td>内置监控项丰富</td>
                                                    <td>内置监控项支持相对少一些，但是社区提供了丰富的监控采集方案</td>
                                                </tr>
                                                <tr>
                                                    <td>不支持跨机房部署</td>
                                                    <td>支持跨机房部署</td>
                                                </tr>
                                                <tr>
                                                    <td>审计功能相对较弱</td>
                                                    <td>审计功能成熟完善</td>
                                                </tr>
                                                <tr>
                                                    <td>出图能力灵活强大</td>
                                                    <td>出图功能相对弱一些，图形化定制方面操作复杂</td>
                                                </tr>
                                                <tr>
                                                    <td>告警功能简单</td>
                                                    <td>告警强大，支持告警依赖，告警升级</td>
                                                </tr>
                                                <tr>
                                                    <td>支持通过webhook方式触发命令</td>
                                                    <td>支持服务器端/客户端的命令自动触发，支持命令推送</td>
                                                </tr>
                                                <tr>
                                                    <td>权限管理相对简单</td>
                                                    <td>支持细粒度的权限定制，权限体系成熟完善</td>
                                                </tr>
                                                <tr>
                                                    <td>数据采集方式相对单一，仅支持自动上报，但支持较为丰富的数据源</td>
                                                    <td>支持多种数据采集方式/协议，数据源相对单一，v3.4.7版本开始支持ES存储历史数据</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <p><a href="https://www.zabbix.com/" target="_blank" rel="noopener">Zabbix</a></p>
                                    <h2 id="相关地址"><a href="#相关地址" class="headerlink" title="相关地址"></a>相关地址</h2>
                                    <p>elasticsearch: <a href="https://www.elastic.co/cn/elasticsearch/" target="_blank" rel="noopener">https://www.elastic.co/cn/elasticsearch/</a></p>
                                    <p>kibana: <a href="https://www.elastic.co/cn/kibana/" target="_blank" rel="noopener">https://www.elastic.co/cn/kibana/</a></p>
                                    <p>logstash: <a href="https://www.elastic.co/cn/logstash/" target="_blank" rel="noopener">https://www.elastic.co/cn/logstash/</a></p>
                                    <p>Kafka: <a href="https://kafka.apache.org/" target="_blank" rel="noopener">https://kafka.apache.org/</a></p>
                                    <p>Granfan:<a href="https://grafana.com/" target="_blank" rel="noopener">https://grafana.com/</a></p>
                                    <p>Prometheus:<a href="https://prometheus.io/" target="_blank" rel="noopener">https://prometheus.io/</a></p>
                                    <p>loki: <a href="https://grafana.com/oss/loki/" target="_blank" rel="noopener">https://grafana.com/oss/loki/</a></p>
                                    <p>thanos：<a href="https://thanos.io/" target="_blank" rel="noopener">https://thanos.io/</a></p>
                                    <p>Zabbix:<a href="https://www.zabbix.com/" target="_blank" rel="noopener">https://www.zabbix.com/</a></p>
                                    <p>telegraf：<a href="https://docs.influxdata.com/telegraf/" target="_blank" rel="noopener">https://docs.influxdata.com/telegraf/</a></p>
                                    <h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2>
                                    <p><a href="https://baijiahao.baidu.com/s?id=1669965625932326951" target="_blank" rel="noopener"><strong>ETL、ELT</strong>区别</a></p>
                                    <p><a href="https://zhuanlan.zhihu.com/p/445747154" target="_blank" rel="noopener">无监控，不运维</a></p>
                                    <p><a href="https://zhuanlan.zhihu.com/p/150190166" target="_blank" rel="noopener">云原生</a></p>
                                    <p><a href="https://yasongxu.gitbook.io/" target="_blank" rel="noopener">监控方案汇总</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-10 13:27:40" itemprop="dateCreated datePublished" datetime="2022-03-10T13:27:40+08:00">2022-03-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.3k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2082667558.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> 二叉树 <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2082667558.html" class="post-title-link" itemprop="url">秒懂二叉树遍历</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="Brush-the-topic-BinaryTree"><a href="#Brush-the-topic-BinaryTree" class="headerlink" title="Brush the topic-BinaryTree"></a>Brush the topic-BinaryTree</h2>
                                    <p>大家好，这是Brush the topic的第一章节,BinaryTree。首先我说一下为什么把这个放在刷题的第一节呢？</p>
                                    <p>原因如下:</p>
                                    <ul>
                                        <li>培养、训练自己的计算机的思维。</li>
                                        <li>锻炼模版化，抽象化思维</li>
                                    </ul>
                                    <p>下面让我们一起去完成一个壮举，那就是完全解决二叉树的遍历问题，以及相关问题。are you ok？</p>
                                    <h2 id="二叉树的遍历"><a href="#二叉树的遍历" class="headerlink" title="二叉树的遍历"></a>二叉树的遍历</h2>
                                    <p>由于对于二叉树的遍历顺序不同，构造出三种不同的遍历方式</p>
                                    <ul>
                                        <li>前序遍历-根左右</li>
                                        <li>中序遍历-左根右</li>
                                        <li>后序遍历-左右根</li>
                                    </ul>
                                    <h3 id="递归代码模版如下"><a href="#递归代码模版如下" class="headerlink" title="递归代码模版如下"></a>递归代码模版如下</h3>
                                    <p><strong>Python</strong></p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 前序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preOreder</span><span class="params">(self, root)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        self.traverse_path.append(root.val)</span><br><span class="line">        preOreder(self.left)</span><br><span class="line">        preOreder(self.right)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inOreder</span><span class="params">(self, root)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        preOreder(self.left)</span><br><span class="line">        self.traverse_path.append(root.val)</span><br><span class="line">        preOreder(self.right)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 后序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postOreder</span><span class="params">(self, root)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        preOreder(self.left)</span><br><span class="line">        preOreder(self.right)</span><br><span class="line">        self.traverse_path.append(root.val)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>Go</strong></p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// 前序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">preOreder</span><span class="params">(root *TreeNode)</span></span> &#123;</span><br><span class="line">  result := []<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">  <span class="keyword">if</span> root == <span class="literal">nil</span> &#123;<span class="keyword">return</span>&#125;</span><br><span class="line">  result  = <span class="built_in">append</span>(result, root.value)</span><br><span class="line">  preOreder(root.Left)</span><br><span class="line">  preOreder(root.Right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 中序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">inOreder</span><span class="params">(root *TreeNode)</span></span> &#123;</span><br><span class="line">  result := []<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">  <span class="keyword">if</span> root == <span class="literal">nil</span> &#123;<span class="keyword">return</span>&#125;</span><br><span class="line">  preOreder(root.Left)</span><br><span class="line">  result  = <span class="built_in">append</span>(result, root.value)</span><br><span class="line">  preOreder(root.Right)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 后序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">postOreder</span><span class="params">(root *TreeNode)</span></span> &#123;</span><br><span class="line">  result := []<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">  <span class="keyword">if</span> root == <span class="literal">nil</span> &#123;<span class="keyword">return</span>&#125;</span><br><span class="line">  postOreder(root.Left)</span><br><span class="line">  postOreder(root.Right)</span><br><span class="line">  result  = <span class="built_in">append</span>(result, root.value)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="practice"><a href="#practice" class="headerlink" title="practice"></a>practice</h3>
                                    <p>基于此我们可以拿下以下题目,完全二叉树递归模版解题</p>
                                    <h2 id="144-二叉树的前序遍历-Python"><a href="#144-二叉树的前序遍历-Python" class="headerlink" title="144. 二叉树的前序遍历-Python"></a><a href="https://leetcode-cn.com/problems/binary-tree-preorder-traversal/" target="_blank" rel="noopener">144. 二叉树的前序遍历</a>-Python</h2>
                                    <h3 id="Recursive"><a href="#Recursive" class="headerlink" title="Recursive"></a><strong>Recursive</strong></h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-1 </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        result = []</span><br><span class="line">        self.helper(root, result)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, result)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span></span><br><span class="line">        result.append(root.val)</span><br><span class="line">        self.helper(root.left, result)</span><br><span class="line">        self.helper(root.right, result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-2 Another way Anonymous function</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">            res.append(root.val)</span><br><span class="line">            helper(root.left)</span><br><span class="line">            helper(root.right)</span><br><span class="line"></span><br><span class="line">        res = list()</span><br><span class="line">        helper(root)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-3 more clean code</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span> []</span><br><span class="line">        res = []</span><br><span class="line">        res.append(root.val)</span><br><span class="line">        res += self.preorderTraversal(root.left)</span><br><span class="line">        res += self.preorderTraversal(root.right)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Iterative"><a href="#Iterative" class="headerlink" title="Iterative"></a><strong>Iterative</strong></h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution-1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution1</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">while</span> root:</span><br><span class="line">                <span class="comment"># 前序遍历-根左右，先拿根</span></span><br><span class="line">                result.append(root.val)</span><br><span class="line">                <span class="comment"># 压栈</span></span><br><span class="line">                stack.append(root)</span><br><span class="line">                <span class="comment"># 拿完根之后拿左儿子</span></span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="comment"># 左儿子拿出来，拿右儿子</span></span><br><span class="line">            node = stack.pop()</span><br><span class="line">            root = node.right</span><br><span class="line">        <span class="comment"># # 完成</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution-2	简化Solution-1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution2</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">if</span> root:</span><br><span class="line">                result.append(root.val)</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                node = stack.pop()</span><br><span class="line">                root = node.right</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution-3</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution3</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [root], []</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            <span class="comment"># 拿出根</span></span><br><span class="line">            node = stack.pop()</span><br><span class="line">            <span class="keyword">if</span> node:</span><br><span class="line">                <span class="comment"># 前序遍历拿出，先拿根的值                </span></span><br><span class="line">                result.append(node.val)</span><br><span class="line">                <span class="comment"># 模仿栈，先入后出。后拿右孩子</span></span><br><span class="line">                stack.append(node.right)</span><br><span class="line">                stack.append(node.left)</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="94-二叉树的中序遍历-Python"><a href="#94-二叉树的中序遍历-Python" class="headerlink" title="94. 二叉树的中序遍历-Python"></a><a href="https://leetcode-cn.com/problems/binary-tree-inorder-traversal/" target="_blank" rel="noopener">94. 二叉树的中序遍历</a>-Python</h2>
                                    <h3 id="Recursive-1"><a href="#Recursive-1" class="headerlink" title="Recursive"></a><strong>Recursive</strong></h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-1 </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        result = []</span><br><span class="line">        self.helper(root, result)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, result)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span></span><br><span class="line">        self.helper(root.left, result)</span><br><span class="line">        result.append(root.val)</span><br><span class="line">        self.helper(root.right, result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-2 Another way Anonymous function</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">            helper(root.left)</span><br><span class="line">            res.append(root.val)</span><br><span class="line">            helper(root.right)</span><br><span class="line"></span><br><span class="line">        res = list()</span><br><span class="line">        helper(root)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-3 more clean code</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span> []</span><br><span class="line">        res = []</span><br><span class="line">        res += self.preorderTraversal(root.left)</span><br><span class="line">        res.append(root.val)</span><br><span class="line">        res += self.preorderTraversal(root.right)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Iterative-1"><a href="#Iterative-1" class="headerlink" title="Iterative"></a><strong>Iterative</strong></h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution - 1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">while</span> root:</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            result.append(node.val)</span><br><span class="line">            root = node.right</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution - 2 简化Solution-1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">if</span> root:</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                node = stack.pop()</span><br><span class="line">                result.append(node.val)</span><br><span class="line">                root = node.right</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution - 3</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution2</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">if</span> root:</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                node = stack.pop()</span><br><span class="line">                result.append(node.val)</span><br><span class="line">                root = node.right</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="145-二叉树的后序遍历"><a href="#145-二叉树的后序遍历" class="headerlink" title="145. 二叉树的后序遍历"></a><a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal/" target="_blank" rel="noopener">145. 二叉树的后序遍历</a></h2>
                                    <h3 id="Recursive-2"><a href="#Recursive-2" class="headerlink" title="Recursive"></a><strong>Recursive</strong></h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, left=None, right=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.left = left</span></span><br><span class="line"><span class="comment">#         self.right = right</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-1 </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        result = []</span><br><span class="line">        self.helper(root, result)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, result)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span></span><br><span class="line">        self.helper(root.left, result)</span><br><span class="line">        self.helper(root.right, result)</span><br><span class="line">        result.append(root.val)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-2 Another way Anonymous function</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(root: TreeNode)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">            helper(root.left)</span><br><span class="line">            helper(root.right)</span><br><span class="line">            res.append(root.val)</span><br><span class="line"></span><br><span class="line">        res = list()</span><br><span class="line">        helper(root)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Recursive-3 more clean code</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span> []</span><br><span class="line">        res = []</span><br><span class="line">        res += self.preorderTraversal(root.left)</span><br><span class="line">        res += self.preorderTraversal(root.right)</span><br><span class="line">        res.append(root.val)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Iterative-2"><a href="#Iterative-2" class="headerlink" title="Iterative"></a><strong>Iterative</strong></h3>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Solution - 1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> root <span class="keyword">or</span> stack:</span><br><span class="line">            <span class="keyword">while</span> root:</span><br><span class="line">                result.append(root.val)</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.right</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            root = node.left</span><br><span class="line">        <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution - 2    </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">if</span> root:</span><br><span class="line">                result.append(root.val)</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.right</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                node = stack.pop()</span><br><span class="line">                root = node.left</span><br><span class="line">        <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Solution - 3</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">        stack, result = [root], []</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            <span class="keyword">if</span> node:</span><br><span class="line">                result.append(node.val)</span><br><span class="line">                stack.append(node.left)</span><br><span class="line">                stack.append(node.right)</span><br><span class="line">        <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>二叉树迭代遍历模版-Python</p>
                                    <figure class="highlight python">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 前序遍历</span></span><br><span class="line"><span class="comment"># Solution-1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution1</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> root <span class="keyword">or</span> stack:</span><br><span class="line">            <span class="keyword">while</span> root:</span><br><span class="line">                result.append(root.val)</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            tmp = stack.pop()</span><br><span class="line">            root = tmp.right</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 中序遍历</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: <span class="keyword">return</span></span><br><span class="line">        stack, result = [], []</span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">while</span> root:</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            result.append(node.val)</span><br><span class="line">            root = node.right</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>由递归到迭代，基本的思想就是由递归中由系统维护的栈，转为手动维护。</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-07 13:37:43" itemprop="dateCreated datePublished" datetime="2022-03-07T13:37:43+08:00">2022-03-07</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>418</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2204086615.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> python <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2204086615.html" class="post-title-link" itemprop="url">有人爱有人恨-GIL</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="什么是GIL"><a href="#什么是GIL" class="headerlink" title="什么是GIL"></a>什么是GIL</h2>
                                    <p>GIL（Global Interpreter Lock，即全局解释器锁），是最流行的 Python 解释器 CPython 中的一个技术术语。它的意思是全局解释器锁，本质上是<strong>类似操作系统的 Mutex</strong><br>，它可以帮助CPython解决其在内存管理中存在的线程不安全问题。</p>
                                    <p>每一个 Python 线程，在 CPython 解释器中执行时，都会先锁住自己的线程，阻止别的线程执行。</p>
                                    <p>简而言之就是<strong>任意时刻，Python 只有一个线程在同时运行</strong>。</p>
                                    <h2 id="为什么需要GIL"><a href="#为什么需要GIL" class="headerlink" title="为什么需要GIL"></a>为什么需要GIL</h2>
                                    <p>在CPython中，<strong>全局解释器锁</strong>（GIL）是一个互斥体，用于保护对Python对象的访问，防止多个线程同时执行Python bytecodes。GIL的存在可<strong>防止竞争确保线程安全</strong>。</p>
                                    <p>所以说，CPython 引进 GIL 主要原因:</p>
                                    <ul>
                                        <li>设计者为了规避类似于内存管理这样的复杂的竞争风险问题（race condition）；</li>
                                        <li>因为 CPython 大量使用 C 语言库，但大部分 C 语言库都不是原生线程安全的（线程安全会降低性能和增加复杂度）。</li>
                                    </ul>
                                    <p>为什么 CPython 需要 GIL 呢？这其实和 CPython 的实现有关。Python 的内存管理机制， CPython 使用引用计数来管理内存，所有 Python<br>脚本中创建的实例，都会有一个引用计数，来记录有多少个指针指向它。当引用计数只有 0 时，则会自动释放内存。</p>
                                    <h2 id="GIL工作原理"><a href="#GIL工作原理" class="headerlink" title="GIL工作原理"></a>GIL工作原理</h2>
                                    <ol>
                                        <li>某个线程拿到GIL</li>
                                        <li>该线程执行代码，直到达到了check_interval*</li>
                                        <li>解释器让当前线程释放GIL</li>
                                        <li>所有的线程开始竞争GIL</li>
                                        <li>竞争到GIL锁的线程又从第1步开始执行</li>
                                    </ol>
                                    <blockquote>
                                        <p>Python2中，check_interavl是当前线程遇见IO操作或者ticks计数达到100<em>。</em></p>
                                        <p>在Python3中是执行时间达到阈值（默认为15毫秒）</p>
                                    </blockquote>
                                    <h2 id="GIL存在的利弊"><a href="#GIL存在的利弊" class="headerlink" title="GIL存在的利弊"></a>GIL存在的利弊</h2>
                                    <h3 id="利"><a href="#利" class="headerlink" title="利"></a>利</h3>
                                    <p>GIL 的设计，主要是为了方便 CPython 解释器层面的编写者</p>
                                    <ul>
                                        <li>在单线程任务中更快；</li>
                                        <li>在多线程任务中，对于I/O密集型程序运行更快；</li>
                                        <li>在多线程任务中，对于用C语言包来实现CPU密集型任务的程序运行更快；</li>
                                        <li>在写C扩展的时候更加容易，因为除非你在扩展中允许，否则Python解释器不会切换线程；</li>
                                        <li>在打包C库时更加容易。我们不用担心线程安全性。，因为如果该库不是线程安全的，则只需在调用GIL时将其锁定即可。</li>
                                    </ul>
                                    <h3 id="弊"><a href="#弊" class="headerlink" title="弊"></a>弊</h3>
                                    <p>这种 GIL 锁的设计对于只使用单线程运行的code来说其实没有什么影响。但是对于计算密集型的程序（CPU-bound）和基于多线程的程序来说，Python 的 GIL 设计<strong>很有可能会</strong>造成性能瓶颈。</p>
                                    <p>例子：</p>
                                    <p>因为有GIL的存在，由CPython做解释器（虚拟机）的多线程Python程序只能利用多核处理器的一个核来运行。</p>
                                    <p>例如，我们将一个8线程的JAVA程序运行在4核的处理器上，那么每个核会运行1个线程，然后利用时间片轮转，轮流运行每一个线程。</p>
                                    <p>但是，我们将一个8线程的Python程序（由CPython作解释器）运行在一个4核处理器上，那么总共只会有1个核在工作，8个线程都要在这一个核上面时间片轮转。</p>
                                    <h2 id="Python-的线程安全"><a href="#Python-的线程安全" class="headerlink" title="Python 的线程安全"></a>Python 的线程安全</h2>
                                    <p>有了 GIL，并不意味着我们 Python 编程者就不用去考虑线程安全了。即使我们知道，GIL 仅允许一个 Python 线程执行，但前面我也讲到了，Python 还有 <strong>check interval</strong> 这样的抢占机制。</p>
                                    <p>所以有了 GIL 并不意味着你的Python程序就可以高枕无忧了，我们仍然需要去注意线程安全。</p>
                                    <p>GIL 的设计，主要是为了方便 CPython 解释器层面的编写者，而不是 Python 应用层面的程序员。作为 Python 的使用者，我们还是需要 lock 等锁，来确保线程安全。</p>
                                    <h2 id="Python多线程"><a href="#Python多线程" class="headerlink" title="Python多线程"></a>Python多线程</h2>
                                    <p>CPython 会做一些小把戏，轮流执行 Python 线程。这样一来，用户看到的就是“伪并行”——Python 线程在交错执行，来模拟真正并行的线程。</p>
                                    <p><strong>所以说Python的多线程是伪多线程</strong></p>
                                    <h3 id="GIL-到底锁的是什么？"><a href="#GIL-到底锁的是什么？" class="headerlink" title="GIL 到底锁的是什么？"></a>GIL 到底锁的是什么？</h3>
                                    <p>GIL 的全称是 Global Interpreter Lock, 全局解释器锁。它锁的是解释器而不是你的 Python 代码。它防止多线程同时执行 Python 的字节码(bytecodes)，防止多线程同时访问 Python 的对象。</p>
                                    <p>在 Python 官方文档Releasing the GIL from extension code中，有这样一段话：</p>
                                    <p>Here is how these functions work: <strong>the global interpreter lock is used to protect the pointer to the current thread<br>state.</strong> When releasing the lock and saving the thread state, the current thread state pointer must be retrieved before<br>the lock is released (since another thread could immediately acquire the lock and store its own thread state in the<br>global variable). Conversely, when acquiring the lock and restoring the thread state, the lock must be acquired before<br>storing the thread state pointer.</p>
                                    <p>其中加黑的这一句话是说：GIL 锁用来保护指向当前进程<strong>状态的指针</strong>。</p>
                                    <p>再看文档Thread State and the Global Interpreter Lock中提到的这样一句话：</p>
                                    <p>Without the lock, even the simplest operations could cause problems in a multi-threaded program: for example, when two<br>threads simultaneously increment the <strong>reference count</strong> of the same object, the reference count could end up being<br>incremented only once instead of twice.</p>
                                    <p>当两个线程同时提高同一个对象的引用计数时，（如果没有 GIL 锁）那么引用计数只会被提高了 1 次而不是 2 次。</p>
                                    <p>大家注意这两段应用中的<code>指针</code>和<code>引用计数</code>。其中指针是 C 语言的概念，Python 没有指针；引用计数是 Python 底层的概念。你平时写的 Python 代码，引用计数是在你调用变量的时候自动增加的，不需要你去手动加 1.</p>
                                    <p>所以 GIL 锁住的东西，都是不需要你的代码直接交互的东西。</p>
                                    <p>Python 的解释器通过切换线程来模拟多线程并发的情况，如上面举的例子，虽然同一个时间只有一个线程在活动，但仍然可以导致并发冲突。</p>
                                    <h2 id="GIL-对-Python-多线程开发的影响"><a href="#GIL-对-Python-多线程开发的影响" class="headerlink" title="GIL 对 Python 多线程开发的影响"></a>GIL 对 Python 多线程开发的影响</h2>
                                    <p>在提到开发性能瓶颈的时候，我们经常把对资源的限制分为两类，</p>
                                    <ul>
                                        <li>一类是计算密集型（CPU-bound）</li>
                                        <li>一类是 I/O 密集型（I/O-bound）。</li>
                                    </ul>
                                    <p>计算密集型的程序是指的是把 CPU 资源耗尽的程序，也就是说想要提高性能速度，就需要提供更多更强的 CPU，比如矩阵运算，图片处理这类程序。</p>
                                    <p>I/O 密集型的程序只的是那些花费大量时间在等待 I/O 运行结束的程序，比如从用户指定的文件中读取数据，从数据库或者从网络中读取数据，I/O 密集型的程序对 CPU 的资源需求不是很高。</p>
                                    <h3 id="如何加速？"><a href="#如何加速？" class="headerlink" title="如何加速？"></a>如何加速？</h3>
                                    <p>一般来说 IO 密集型用多线程、协程来加速，CPU 密集型用多进程来加速。</p>
                                    <p>结合来看IO密集型使用协程 + 多进程 不失为“最佳”方案：</p>
                                    <p>aiomultiprocess：<a href="https://pypi.org/project/aiomultiprocess/" target="_blank" rel="noopener">https://pypi.org/project/aiomultiprocess/</a></p>
                                    <p><strong>如何绕过GIL？</strong></p>
                                    <p>你并不需要过多考虑 GIL。因为如果多线程计算成为性能瓶颈，往往已经有 Python 库来解决这个问题了。</p>
                                    <p>绕过 GIL 的大致思路有这么两种：</p>
                                    <ul>
                                        <li>绕过 CPython，使用 JPython（Java 实现的 Python 解释器）等别的实现；</li>
                                        <li>把关键性能代码，放到别的语言（一般是 C++）中实现。</li>
                                    </ul>
                                    <h2 id="referer"><a href="#referer" class="headerlink" title="referer"></a>referer</h2>
                                    <p><a href="https://mp.weixin.qq.com/s/a37OxUjgHdps1ZsPB7pKcQ" target="_blank" rel="noopener">也许你对 Python GIL 锁的理解是 错的。—— kingname</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-07 12:52:45" itemprop="dateCreated datePublished" datetime="2022-03-07T12:52:45+08:00">2022-03-07</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>3.2k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>3 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/765699237.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> mitmproxy <i class="label-arrow"></i>
                                    </a>
                                    <a href="/765699237.html" class="post-title-link" itemprop="url">mitmproxy的使用</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>MitmProxy是一组优秀的网络代理拦截工具，可为 HTTP/1、HTTP/2 和 WebSockets 提供交互式、支持 SSL/TLS 的拦截代理。它提供 拦截 HTTP 和 HTTPS 请求和响应并动态修改它们、保存完整的 HTTP<br>会话，以供重放攻击和分析、反向代理模式将流量转发到指定服务器、macOS 和 Linux 上的透明代理、对 HTTP 流量进行脚本化更改等功能。</p>
                                    <ul>
                                        <li>官方地址：<a href="https://mitmproxy.org/" target="_blank" rel="noopener">https://mitmproxy.org/</a></li>
                                        <li>官方文档：<a href="https://docs.mitmproxy.org" target="_blank" rel="noopener">https://docs.mitmproxy.org</a></li>
                                        <li>官方博客：<a href="https://mitmproxy.org/posts/" target="_blank" rel="noopener">https://mitmproxy.org/posts/</a></li>
                                        <li>插件: <a href="https://docs.mitmproxy.org/stable/addons-overview/" target="_blank" rel="noopener">https://docs.mitmproxy.org/stable/addons-overview/</a></li>
                                        <li>Github: <a href="https://github.com/mitmproxy/mitmproxy" target="_blank" rel="noopener">https://github.com/mitmproxy/mitmproxy</a></li>
                                        <li>Releases：<a href="https://github.com/mitmproxy/mitmproxy/releases" target="_blank" rel="noopener">https://github.com/mitmproxy/mitmproxy/releases</a></li>
                                        <li>DockerHub：<a href="https://hub.docker.com/r/mitmproxy/mitmproxy/" target="_blank" rel="noopener">https://hub.docker.com/r/mitmproxy/mitmproxy</a></li>
                                        <li>证书安装: <a href="http://mitm.it/" target="_blank" rel="noopener">http://mitm.it/</a></li>
                                    </ul>
                                    <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                                    <h3 id="Python3安装"><a href="#Python3安装" class="headerlink" title="Python3安装"></a>Python3安装</h3>
                                    <p>直接使用pip即可，使用如下命令进行安装</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 升级pip</span></span><br><span class="line">python3 -m pip install -U pip</span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">python3 -m pip install -U mitmproxy</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>由于windows话默认是没有python3的（如果你没做兼容也就是将python复制一份副本并重命名为python3），使用python即可</p>
                                    </blockquote>
                                    <h3 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h3>
                                    <p>Mac 下推荐使用 <code>homebrew</code>安装，尤其是<code>m1</code>的，注意啦！！！</p>
                                    <p>别问我怎么知道的，说多了都是泪</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">brew install mitmproxy</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="mitmproxy组成"><a href="#mitmproxy组成" class="headerlink" title="mitmproxy组成"></a>mitmproxy组成</h2>
                                    <p>mitmproxy 由mitmproxy、mitmdump、mitmweb组成</p>
                                    <h3 id="mitmproxy"><a href="#mitmproxy" class="headerlink" title="mitmproxy"></a>mitmproxy</h3>
                                    <p>mitmproxy是用于调试、测试、隐私测量和渗透测试的瑞士军刀。它可用于拦截、检查、修改和重放 Web 流量，例如 HTTP/1、HTTP/2、WebSockets 或任何其他受 SSL/TLS 保护的协议。您可以美化和解码从 HTML<br>到 Protobuf 的各种消息类型，即时截取特定消息，在它们到达目的地之前对其进行修改，并稍后将它们重播到客户端或服务器。</p>
                                    <h3 id="mitmdump"><a href="#mitmdump" class="headerlink" title="mitmdump"></a>mitmdump</h3>
                                    <p>强大的插件功能与python api集成，提供了对mitmproxy的完全控制，可以自动修改消息、重定向流量、可视化消息或实现自定义命令。基于mitmdump可实现拓展，完全自由定制。实现基于此的流量转发代理中间件。</p>
                                    <h3 id="mitmproxy-1"><a href="#mitmproxy-1" class="headerlink" title="mitmproxy"></a>mitmproxy</h3>
                                    <p>在图形界面中使用 mitmproxy 的主要功能 mitmweb。mitmweb 为您提供任何其他应用程序或设备的类似体验，以及请求拦截和重放等附加功能。</p>
                                    <h2 id="证书安装与配置"><a href="#证书安装与配置" class="headerlink" title="证书安装与配置"></a>证书安装与配置</h2>
                                    <p>对于任何中间人抓包工具来说，若需要完整的捕获HTTPS请求，必须需要配置HTTPS证书。由于mitmproxy的证书在安装时便已经自带了，所以不必多次安装。只需配置证书即可。</p>
                                    <p>手机上需要下载直接进入 <a href="http://mitm.it/" target="_blank" rel="noopener">http://mitm.it/</a> 即可（需要先连接上mitmproxy的代理）</p>
                                    <h2 id="mitmproxy界面"><a href="#mitmproxy界面" class="headerlink" title="mitmproxy界面"></a>mitmproxy界面</h2>
                                    <p>mitmproxy有许多的功能界面主要有以下几个</p>
                                    <h3 id="index"><a href="#index" class="headerlink" title="index"></a>index</h3>
                                    <p>打开代理时的index界面，此界面为中心界面，一进来就是这个，简要的介绍了包</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00od9mq9lj21js0u0qls.jpg" alt="image-20220307012744921"></p>
                                    <h3 id="包详情界面"><a href="#包详情界面" class="headerlink" title="包详情界面"></a>包详情界面</h3>
                                    <p>使用<code>j</code>、<code>k</code> （或者上下方向键）实现包之间的移动，enter（回车）进入包的详情界面，可以使用tab进行切换。如下图所示</p>
                                    <blockquote>
                                        <p>当然是要大写的 <code>P</code> 也可以进入这里</p>
                                    </blockquote>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00oeqi65tj21hp0u0tf3.jpg" alt="image-20220307012909484"></p>
                                    <h3 id="帮助界面"><a href="#帮助界面" class="headerlink" title="帮助界面"></a>帮助界面</h3>
                                    <p>每个CLI基本上都有help，而mitmproxy自然也有， 如下</p>
                                    <blockquote>
                                        <p><code>?</code>: 进入</p>
                                    </blockquote>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00olhfb8lj21hn0u0goo.jpg" alt="image-20220307013538512"></p>
                                    <p>还有过滤帮助，可以使用<code>TAB</code> 实现切换。如下所示</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00omjcg24j21c40u0ady.jpg" alt="image-20220307013639677"></p>
                                    <p>当使用<code>f</code> 快速进入过滤命令中 再加上过滤语法即可实现过滤，并在其中输入 <code>~u baidu</code>如下所示</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00ooh970tj21go0u0gnd.jpg" alt="image-20220307013812180"></p>
                                    <p>实现对url为 <code>baidu</code> 的实现过滤展示</p>
                                    <h3 id="Key-Bindings界面"><a href="#Key-Bindings界面" class="headerlink" title="Key Bindings界面"></a>Key Bindings界面</h3>
                                    <p><code>shift + k</code> 也就是大写的K进入此界面</p>
                                    <p>按键绑定界面，这里展示了所有的按键在mitmproxy中的功能，当然也可以修改其绑定，其界面如下所示。</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00ojylhwpj215g0u0tc4.jpg" alt="image-20220307013411247"></p>
                                    <h3 id="Events界面"><a href="#Events界面" class="headerlink" title="Events界面"></a>Events界面</h3>
                                    <p>此界面可以查看捕获流量的所有事件，使用<code>E</code> 进入，如下所示</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00oraucocj21bz0u0ai3.jpg" alt="image-20220307014113646"></p>
                                    <h3 id="Command-Reference界面"><a href="#Command-Reference界面" class="headerlink" title="Command Reference界面"></a>Command Reference界面</h3>
                                    <p>所有的输入的命令都可以在这里找到，当然需要一些英文的识别能力， 如下所示</p>
                                    <blockquote>
                                        <p><code>shift + c</code> ：进入Command Reference界面</p>
                                        <p><code>:</code> 进入命令输入状态</p>
                                    </blockquote>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00otmz81bj21kd0u0wke.jpg" alt="image-20220307014328724"></p>
                                    <h3 id="Options界面"><a href="#Options界面" class="headerlink" title="Options界面"></a>Options界面</h3>
                                    <p>参数选项界面，可以认为这是mitmproxy设置界面， 如下所示</p>
                                    <blockquote>
                                        <p>大写的<code>o</code> 进入</p>
                                    </blockquote>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h00ovqurflj21em0u0792.jpg" alt="image-20220307014527641"></p>
                                    <h2 id="一些常用的按键"><a href="#一些常用的按键" class="headerlink" title="一些常用的按键"></a>一些常用的按键</h2>
                                    <h3 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h3>
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>快捷键</th>
                                                    <th>command</th>
                                                    <th>说明</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>q</td>
                                                    <td>console.view.pop</td>
                                                    <td>返回：界面间的返回</td>
                                                </tr>
                                                <tr>
                                                    <td>g</td>
                                                    <td>console.nav.start</td>
                                                    <td>跳到第一行</td>
                                                </tr>
                                                <tr>
                                                    <td>G</td>
                                                    <td>console.nav.end</td>
                                                    <td>跳到最后一行</td>
                                                </tr>
                                                <tr>
                                                    <td>h</td>
                                                    <td>console.nav.left</td>
                                                    <td>跳到左面</td>
                                                </tr>
                                                <tr>
                                                    <td>j</td>
                                                    <td>console.nav.down</td>
                                                    <td>跳到下一行</td>
                                                </tr>
                                                <tr>
                                                    <td>k</td>
                                                    <td>console.nav.up</td>
                                                    <td>跳到上一行</td>
                                                </tr>
                                                <tr>
                                                    <td>l</td>
                                                    <td>console.nav.right</td>
                                                    <td>跳到右面</td>
                                                </tr>
                                                <tr>
                                                    <td>space</td>
                                                    <td>console.nav.pagedown</td>
                                                    <td>跳到本页最后一行</td>
                                                </tr>
                                                <tr>
                                                    <td>ctrl b</td>
                                                    <td>console.nav.pageup</td>
                                                    <td>跳到本页第一行</td>
                                                </tr>
                                                <tr>
                                                    <td>ctrl f</td>
                                                    <td>console.nav.pagedown</td>
                                                    <td>跳到本页最后一行</td>
                                                </tr>
                                                <tr>
                                                    <td>tab</td>
                                                    <td>console.nav.next</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <p>可参考 help 界面</p>
                                    <p>e: 快速生成请求</p>
                                    <h2 id="mitmdump具体实现"><a href="#mitmdump具体实现" class="headerlink" title="mitmdump具体实现"></a>mitmdump具体实现</h2>
                                    <p>一个基于mitmdump 实现的流式流量转发处理平台: <a href="https://github.com/WebSpiderSuperStar/MitmDumpMan" target="_blank" rel="noopener">mitmdumpMan</a></p>
                                    <h2 id="抓包tips"><a href="#抓包tips" class="headerlink" title="抓包tips"></a>抓包tips</h2>
                                    <ul>
                                        <li>使用类似与SwitchyOmega实现端口塞选效果更佳</li>
                                    </ul>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-07 00:38:21" itemprop="dateCreated datePublished" datetime="2022-03-07T00:38:21+08:00">2022-03-07</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>2.1k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>2 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/1492784679.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> nginx <i class="label-arrow"></i>
                                    </a>
                                    <a href="/1492784679.html" class="post-title-link" itemprop="url">初探nginx</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p><a href="https://nginx.org/" target="_blank" rel="noopener">开源官方网站</a></p>
                                    <p><a href="https://nginx.org/en/download.html" target="_blank" rel="noopener">下载界面</a></p>
                                    <p><a href="https://nginx.org/en/docs/" target="_blank" rel="noopener">官方文档</a></p>
                                    <p><a href="http://openresty.org/en/" target="_blank" rel="noopener">openresty</a></p>
                                    <p><a href="https://nginx.com/" target="_blank" rel="noopener">商业nginx</a></p>
                                    <p><a href="http://openresty.com" target="_blank" rel="noopener">商业openresty</a></p>
                                    <h2 id="什么是Nginx"><a href="#什么是Nginx" class="headerlink" title="什么是Nginx"></a>什么是Nginx</h2>
                                    <p><strong>Nginx</strong> <strong>(engine x)</strong> 是一款轻量级的Web 服务器 、反向代理服务器及电子邮件（IMAP/POP3）代理服务器。</p>
                                    <p><strong>反向代理：</strong></p>
                                    <p>反向代理（Reverse<br>Proxy）方式是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器。</p>
                                    <p><strong>正向代理:</strong></p>
                                    <p>是一个位于客户端和原始服务器(origin server)之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标(原始服务器)，然后代理向原始服务器转交请求并将获得的内容返回给客户端。客户端才能使用正向代理。</p>
                                    <h3 id="正向代理和反向代理区别？"><a href="#正向代理和反向代理区别？" class="headerlink" title="正向代理和反向代理区别？"></a>正向代理和反向代理区别？</h3>
                                    <p><strong>正向代理</strong>，<strong>是在客户端的。</strong>比如需要访问某些国外网站，我们可能需要购买vpn。并且<strong>vpn是在我们的用户浏览器端设置的</strong>(并不是在远端的服务器设置)。浏览器先访问vpn地址，vpn地址转发请求，并最后将请求结果原路返回来。</p>
                                    <p><strong>反向代理是作用在服务器端的，是一个虚拟ip(VIP)</strong>。对于用户的一个请求，会转发到多个后端处理器中的一台来处理该具体请求。</p>
                                    <h2 id="为什么是Nginx？"><a href="#为什么是Nginx？" class="headerlink" title="为什么是Nginx？"></a>为什么是Nginx？</h2>
                                    <p>互联网数据量快速增长，高并发</p>
                                    <p>摩尔定律：性能提升</p>
                                    <p>比Apache(一个连接对应一个进程)更快</p>
                                    <h3 id="Nginx优点"><a href="#Nginx优点" class="headerlink" title="Nginx优点"></a>Nginx优点</h3>
                                    <ul>
                                        <li>高并发、高性能</li>
                                        <li>可拓展性好（插件）</li>
                                        <li>高可靠</li>
                                        <li>热部署</li>
                                        <li>BSD认证</li>
                                    </ul>
                                    <h2 id="Nginx-主要使用场景"><a href="#Nginx-主要使用场景" class="headerlink" title="Nginx 主要使用场景"></a>Nginx 主要使用场景</h2>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1gzuy18sw32j20j50hrdh4.jpg" alt="image-20220302040819009" style="zoom:50%;" /></p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1gzuy0uhn4zj20lz0l3dgt.jpg" alt="image-20220302040819009" style="zoom:50%;" /></p>
                                    <h2 id="Nginx组成"><a href="#Nginx组成" class="headerlink" title="Nginx组成"></a>Nginx组成</h2>
                                    <ul>
                                        <li>Nginx，二进制可执行文件</li>
                                        <li>Nginx config 配置文件： 控制nginx行为</li>
                                        <li>access log : 记录每一条请求</li>
                                        <li>error log：错误日志</li>
                                    </ul>
                                    <h2 id="Nginx-版本"><a href="#Nginx-版本" class="headerlink" title="Nginx 版本"></a>Nginx 版本</h2>
                                    <p>Mainline version：主线版本，最新功能等</p>
                                    <p>Stable version：稳定版，</p>
                                    <p>Legacy versions：历史版本</p>
                                    <p><a href="http://tengine.taobao.org/" target="_blank" rel="noopener">tenginx</a></p>
                                    <p><a href="https://nginx.org/en/CHANGES" target="_blank" rel="noopener">nginx各版本更新日志</a></p>
                                    <ul>
                                        <li>Bugfix： 修复bug</li>
                                        <li>Change： 修改</li>
                                        <li>Feature： 新特性</li>
                                    </ul>
                                    <h2 id="编译安装Nginx"><a href="#编译安装Nginx" class="headerlink" title="编译安装Nginx"></a>编译安装Nginx</h2>
                                    <p>安装Nginx 通常有两张方式，其一，那便是使用包管理工具如<code>yum</code>、<code>apt-get</code>、<code>homebrew</code>、<code>winget</code>等直接安装，而另外一种便是编译安装。</p>
                                    <p>个人推荐使用编译安装，其主要原因为可以将各组件一起编译生成，兼容其强大的生态。</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Download</span></span><br><span class="line">curl -OC - https://nginx.org/download/nginx-1.20.2.tar.gz</span><br><span class="line"><span class="comment"># unzip</span></span><br><span class="line">tar -xzf nginx-1.20.2.tar.gz &amp;&amp; <span class="built_in">cd</span> nginx-1.20.2</span><br><span class="line"><span class="comment"># 编译(默认参数)</span></span><br><span class="line"><span class="comment"># yum -y install gcc gcc-c++ make libtool zlib zlib-devel openssl openssl-devel pcre pcre-devel</span></span><br><span class="line">./configure --prefix=/opt</span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">make </span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">make install</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">./configure --prefix=/usr/<span class="built_in">local</span>/nginx </span><br><span class="line">  --pid-path=/var/run/nginx/nginx.pid </span><br><span class="line">  --lock-path=/var/lock/nginx.lock </span><br><span class="line">  --error-log-path=/var/<span class="built_in">log</span>/nginx/error.log </span><br><span class="line">  --http-log-path=/var/<span class="built_in">log</span>/nginx/access.log </span><br><span class="line">  --with-http_gzip_static_module </span><br><span class="line">  --http-client-body-temp-path=/var/temp/nginx/client </span><br><span class="line">  --http-proxy-temp-path=/var/temp/nginx/proxy </span><br><span class="line">  --http-fastcgi-temp-path=/var/temp/nginx/fastcgi </span><br><span class="line">  --http-uwsgi-temp-path=/var/temp/nginx/uwsgi </span><br><span class="line">  --http-scgi-temp-path=/var/temp/nginx/scgi</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>相关参数</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1gzv31s7hj2j20qq0d0js5.jpg" alt="1051646169511_.pic" /></p>
                                    <h2 id="nginx源码目录结构"><a href="#nginx源码目录结构" class="headerlink" title="nginx源码目录结构"></a>nginx源码目录结构</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">drwxr-xr-x 6 1001 1001   4096 Mar  2 03:09 auto: 编译时所用</span><br><span class="line">-rw-r--r-- 1 1001 1001 312251 Nov 16 22:44 CHANGES：版本变更</span><br><span class="line">-rw-r--r-- 1 1001 1001 476577 Nov 16 22:44 CHANGES.ru：版本变更（俄语）</span><br><span class="line">drwxr-xr-x 2 1001 1001   4096 Mar  2 03:09 conf nginx配置示例文件</span><br><span class="line">-rwxr-xr-x 1 1001 1001   2590 Nov 16 22:44 configure：用来生产中间文件，执行编译前的必备动作</span><br><span class="line">drwxr-xr-x 4 1001 1001   4096 Mar  2 03:09 contrib：vim工具，</span><br><span class="line">drwxr-xr-x 2 1001 1001   4096 Mar  2 03:09 html: 500错误，index.html</span><br><span class="line">-rw-r--r-- 1 1001 1001   1397 Nov 16 22:44 LICENSE</span><br><span class="line">drwxr-xr-x 2 1001 1001   4096 Mar  2 03:09 man: nginx 帮助文件</span><br><span class="line">-rw-r--r-- 1 1001 1001     49 Nov 16 22:44 README：</span><br><span class="line">drwxr-xr-x 9 1001 1001   4096 Nov 16 22:44 src： nginx源代码</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"><span class="comment"># tree . -d 1</span></span><br><span class="line"></span><br><span class="line">├── auto</span><br><span class="line">│   ├── cc：用于编译</span><br><span class="line">│   ├── lib：外部目录</span><br><span class="line">│   │   ├── geoip</span><br><span class="line">│   │   ├── google-perftools</span><br><span class="line">│   │   ├── libatomic</span><br><span class="line">│   │   ├── libgd</span><br><span class="line">│   │   ├── libxslt</span><br><span class="line">│   │   ├── openssl</span><br><span class="line">│   │   ├── pcre</span><br><span class="line">│   │   ├── perl</span><br><span class="line">│   │   └── zlib</span><br><span class="line">│   ├── os: 操作系统判断</span><br><span class="line">│   └── types</span><br><span class="line">├── conf: 配置文件示意</span><br><span class="line">├── contrib</span><br><span class="line">│   ├── unicode2nginx</span><br><span class="line">│   └── vim</span><br><span class="line">│       ├── ftdetect</span><br><span class="line">│       ├── ftplugin</span><br><span class="line">│       ├── indent</span><br><span class="line">│       └── syntax</span><br><span class="line">├── html</span><br><span class="line">├── man</span><br><span class="line">└── src</span><br><span class="line">    ├── core</span><br><span class="line">    ├── event</span><br><span class="line">    │   └── modules</span><br><span class="line">    ├── http</span><br><span class="line">    │   ├── modules</span><br><span class="line">    │   │   └── perl</span><br><span class="line">    │   └── v2</span><br><span class="line">    ├── mail</span><br><span class="line">    ├── misc</span><br><span class="line">    ├── os</span><br><span class="line">    │   └── unix</span><br><span class="line">    └── stream</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>tips</p>
                                    <p>将 contrib 中的文件夹copy 到vim目录下，以便于使用vim对配置文件等进行便捷的编辑，如下command</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">DIR=<span class="string">"ftdetect ftplugin indent syntax"</span></span><br><span class="line"><span class="keyword">for</span> dir <span class="keyword">in</span> <span class="variable">$DIR</span>; <span class="keyword">do</span></span><br><span class="line">	mkdir -p ~/.vim/<span class="variable">$&#123;dir&#125;</span></span><br><span class="line">  cp -r contrib/vim/<span class="variable">$&#123;dir&#125;</span>/nginx.vim ~/.vim/<span class="variable">$&#123;dir&#125;</span>/nginx.vim</span><br><span class="line"><span class="keyword">done</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h2>
                                    <h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3>
                                    <ul>
                                        <li>配置文件由指令与指令块构成</li>
                                        <li>每条指令以<code>;</code> 结尾，指令与参数之间以空格符号分割</li>
                                        <li>指令块以<code>{}</code> 将多条指令组织在一起</li>
                                        <li>include语句允许组合多个配置文件，提升可维护性</li>
                                        <li><code>#</code>: 实现注释</li>
                                        <li><code>$</code>:使用变量</li>
                                        <li>部分指令支持regexp， 如路径匹配等</li>
                                    </ul>
                                    <h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3>
                                    <p><strong>时间</strong></p>
                                    <ul>
                                        <li>ms: MilliSeconds</li>
                                        <li>s: Seconds</li>
                                        <li>m: minutes</li>
                                        <li>h: hours</li>
                                        <li>d: days</li>
                                        <li>w: weeks</li>
                                        <li>m: months</li>
                                        <li>years</li>
                                    </ul>
                                    <p><strong>存储空间</strong></p>
                                    <p>bytes (default)</p>
                                    <p>k/K: kilobytes</p>
                                    <p>m/M: megabytes</p>
                                    <p>g/G: gigabytes</p>
                                    <h3 id="配置指令块"><a href="#配置指令块" class="headerlink" title="配置指令块"></a>配置指令块</h3>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1gzv0wsgmh8j20va0kzwfu.jpg" alt="image-20220302040819009" style="zoom:50%;" /></p>
                                    <p>http: 表示所有的指令都是http解析的</p>
                                    <figure class="highlight nginx">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">	<span class="attribute">include</span> mine.types</span><br><span class="line">  <span class="comment"># 上游服务</span></span><br><span class="line">	upstream thwp &#123;</span><br><span class="line">		<span class="attribute">server</span> <span class="number">127.0.0.1:8080</span></span><br><span class="line">	&#125;</span><br><span class="line">  <span class="comment"># (一组)域名</span></span><br><span class="line">  server &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span> </span><br><span class="line">    location ～*.(gif|jpg|jpeg)$ &#123;</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="配置实践"><a href="#配置实践" class="headerlink" title="配置实践"></a>配置实践</h3>
                                    <p><strong>配置upstream</strong></p>
                                    <figure class="highlight nginx">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">  // proxycluster: 服务组名字</span><br><span class="line">  <span class="attribute">upstream</span> proxycluster &#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">10.21.200.101:8081</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">10.21.200.121:8081</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">10.21.200.111:8081</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">10.21.200.191:8081</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="section">server</span> &#123;</span><br><span class="line">		<span class="attribute">listen</span> <span class="number">8081</span>;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> http://proxycluster;</span><br><span class="line">    <span class="attribute">auth_basic</span> <span class="string">"Restricted"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>weight=number: 服务器的权重值，默认是1；</p>
                                    <p>max_conns=number: 设置允许的最大活动连接数。默认是0，表示不限制。（设置<code>keepalive</code>时，如果有多个worker共享内存，则连接数可能会超过设置的值）</p>
                                    <p>max_fails=number: 设置在<code>fail_timeout</code>参数设置的时间段内允许的失败最大尝试次数，默认是1，设置0表示失败不会尝试。</p>
                                    <p>fail_timeout=time: <code>fail_timeout</code>的值包含两层意思：</p>
                                    <ol>
                                        <li>
                                            <p>在这个时间段内服务器通信失败次数决定服务状态是否为不可用；</p>
                                        </li>
                                        <li>
                                            <p>服务器被视为不可用状态的时间段。默认是10秒。</p>
                                        </li>
                                    </ol>
                                    <p>backup: 标记服务器是备用服务器，只有在其他服务器都不可用的情况下，才会请求该服务器。（在哈希、IP哈希、随机三种负载均衡模式下不可用）</p>
                                    <p>down: 标记服务器永久不可用状态。</p>
                                    <p><a href="https://developer.aliyun.com/article/753379" target="_blank" rel="noopener">正则表达式匹配路由</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-03-02 02:19:16" itemprop="dateCreated datePublished" datetime="2022-03-02T02:19:16+08:00">2022-03-02</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.7k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>2 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3675738859.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> go <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3675738859.html" class="post-title-link" itemprop="url">go语言相关资料</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="Book"><a href="#Book" class="headerlink" title="Book"></a>Book</h2>
                                    <blockquote>
                                        <p><a href="https://github.com/golang/go/wiki/Books" target="_blank" rel="noopener">官方wiki</a></p>
                                    </blockquote>
                                    <h3 id="经典书籍"><a href="#经典书籍" class="headerlink" title="经典书籍"></a>经典书籍</h3>
                                    <p>《The Way To Go》- Go 语言百科全书</p>
                                    <p><a href="https://go101.org/article/101.html" target="_blank" rel="noopener">《Go 101》- Go 语言参考手册</a></p>
                                    <p>《Go 语言学习笔记》- Go 源码剖析与实现原理探索</p>
                                    <p>《Go 语言实战》- 实战系列经典之作，紧扣 Go 语言的精华</p>
                                    <p>《Go 程序设计语言》- 人手一本的 Go 语言“圣经”</p>
                                    <p><a href="https://github.com/chai2010/go-ast-book" target="_blank" rel="noopener">《Go语法树入门——开启自制编程语言和编译器之旅》</a></p>
                                    <p><a href="https://gocompiler.shizhz.me/" target="_blank" rel="noopener">《golang编译器代码解析》</a></p>
                                    <h3 id="值得一读"><a href="#值得一读" class="headerlink" title="值得一读"></a>值得一读</h3>
                                    <p>《go语言精进之路》(全两册)—白明</p>
                                    <p><a href="https://chai2010.cn/advanced-go-programming-book/" target="_blank" rel="noopener">《Go语言高级编程》</a></p>
                                    <p>《go语言底层原理剖析》</p>
                                    <p>《go语言并发之道》</p>
                                    <h3 id="在线图书"><a href="#在线图书" class="headerlink" title="在线图书"></a>在线图书</h3>
                                    <p><a href="https://draveness.me/golang/" target="_blank" rel="noopener">《go语言设计与实现》</a></p>
                                    <p><a href="https://golang.design/under-the-hood/" target="_blank" rel="noopener">《go语言原本》</a></p>
                                    <p><a href="https://gocompiler.shizhz.me/" target="_blank" rel="noopener">《Golang 编译器》</a></p>
                                    <p><a href="https://geektutu.com/post/high-performance-go.html" target="_blank" rel="noopener">《Go 语言高性能编程》</a></p>
                                    <p><a href="https://quii.gitbook.io/learn-go-with-tests" target="_blank" rel="noopener">《learn-go-with-tests》</a></p>
                                    <p><a href="https://chai2010.cn/go2-book/" target="_blank" rel="noopener">《go2》</a></p>
                                    <p><a href="https://greyireland.gitbook.io/algorithm-pattern/" target="_blank" rel="noopener">《algorithm-pattern》</a></p>
                                    <p><a href="https://www.topgoer.com/" target="_blank" rel="noopener">go语言地鼠文档</a></p>
                                    <p><a href="https://www.topgoer.cn/" target="_blank" rel="noopener">地鼠文档</a></p>
                                    <blockquote>
                                        <p>仅个人见解</p>
                                    </blockquote>
                                    <h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2>
                                    <p>官方文档：项目主线分支（master）上最新开发版本的文档：</p>
                                    <ul>
                                        <li>
                                            <p><a href="https://tip.golang.org/" target="_blank" rel="noopener">The Go Programming Language (golang.org)</a></p>
                                        </li>
                                        <li>
                                            <p><a href="https://go.dev/" target="_blank" rel="noopener">The Go Programming Language</a></p>
                                        </li>
                                    </ul>
                                    <p><a href="https://go.dev/ref/spec" target="_blank" rel="noopener">Go语言规范 The Go Programming Language Specification - The Go Programming Language</a></p>
                                    <p><a href="https://go.dev/ref/mod" target="_blank" rel="noopener">Go mod参考文档 Go Modules Reference - The Go Programming Language</a></p>
                                    <p><a href="https://go.dev/doc/cmd" target="_blank" rel="noopener">Go语言命令参考手册 Command Documentation - The Go Programming Language</a></p>
                                    <p><a href="https://go.dev/doc/effective_go" target="_blank" rel="noopener">Effective Go Effective Go - The Go Programming Language</a></p>
                                    <p><a href="https://pkg.go.dev" target="_blank" rel="noopener">Go语言标准库参考手册</a></p>
                                    <p><a href="https://go.dev/doc/faq" target="_blank" rel="noopener">go 常见问答 Frequently Asked Questions (FAQ) - The Go Programming Language</a></p>
                                    <h2 id="相关博客"><a href="#相关博客" class="headerlink" title="相关博客"></a>相关博客</h2>
                                    <p><a href="https://go.dev/blog/" target="_blank" rel="noopener">Go语言官方博客 The Go Blog - The Go Programming Language</a></p>
                                    <p><a href="https://commandcenter.blogspot.com/" target="_blank" rel="noopener">Go 语言之父 Rob Pike 的个人博客 command center</a></p>
                                    <p><a href="https://research.swtch.com/" target="_blank" rel="noopener">Go 核心团队技术负责人 Russ Cox 的个人博客</a></p>
                                    <p><a href="https://commaok.xyz/" target="_blank" rel="noopener">Go 核心开发者 Josh Bleecher Snyder 的个人博客 Don’t Panic (commaok.xyz)</a></p>
                                    <p><a href="https://rakyll.org/" target="_blank" rel="noopener">Go 核心团队前成员 Jaana Dogan 的个人博客</a></p>
                                    <p><a href="https://dave.cheney.net/" target="_blank" rel="noopener">Go 鼓吹者 Dave Cheney 的个人博客</a></p>
                                    <p><a href="https://www.ardanlabs.com/blog" target="_blank" rel="noopener">Go 语言培训机构 Ardan Labs 的博客</a></p>
                                    <p><a href="https://gocn.vip/" target="_blank" rel="noopener">GoCN社区</a></p>
                                    <p><a href="https://golang.design/" target="_blank" rel="noopener">Go 语言百科全书 The golang.design Initiative</a></p>
                                    <p><a href="https://go-review.googlesource.com/" target="_blank" rel="noopener">Go 项目的代码 review 站点</a></p>
                                    <h2 id="技术演讲"><a href="#技术演讲" class="headerlink" title="技术演讲"></a>技术演讲</h2>
                                    <p><a href="https://go.dev/talks/" target="_blank" rel="noopener">Go 官方的技术演讲归档 talks - The Go Programming Language</a></p>
                                    <p><a href="https://www.youtube.com/c/GopherAcademy/playlists" target="_blank" rel="noopener">GopherCon 技术大会</a></p>
                                    <p><a href="https://www.youtube.com/c/GopherConEurope/playlists" target="_blank" rel="noopener">GopherCon Europe 技术大会 GopherCon Europe - YouTube</a></p>
                                    <p><a href="https://www.youtube.com/c/GopherConUK/playlists" target="_blank" rel="noopener">GopherConUK 技术大会 GopherCon UK - YouTube</a></p>
                                    <p><a href="https://www.youtube.com/channel/UCMEvzoHTIdZI7IM8LoRbLsQ/playlists" target="_blank" rel="noopener">GoLab 技术大会 GoLab conference - YouTube</a></p>
                                    <p><a href="https://www.youtube.com/user/fosdemtalks/playlists" target="_blank" rel="noopener">Go Devroom@FOSDEM FOSDEM - YouTube</a></p>
                                    <p><a href="https://space.bilibili.com/436361287" target="_blank" rel="noopener">GopherChina技术大会</a></p>
                                    <p><a href="https://space.bilibili.com/326749661" target="_blank" rel="noopener">Go夜读</a></p>
                                    <h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2>
                                    <p><a href="https://github.com/Tencent/secguide" target="_blank" rel="noopener">代码安全指南</a></p>
                                    <p><a href="https://studygolang.com/pkgdoc" target="_blank" rel="noopener">Go语言标准库文档中文版</a></p>
                                    <p><a href="https://www.topgoer.com/开源/go学习线路图.html" target="_blank" rel="noopener">go学习线路图 · Go语言中文文档 (topgoer.com)</a></p>
                                    <p><a href="https://gobyexample.com/" target="_blank" rel="noopener">gobyexample</a></p>
                                    <p><a href="https://github.com/uber-go/guide/blob/master/style.md" target="_blank" rel="noopener">Uber代码规范</a></p>
                                    <p><a href="https://github.com/xxjwxc/uber_go_guide_cn" target="_blank" rel="noopener">Uber Go 语言编码规范中文版</a></p>
                                    <p><a href="https://github.com/avelino/awesome-go" target="_blank" rel="noopener">awesome-go</a></p>
                                    <p><a href="https://github.com/moby/moby" target="_blank" rel="noopener">Moby Project - a collaborative project for the container ecosystem to assemble container-based systems</a></p>
                                    <h3 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h3>
                                    <p>《Go设计模式》：</p>
                                    <p>-<a href="http://tmrts.com/go-patterns/" target="_blank" rel="noopener">Go Patterns · GitBook (tmrts.com)</a></p>
                                    <p>-<a href="https://www.topgoer.cn/docs/golang-design-pattern" target="_blank" rel="noopener">golang-design-pattern</a></p>
                                    <p>设计模式Golang实现：<a href="https://github.com/senghoo/golang-design-pattern" target="_blank" rel="noopener">设计模式 Golang实现－《研磨设计模式》</a></p>
                                    <h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3>
                                    <p><a href="https://books.halfrost.com/leetcode/" target="_blank" rel="noopener">leetcode cookbook</a></p>
                                    <p>algorithms：</p>
                                    <ul>
                                        <li><a href="https://the-algorithms.com/" target="_blank" rel="noopener">https://the-algorithms.com/</a></li>
                                        <li><a href="https://github.com/TheAlgorithms" target="_blank" rel="noopener">https://github.com/TheAlgorithms</a></li>
                                    </ul>
                                    <p><a href="https://api.github.com/search/repositories?q=language:go&amp;per_page=100" target="_blank" rel="noopener">Github Top 100</a></p>
                                    <p><a href="https://github.com/jiujuan/go-collection" target="_blank" rel="noopener">go-collection</a></p>
                                    <h2 id="referer"><a href="#referer" class="headerlink" title="referer"></a>referer</h2>
                                    <p>Go语言第一课 — 白明</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h0j4gn2m15j21hc0t3die.jpg" alt="image-20220323002441627"></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-02-26 15:44:03" itemprop="dateCreated datePublished" datetime="2022-02-26T15:44:03+08:00">2022-02-26</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.6k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/532288655.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Apache Kafka <i class="label-arrow"></i>
                                    </a>
                                    <a href="/532288655.html" class="post-title-link" itemprop="url">Apache Kafka认识</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>官方网址：<a href="https://kafka.apache.org/" target="_blank" rel="noopener">kafka.apache.org</a></p>
                                    <p>Mirror of Apache Kafka github: <a href="https://github.com/apache/kafka" target="_blank" rel="noopener">https://github.com/apache/kafka</a></p>
                                    <h2 id="什么是Kafka"><a href="#什么是Kafka" class="headerlink" title="什么是Kafka"></a>什么是Kafka</h2>
                                    <p>Apache Kafka 是一款开源的<strong>消息引擎</strong>系统, 也是一个分布式流处理平台（Distributed Streaming Platform）</p>
                                    <ul>
                                        <li>处理实时数据提供一个统一、高吞吐、低延迟的平台。</li>
                                        <li>它使用的是纯二进制的字节序列, 以时间复杂度为 O(1) 的方式提供消息持久化能力，即使对 TB 级以上数据也能保证常数时间复杂度的访问性能。</li>
                                        <li>高吞吐率。即使在非常廉价的商用机器上也能做到单机支持每秒 100K 条以上消息的传输。</li>
                                        <li>支持 Kafka Server 间的消息分区，及分布式消费，同时保证每个 Partition 内的消息顺序传输。</li>
                                        <li>同时支持离线数据处理和实时数据处理。</li>
                                        <li>Scale out：支持在线水平扩展。</li>
                                    </ul>
                                    <h2 id="Kafka功能"><a href="#Kafka功能" class="headerlink" title="Kafka功能"></a>Kafka功能</h2>
                                    <blockquote>
                                        <p>削峰填谷解耦合</p>
                                    </blockquote>
                                    <h2 id="KafKa传输模型"><a href="#KafKa传输模型" class="headerlink" title="KafKa传输模型"></a>KafKa传输模型</h2>
                                    <p>Kfaka有两种传输模型，分别是基于一对一、多对多的思想。</p>
                                    <p>一对一：一般也称之为消息队列模型，系统 A 发送的消息只能被系统 B 接收，其他任何系统都不能读取 A 发送的消息。</p>
                                    <p>多对多：一般称之为发布订阅模型。与上面不同的是，它有一个<strong>主题（Topic）</strong><br>的概念，该模型也有发送方和接收方，只不过提法不同。发送方也称为发布者（Publisher）接收方称为订阅者（Subscriber）。和点对点模型不同的是，这个模型可能存在多个发布者向相同的主题发送消息，而订阅者也可能存在多个，它们都能接收到<strong><br>相同主题</strong>的消息。</p>
                                    <h2 id="Kafka术语"><a href="#Kafka术语" class="headerlink" title="Kafka术语"></a>Kafka术语</h2>
                                    <h3 id="message"><a href="#message" class="headerlink" title="message"></a>message</h3>
                                    <p>主题（Topic）：在 Kafka 中，发布订阅的对象是主题（Topic），你可以为每个业务、每个应用甚至是每类数据都创建专属的主题。</p>
                                    <p>分区（Partitioning）：将每个主题划分成多个分区（Partition），每个分区是一组有序的消息日志。生产者生产的每条消息只会被发送到一个分区中</p>
                                    <p>消息（Record）：Kafka 是消息引擎，这里的消息就是指 Kafka 处理的主要对象。</p>
                                    <h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3>
                                    <p><strong>生产者（Producer）</strong></p>
                                    <p>向主题发布消息的客户端应用程序，生产者程序通常持续不断地向一个或多个主题发送消息。</p>
                                    <p><strong>消费者（Consumer）</strong></p>
                                    <p>订阅这些主题消息的客户端应用程序。和生产者类似，消费者也能够同时订阅多个主题的消息。</p>
                                    <p><strong>消费者组（Consumer Group）</strong></p>
                                    <p>多个消费者实例共同组成的一个组，同时消费多个分区以实现高吞吐。</p>
                                    <p><strong>消费者实例（Consumer Instance）</strong></p>
                                    <p>运行消费者应用的进程，也可以是一个线程。</p>
                                    <h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3>
                                    <p><strong>Broker</strong></p>
                                    <p>Kafka 的服务器端由被称为 Broker 的服务进程构成，即一个 Kafka 集群由多个 Broker 组成，Broker 负责接收和处理客户端发送过来的请求，以及对消息进行持久化。虽然多个 Broker<br>进程能够运行在同一台机器上，但更常见的做法是将不同的 Broker 分散运行在不同的机器上，这样如果集群中某一台机器宕机，即使在它上面运行的所有 Broker 进程都挂掉了，其他机器上的 Broker 也依然能够对外提供服务。</p>
                                    <p><strong>Replication</strong></p>
                                    <p>把相同的数据拷贝到多台机器上，而这些相同的数据拷贝在 Kafka 中被称为副本（Replica）</p>
                                    <p>副本的数量是可以配置的，这些副本保存着相同的数据，但却有不同的角色和作用。</p>
                                    <p>Kafka 定义了两类副本：</p>
                                    <ul>
                                        <li>领导者副本（Leader Replica）：对外提供服务，这里的对外指的是与客户端程序进行交互；</li>
                                        <li>追随者副本（Follower Replica）：被动地追随领导者副本，不能与外界进行交互。</li>
                                    </ul>
                                    <p><strong>重平衡（Rebalance）</strong></p>
                                    <p>消费者组内某个消费者实例挂掉后，其他消费者实例自动重新分配订阅主题分区的过程。Rebalance 是 Kafka 消费者端实现高可用的重要手段。</p>
                                    <p><strong>消费者位移（Consumer Offset）</strong></p>
                                    <p>表征消费者消费进度，每个消费者都有自己的消费者位移。</p>
                                    <p><img src="https://static001.geekbang.org/resource/image/58/91/58c35d3ab0921bf0476e3ba14069d291.jpg" alt=""></p>
                                    <p><img src="https://upload.wikimedia.org/wikipedia/commons/6/64/Overview_of_Apache_Kafka.svg" alt=""></p>
                                    <h2 id="为什么需要使用消息系统"><a href="#为什么需要使用消息系统" class="headerlink" title="为什么需要使用消息系统"></a>为什么需要使用消息系统</h2>
                                    <p>解耦: 消息系统在处理过程中插入了一个隐含的,基于数据接口, 两边的处理过程都要实现这一接口.这允许独立拓展或修改两边的处理过程. 只要确保他们遵循同样的接口约束</p>
                                    <p>而基于消息发布订阅的机制, 可以联动多个业务下流子系统,能够不侵入的情况下的情况下分布编排和开发,来保证数据一致性</p>
                                    <p>冗余:</p>
                                    <p>有些情况下,处理数据的过程中会失败.除非数据被持久化,否则将造成丢失.消息队列吧数据进行持久化直到已经完全被处理, 通过这一方式可规避数据丢失,许多消息队列所采用的”插入-获取-删除”<br>的范式,把一个消息从队列中删除之前,需要处理系统明确指出该消息已经被完全处理完毕, 从而确保你的数据被安全的保存直到使用完毕</p>
                                    <p>拓展:</p>
                                    <p>消息解耦了处理过程, 所以增大消息入队和处理的频率是简单的,只需要在对应的端加速处理即可. 无需修改代码,修改参数,扩展非常简单</p>
                                    <p>灵活 &amp; 峰值处理能力</p>
                                    <p>在访问量剧增的情况下, 应用仍然需要继续发挥作用,但这样的突发流量并不常见; 如果对此特定时间为标准投入资源,无疑是巨大的浪费. 使用消息队列能使关键组件顶住突发的压力,而不是因为突发的超负荷的请求完全崩溃</p>
                                    <p>可恢复性</p>
                                    <p>系统的一部分组件失效时,不会影响到整个系统. 消息队列降低了进程间的耦合度, 即使一个处理消息的进程挂掉,加入队列中的消息仍然可以在恢复后被处理</p>
                                    <p>顺序</p>
                                    <p>在大多使用厂家下,数据处理的顺序都很重要. 大部分消息队列本来就是排序的,并且能保证数据按照特定的顺序来处理. kafka保证一个Partition内的消息有序性</p>
                                    <p>缓冲</p>
                                    <p>在任何重要的系统中,都会有需要不同的处理时间因素, 消息队列通过一个缓冲层来帮助业务最高效的执行-写入队列的处理尽可能的快速. 缓冲有助于控制和优化数据流和系统的速度</p>
                                    <p>异步通讯</p>
                                    <p>很多时候并不需要立即处理消息,而消息队列提供了异步处理机制, 允许将消息放入到队列,但不立即处理它. 只需要到一定的时间点处理即可</p>
                                    <h2 id="referer"><a href="#referer" class="headerlink" title="referer"></a>referer</h2>
                                    <p><a href="https://time.geekbang.org/column/intro/100029201" target="_blank" rel="noopener">Kafka 核心技术与实战</a></p>
                                    <p><a href="https://zhuanlan.zhihu.com/p/74063251" target="_blank" rel="noopener">Kafka【入门】就这一篇！ - 知乎 (zhihu.com)</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-02-26 13:32:01" itemprop="dateCreated datePublished" datetime="2022-02-26T13:32:01+08:00">2022-02-26</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>2.4k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>2 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/71891257.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> git <i class="label-arrow"></i>
                                    </a>
                                    <a href="/71891257.html" class="post-title-link" itemprop="url">git 使用总结</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="git安装"><a href="#git安装" class="headerlink" title="git安装"></a>git安装</h2>
                                    <h3 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">brew install git git-lfs</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Linux-centos"><a href="#Linux-centos" class="headerlink" title="Linux(centos)"></a>Linux(centos)</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">yum install -y git git-lfs</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="git配置初始化"><a href="#git配置初始化" class="headerlink" title="git配置初始化"></a>git配置初始化</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">git config --global user.name <span class="string">"paynewu"</span></span><br><span class="line">git config --global user.email <span class="string">"wuzhipeng1289690157@gmail.com"</span></span><br><span class="line">git config --global credential.helper store</span><br><span class="line">git config --global core.longpaths <span class="literal">true</span></span><br><span class="line">git config --global core.quotepath off</span><br><span class="line">git lfs install --skip-repo</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2>
                                    <h3 id="初始化repo"><a href="#初始化repo" class="headerlink" title="初始化repo"></a>初始化repo</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 创建空的git仓库或重新初始化一个现有的仓库</span></span><br><span class="line">git init</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="添加文件到本地仓库暂存区"><a href="#添加文件到本地仓库暂存区" class="headerlink" title="添加文件到本地仓库暂存区"></a>添加文件到本地仓库暂存区</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 将文件添加到暂存区</span></span><br><span class="line">git add demofile</span><br><span class="line"><span class="comment"># 将所有文件添加到暂存区</span></span><br><span class="line">git add --all</span><br><span class="line"><span class="comment"># 保存所有改动的文件和删除的文件，不包括新的文件</span></span><br><span class="line">git add -u</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="添加到本地仓库"><a href="#添加到本地仓库" class="headerlink" title="添加到本地仓库"></a>添加到本地仓库</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 此命令代表确认提交到本地仓库。</span></span><br><span class="line">git commit -m <span class="string">'v1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将所有暂存区提交到本地仓库。</span></span><br><span class="line">git commit -am <span class="string">'v1'</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>可以使用 <code>git status</code> 查看状态</p>
                                    </blockquote>
                                    <h3 id="查看提交日志"><a href="#查看提交日志" class="headerlink" title="查看提交日志"></a>查看提交日志</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 查看日志</span></span><br><span class="line">git <span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一行展示</span></span><br><span class="line">git <span class="built_in">log</span> --pretty=oneline</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参考日志（Reference logs），记录每一次操作</span></span><br><span class="line">git relog</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 回退到上一版</span></span><br><span class="line">git reset --hard HEAD^</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回退到上上个版本</span></span><br><span class="line">git reset --hard HEAD^^</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果回退的版本过多则不用加那么多的 ^ 号 </span></span><br><span class="line"><span class="comment"># 比如回退到上 10 版本，则可以用</span></span><br><span class="line">git reset --hard HEAD~10</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回退到指定hash的分支</span></span><br><span class="line">git reset --hard <span class="built_in">hash</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="撤销修改"><a href="#撤销修改" class="headerlink" title="撤销修改"></a>撤销修改</h3>
                                    <p>总结：</p>
                                    <ul>
                                        <li>
                                            <p>场景 1：当改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令 git checkout — file。</p>
                                        </li>
                                        <li>
                                            <p>场景 2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令 git reset HEAD file，就回到了场景 1，第二步按场景 1 操作。</p>
                                        </li>
                                        <li>
                                            <p>场景 3：已经提交了不合适的修改到版本库时，想要撤销本次提交，进行版本回退，不过前提是没有推送到远程库。 8. 删除文件 假如现在你新建了一个 hello.txt 文件，你已经 add 并 commit 到了本地分支之中。<br>现在你想删除，如果直接执行</p>
                                        </li>
                                    </ul>
                                    <h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 查看本地分支</span></span><br><span class="line">git branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建本地分支</span></span><br><span class="line">git branch dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到 dev 分支</span></span><br><span class="line">git checkout dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并切换到该分支</span></span><br><span class="line">git checkout -b dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并分支</span></span><br><span class="line">git merge</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3>
                                    <figure class="highlight maxima">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">git <span class="built_in">push</span> -u <span class="built_in">origin</span> branch-name</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 增加一个标签</span></span><br><span class="line">git tag -a <span class="string">"v1.0.0"</span> -m <span class="string">"Version 1.0.0"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除一个标签</span></span><br><span class="line">git tag -d v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除远程标签</span></span><br><span class="line">git push --delete origin v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送所有标签</span></span><br><span class="line">git push origin --tags</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="删除未监视文件"><a href="#删除未监视文件" class="headerlink" title="删除未监视文件"></a>删除未监视文件</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">git clean -f</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 连 untracked 的目录也一起删掉</span></span><br><span class="line">git clean -fd</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 连 gitignore 的untrack 文件/目录也一起删掉 （慎用，一般这个是用来删掉编译出来的 .o之类的文件用的）</span></span><br><span class="line">git clean -xfd</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 在用上述 git clean 前，墙裂建议加上 -n 参数来先看看会删掉哪些文件，防止重要文件被误删</span></span><br><span class="line">git clean -nxfd</span><br><span class="line">git clean -nf</span><br><span class="line">git clean -nfd</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="子模块"><a href="#子模块" class="headerlink" title="子模块"></a>子模块</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">git <span class="built_in">clone</span> &lt;repository&gt; --recursive 递归的方式克隆整个项目</span><br><span class="line">git submodule add &lt;repository&gt; &lt;path&gt; 添加子模块</span><br><span class="line">git submodule init 初始化子模块</span><br><span class="line">git submodule update 更新子模块</span><br><span class="line">git submodule foreach git pull 拉取所有子模块</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-02-17 13:52:22" itemprop="dateCreated datePublished" datetime="2022-02-17T13:52:22+08:00">2022-02-17</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>359</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3120335305.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> VimIDE-spacevim <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3120335305.html" class="post-title-link" itemprop="url">模块化的VimIDE-spacevim</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>SpaceVim 是一个社区驱动的模块化的 Vim IDE，以模块的方式组织管理插件以及相关配置， 为不同的语言开发量身定制了相关的开发模块，该模块提供代码自动补全， 语法检查、格式化、调试、REPL 等特性。用户仅需载入相关语言的模块即可得到一个开箱即用的 Vim IDE。</p>
                                    <p>相关链接如下：</p>
                                    <p><a href="https://spacevim.org/" target="_blank" rel="noopener">官方网站</a></p>
                                    <p><a href="https://spacevim.org/cn/" target="_blank" rel="noopener">中文官方网站</a></p>
                                    <p><a href="https://github.com/SpaceVim/SpaceVim" target="_blank" rel="noopener">github</a></p>
                                    <p><a href="https://gitee.com/spacevim/SpaceVim" target="_blank" rel="noopener">gitee</a></p>
                                    <p><a href="https://spacevim.org/cn/quick-start-guide/" target="_blank" rel="noopener">入门指南</a></p>
                                    <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                                    <blockquote>
                                        <p><strong>前置条件</strong>: 需要安装完成<code>vim</code>或<code>neovim</code></p>
                                    </blockquote>
                                    <figure class="highlight mipsasm">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 前置安装</span></span><br><span class="line"><span class="comment">## centos</span></span><br><span class="line">python3 -m pip <span class="keyword">install </span>-U pip &amp;&amp; python3 -m pip <span class="keyword">install </span>pynvim &amp;&amp; pip3 <span class="keyword">install </span>neovim &amp;&amp; yum -y <span class="keyword">install </span>neovim</span><br><span class="line"><span class="comment">## Mac</span></span><br><span class="line">python3 -m pip <span class="keyword">install </span>-U pip &amp;&amp; python3 -m pip <span class="keyword">install </span>pynvim &amp;&amp; pip3 <span class="keyword">install </span>neovim &amp;&amp; <span class="keyword">brew </span><span class="keyword">install </span>neovim</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3>
                                    <p>Windows 下最快捷的安装方法是下载安装脚本 <a href="https://spacevim.org/cn/install.cmd" target="_blank" rel="noopener">install.cmd</a> 并运行。</p>
                                    <h3 id="Linux-或-macOS"><a href="#Linux-或-macOS" class="headerlink" title="Linux 或 macOS"></a>Linux 或 macOS</h3>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 配置</span></span><br><span class="line">cat &gt;&gt; /etc/profile &lt;&lt; EOF</span><br><span class="line"><span class="built_in">export</span> EDITOR=nvim</span><br><span class="line"><span class="built_in">alias</span> vim=<span class="string">"nvim"</span></span><br><span class="line">EOF</span><br><span class="line"><span class="built_in">source</span> /etc/profile/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建配置文件夹</span></span><br><span class="line">mkdir -p <span class="variable">$HOME</span>/.config</span><br><span class="line"><span class="comment"># 创建文件夹软连接</span></span><br><span class="line">ln -s <span class="variable">$HOME</span>/.vim <span class="variable">$HOME</span>/.config/nvim</span><br><span class="line"><span class="comment"># 创建配置文件软连接</span></span><br><span class="line">ln -s <span class="variable">$HOME</span>/.vimrc <span class="variable">$HOME</span>/.config/nvim/init.vim</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">curl -sLf https://spacevim.org/cn/install.sh | bash</span><br><span class="line"><span class="comment"># 如果需要获取安装脚本的帮助信息，可以执行如下命令，包括定制安装、更新和卸载等。</span></span><br><span class="line">curl -sLf https://spacevim.org/cn/install.sh | bash -s -- -h</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>安装结束后，初次打开 vim 或者 neovim 时，SpaceVim 会自动下载并安装插件。</p>
                                    <p><a href="https://github.com/marmotedu/marmotVim" target="_blank" rel="noopener">SpaceVim离线安装 (github.com)</a></p>
                                    <p>环境搭建请参考：</p>
                                    <p><a href="https://spacevim.org/cn/quick-start-guide/#在线教程" target="_blank" rel="noopener">在线教程</a></p>
                                    <p>更多sao操作情参考官方文档，瑞思拜～</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-02-16 20:36:52" itemprop="dateCreated datePublished" datetime="2022-02-16T20:36:52+08:00">2022-02-16</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>338</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3417717672.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> Go <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3417717672.html" class="post-title-link" itemprop="url">go语言中的方法</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="什么是方法"><a href="#什么是方法" class="headerlink" title="什么是方法"></a>什么是方法</h2>
                                    <p>​ 方法一般是面向对象编程(OOP)的一个特性，在cpp中方法对应一个类对象的成员函数，是关联到具体对象上的虚表中的。但是Go语言的方法却是<strong>关联到类型</strong>的，这样可以在编译阶段完成方法的静态绑定。</p>
                                    <p>​ 一个面向对象的程序会用方法来表达其属性对应的操作，这样使用这个对象的用户就不需要直接去操作对象，而是借助方法来做这些事情。面向对象编程(OOP)<br>进入主流开发领域一般认为是从cpp开始的，cpp就是在兼容C语言的基础之上支持了class等面向对象的特性。然后Java编程则号称是纯粹的面向对象语言，因为Java中函数是不能独立存在的，每个函数都必然是属于某个类的。</p>
                                    <p>面向对象编程更多的只是一种思想，很多号称支持面向对象编程的语言只是将经常用到的特性内置到语言中了而已。</p>
                                    <h2 id="方法的声明"><a href="#方法的声明" class="headerlink" title="方法的声明"></a>方法的声明</h2>
                                    <p>Go语言中的<code>方法（Method）</code>是一种作用于特定类型变量的函数。这种特定类型变量叫做<code>接收者（Receiver）</code>，其中方法接收器（receiver）参数、函数 / 方法参数，以及返回值变量对应的作用域范围，都是函数 /<br>方法体对应的显式代码块。</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(接收者变量 接收者类型(值类型或指针类型)</span>) 方法名<span class="params">(参数列表)</span> <span class="params">(返回参数)</span></span> &#123;</span><br><span class="line">    方法体</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <ul>
                                        <li>接收者变量：接收者中的参数变量名在命名时，官方建议使用接收者类型名称首字母的小写，而非<code>self</code>、<code>this</code>之类的命名。例如，<code>Person</code>类型的接收者变量应该命名为 <code>p</code>，<code>Connector</code>类型的接收者变量应该命名为<code>c</code><br>等。</li>
                                        <li>接收者类型：接收者类型和参数类似，可以是指针类型和非指针类型。</li>
                                        <li>方法名、参数列表、返回参数：具体格式与函数定义相同。</li>
                                    </ul>
                                    <p>一个简单的例子</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> people <span class="keyword">struct</span> &#123;</span><br><span class="line">	name             <span class="keyword">string</span></span><br><span class="line">	age              <span class="keyword">uint16</span></span><br><span class="line">	height           <span class="keyword">float32</span></span><br><span class="line">	weight           <span class="keyword">float32</span></span><br><span class="line">	hometown         <span class="keyword">string</span></span><br><span class="line">	currentResidence <span class="keyword">string</span></span><br><span class="line">	lifeMotto        <span class="keyword">string</span></span><br><span class="line">	Hobby            <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">	Job              <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newPeople</span><span class="params">(name <span class="keyword">string</span>, age <span class="keyword">uint16</span>, height <span class="keyword">float32</span>, weight <span class="keyword">float32</span>, hometown <span class="keyword">string</span>, currentResidence <span class="keyword">string</span>, lifeMotto <span class="keyword">string</span>, hobby <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, job <span class="keyword">string</span>)</span> *<span class="title">people</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;people&#123;</span><br><span class="line">		name:             name,</span><br><span class="line">		age:              age,</span><br><span class="line">		height:           height,</span><br><span class="line">		weight:           weight,</span><br><span class="line">		hometown:         hometown,</span><br><span class="line">		currentResidence: currentResidence,</span><br><span class="line">		lifeMotto:        lifeMotto,</span><br><span class="line">		Hobby:            hobby,</span><br><span class="line">		Job:              job,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	people := newPeople(</span><br><span class="line">		<span class="string">`Payne`</span>,</span><br><span class="line">		<span class="number">23</span>,</span><br><span class="line">		<span class="number">1.767</span>,</span><br><span class="line">		<span class="number">75</span>,</span><br><span class="line">		<span class="string">`HuNan`</span>,</span><br><span class="line">		<span class="string">`ShangHai`</span>,</span><br><span class="line">		<span class="string">`stay hungry,stay foolish`</span>,</span><br><span class="line">		<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">			<span class="string">`first`</span>: <span class="string">`reading`</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="string">`data engineer`</span>,</span><br><span class="line">	)</span><br><span class="line">	fmt.Println(people)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="接收者"><a href="#接收者" class="headerlink" title="接收者"></a>接收者</h3>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">//方法(值类型接受者)</span></span><br><span class="line"><span class="comment">//	当方法作用于值类型接收者时，Go语言会在代码运行时将接收者的值复制一份。</span></span><br><span class="line"><span class="comment">// 	在值类型接收者的方法中可以获取接收者的成员值，但修改操作只是针对副本，无法修改接收者变量本身。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p people)</span> <span class="title">introduce</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	fmt.Println(p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法(指针类型接受者)</span></span><br><span class="line"><span class="comment">// 	指针类型的接收者由一个结构体的指针组成，由于指针的特性，</span></span><br><span class="line"><span class="comment">// 	调用方法时修改接收者指针的任意成员变量，在方法结束后，修改都是有效的。</span></span><br><span class="line"><span class="comment">// 	这种方式就十分接近于其他语言中面向对象中的this或者self。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *people)</span> <span class="title">introduceMe</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	fmt.Println(p)</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="什么时候应该使用指针类型接收者"><a href="#什么时候应该使用指针类型接收者" class="headerlink" title="什么时候应该使用指针类型接收者"></a>什么时候应该使用指针类型接收者</h3>
                                    <ol>
                                        <li>需要修改接收者中的值</li>
                                        <li>接收者是拷贝代价比较大的大对象</li>
                                        <li>保证一致性，如果有某个方法使用了指针接收者，那么其他的方法也应该使用指针接收者。</li>
                                    </ol>
                                    <h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2>
                                    <h3 id="构造函数优化"><a href="#构造函数优化" class="headerlink" title="构造函数优化"></a>构造函数优化</h3>
                                    <p>在上面的例子中发现过多的参数，这个写法乍看之下是没啥问题的，但是一旦 people 结构内部的字段发生了变化，增加或者减少了，那么这个初始化函数 newPeople 就怎么看都觉的别扭了。</p>
                                    <p>​ 如果参数继续增加呢？那么所有调用了这个 newPeople 方法的地方也都需要进行修改，且按照代码整洁的逻辑，参数多于 5 个，这个函数就很难使用了。而且，如果这 5 个参数都是可有可无的参数，就是有的参数可以不填写，</p>
                                    <p>有默认值，比如 age 这个字段，即使我们不填写，在后续的业务逻辑中可能也没有很多影响，那么我在实际调用 newPeople 的时候，age 这个字段还需要传递 0 值, 以及hometown为空值，那么构造方法newPeople如下所示</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">people := newPeople(</span><br><span class="line">		<span class="string">`Payne`</span>,</span><br><span class="line">		<span class="number">0</span>,</span><br><span class="line">		<span class="number">1.767</span>,</span><br><span class="line">		<span class="number">75</span>,</span><br><span class="line">		<span class="string">``</span>,</span><br><span class="line">		<span class="string">`ShangHai`</span>,</span><br><span class="line">		<span class="string">`stay hungry,stay foolish`</span>,</span><br><span class="line">		<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">			<span class="string">`first`</span>: <span class="string">`reading`</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="string">`data engineer`</span>,</span><br><span class="line">	)</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>乍看这行代码，你可能会以为我创建了一个 people，它的年龄为 0以及hometown为空值，但是实际上我们是希望表达这里使用了一个“缺省值”，这种代码的语义逻辑就不对了。那改怎么如何呢？</p>
                                    <h3 id="请使用options写法"><a href="#请使用options写法" class="headerlink" title="请使用options写法"></a>请使用options写法</h3>
                                    <p>options 为可选参数，以上面的代码为例，我们只需<code>name</code>, <code>age</code>,<code>job</code> 为必选，其他为可选参数的，那此时可以这么写，如下所示</p>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> people <span class="keyword">struct</span> &#123;</span><br><span class="line">	name             <span class="keyword">string</span></span><br><span class="line">	age              <span class="keyword">uint16</span></span><br><span class="line">	height           <span class="keyword">float32</span></span><br><span class="line">	weight           <span class="keyword">float32</span></span><br><span class="line">	hometown         <span class="keyword">string</span></span><br><span class="line">	currentResidence <span class="keyword">string</span></span><br><span class="line">	lifeMotto        <span class="keyword">string</span></span><br><span class="line">	Hobby            <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">	Job              <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// peopleOptions 可选参数</span></span><br><span class="line"><span class="keyword">type</span> peopleOptions <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withHeight</span><span class="params">(height <span class="keyword">float32</span>)</span> <span class="title">peopleOptions</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span> &#123;</span><br><span class="line">		p.height = height</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withWeight</span><span class="params">(weight <span class="keyword">float32</span>)</span> <span class="title">peopleOptions</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span> &#123;</span><br><span class="line">		p.weight = weight</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withHometown</span><span class="params">(hometown <span class="keyword">string</span>)</span> <span class="title">peopleOptions</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span> &#123;</span><br><span class="line">		p.hometown = hometown</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withCurrentResidence</span><span class="params">(currentResidence <span class="keyword">string</span>)</span> <span class="title">peopleOptions</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span> &#123;</span><br><span class="line">		p.currentResidence = currentResidence</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withLifeMotto</span><span class="params">(lifeMotto <span class="keyword">string</span>)</span> <span class="title">peopleOptions</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span> &#123;</span><br><span class="line">		p.lifeMotto = lifeMotto</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">withHobby</span><span class="params">(Hobby <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span> <span class="title">peopleOptions</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(p *people)</span></span> &#123;</span><br><span class="line">		p.Hobby = Hobby</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="comment">// 必选: name, age, job</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newPeopleOptions</span><span class="params">(name <span class="keyword">string</span>, age <span class="keyword">uint16</span>, job <span class="keyword">string</span>, options ...peopleOptions)</span> *<span class="title">people</span></span> &#123;</span><br><span class="line">	p := &amp;people&#123;</span><br><span class="line">		name: name,</span><br><span class="line">		age:  age,</span><br><span class="line">		Job:  job,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> _, option := <span class="keyword">range</span> options &#123;</span><br><span class="line">		option(p)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法(值类型接受者)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p people)</span> <span class="title">introduce</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法(指针类型接受者)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *people)</span> <span class="title">introduceMe</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	people := newPeopleOptions(</span><br><span class="line">		<span class="string">`Payne`</span>,</span><br><span class="line">		<span class="number">21</span>,</span><br><span class="line">		<span class="string">`data engineer`</span>,</span><br><span class="line">		withHeight(<span class="number">1.767</span>),</span><br><span class="line">	)</span><br><span class="line">	people.introduce()</span><br><span class="line">	<span class="comment">//people.introduceMe()</span></span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>其中with代表可选的， 如果我们后续 Foo 多了一个可变属性，那么我们只需要多一个 WithXXX 的方法就可以了，而 NewFoo 函数不需要任何变化，调用方只要在指定这个可变属性的地方增加 WithXXX 就可以了，扩展性非常好。</p>
                                    <h2 id="源码赏析"><a href="#源码赏析" class="headerlink" title="源码赏析"></a>源码赏析</h2>
                                    <p>以下是go爬虫框架<code>colly</code>的初始化部分，大致结构如下</p>
                                    <ul>
                                        <li>
                                            <p>可选函数类型：<code>CollectorOption func(*Collector)</code></p>
                                        </li>
                                        <li>
                                            <p>采集器结构体：<code>Collector</code></p>
                                        </li>
                                        <li>
                                            <p>初始化方法：<code>Init</code></p>
                                        </li>
                                        <li>
                                            <p>虚拟环境处理方法：<code>parseSettingsFromEnv</code></p>
                                        </li>
                                        <li>
                                            <p>构造函数:<code>NewCollector</code></p>
                                        </li>
                                    </ul>
                                    <blockquote>
                                        <p>gocolly/colly.go</p>
                                    </blockquote>
                                    <figure class="highlight go">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment">// A CollectorOption sets an option on a Collector.</span></span><br><span class="line"><span class="keyword">type</span> CollectorOption <span class="function"><span class="keyword">func</span><span class="params">(*Collector)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Collector provides the scraper instance for a scraping job</span></span><br><span class="line"><span class="keyword">type</span> Collector <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// UserAgent is the User-Agent string used by HTTP requests</span></span><br><span class="line">	UserAgent <span class="keyword">string</span></span><br><span class="line">	<span class="comment">// MaxDepth limits the recursion depth of visited URLs.</span></span><br><span class="line">	<span class="comment">// Set it to 0 for infinite recursion (default).</span></span><br><span class="line">	MaxDepth <span class="keyword">int</span></span><br><span class="line">	<span class="comment">// AllowedDomains is a domain whitelist.</span></span><br><span class="line">	<span class="comment">// Leave it blank to allow any domains to be visited</span></span><br><span class="line">	AllowedDomains []<span class="keyword">string</span></span><br><span class="line">	<span class="comment">// DisallowedDomains is a domain blacklist.</span></span><br><span class="line">	DisallowedDomains []<span class="keyword">string</span></span><br><span class="line">	<span class="comment">// DisallowedURLFilters is a list of regular expressions which restricts</span></span><br><span class="line">	<span class="comment">// visiting URLs. If any of the rules matches to a URL the</span></span><br><span class="line">	<span class="comment">// request will be stopped. DisallowedURLFilters will</span></span><br><span class="line">	<span class="comment">// be evaluated before URLFilters</span></span><br><span class="line">	<span class="comment">// Leave it blank to allow any URLs to be visited</span></span><br><span class="line">	DisallowedURLFilters []*regexp.Regexp</span><br><span class="line">	<span class="comment">// URLFilters is a list of regular expressions which restricts</span></span><br><span class="line">	<span class="comment">// visiting URLs. If any of the rules matches to a URL the</span></span><br><span class="line">	<span class="comment">// request won't be stopped. DisallowedURLFilters will</span></span><br><span class="line">	<span class="comment">// be evaluated before URLFilters</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Leave it blank to allow any URLs to be visited</span></span><br><span class="line">	URLFilters []*regexp.Regexp</span><br><span class="line"></span><br><span class="line">	<span class="comment">// AllowURLRevisit allows multiple downloads of the same URL</span></span><br><span class="line">	AllowURLRevisit <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// MaxBodySize is the limit of the retrieved response body in bytes.</span></span><br><span class="line">	<span class="comment">// 0 means unlimited.</span></span><br><span class="line">	<span class="comment">// The default value for MaxBodySize is 10MB (10 * 1024 * 1024 bytes).</span></span><br><span class="line">	MaxBodySize <span class="keyword">int</span></span><br><span class="line">	<span class="comment">// CacheDir specifies a location where GET requests are cached as files.</span></span><br><span class="line">	<span class="comment">// When it's not defined, caching is disabled.</span></span><br><span class="line">	CacheDir <span class="keyword">string</span></span><br><span class="line">	<span class="comment">// IgnoreRobotsTxt allows the Collector to ignore any restrictions set by</span></span><br><span class="line">	<span class="comment">// the target host's robots.txt file.  See http://www.robotstxt.org/ for more</span></span><br><span class="line">	<span class="comment">// information.</span></span><br><span class="line">	IgnoreRobotsTxt <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// Async turns on asynchronous network communication. Use Collector.Wait() to</span></span><br><span class="line">	<span class="comment">// be sure all requests have been finished.</span></span><br><span class="line">	Async <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// ParseHTTPErrorResponse allows parsing HTTP responses with non 2xx status codes.</span></span><br><span class="line">	<span class="comment">// By default, Colly parses only successful HTTP responses. Set ParseHTTPErrorResponse</span></span><br><span class="line">	<span class="comment">// to true to enable it.</span></span><br><span class="line">	ParseHTTPErrorResponse <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// ID is the unique identifier of a collector</span></span><br><span class="line">	ID <span class="keyword">uint32</span></span><br><span class="line">	<span class="comment">// DetectCharset can enable character encoding detection for non-utf8 response bodies</span></span><br><span class="line">	<span class="comment">// without explicit charset declaration. This feature uses https://github.com/saintfish/chardet</span></span><br><span class="line">	DetectCharset <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// RedirectHandler allows control on how a redirect will be managed</span></span><br><span class="line">	<span class="comment">// use c.SetRedirectHandler to set this value</span></span><br><span class="line">	redirectHandler <span class="function"><span class="keyword">func</span><span class="params">(req *http.Request, via []*http.Request)</span> <span class="title">error</span></span></span><br><span class="line">	<span class="comment">// CheckHead performs a HEAD request before every GET to pre-validate the response</span></span><br><span class="line">	CheckHead <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// TraceHTTP enables capturing and reporting request performance for crawler tuning.</span></span><br><span class="line">	<span class="comment">// When set to true, the Response.Trace will be filled in with an HTTPTrace object.</span></span><br><span class="line">	TraceHTTP <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// Context is the context that will be used for HTTP requests. You can set this</span></span><br><span class="line">	<span class="comment">// to support clean cancellation of scraping.</span></span><br><span class="line">	Context context.Context</span><br><span class="line"></span><br><span class="line">	store                    storage.Storage</span><br><span class="line">	debugger                 debug.Debugger</span><br><span class="line">	robotsMap                <span class="keyword">map</span>[<span class="keyword">string</span>]*robotstxt.RobotsData</span><br><span class="line">	htmlCallbacks            []*htmlCallbackContainer</span><br><span class="line">	xmlCallbacks             []*xmlCallbackContainer</span><br><span class="line">	requestCallbacks         []RequestCallback</span><br><span class="line">	responseCallbacks        []ResponseCallback</span><br><span class="line">	responseHeadersCallbacks []ResponseHeadersCallback</span><br><span class="line">	errorCallbacks           []ErrorCallback</span><br><span class="line">	scrapedCallbacks         []ScrapedCallback</span><br><span class="line">	requestCount             <span class="keyword">uint32</span></span><br><span class="line">	responseCount            <span class="keyword">uint32</span></span><br><span class="line">	backend                  *httpBackend</span><br><span class="line">	wg                       *sync.WaitGroup</span><br><span class="line">	lock                     *sync.RWMutex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Init initializes the Collector's private variables and sets default</span></span><br><span class="line"><span class="comment">// configuration for the Collector</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Collector)</span> <span class="title">Init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c.UserAgent = <span class="string">"colly - https://github.com/gocolly/colly/v2"</span></span><br><span class="line">	c.MaxDepth = <span class="number">0</span></span><br><span class="line">	c.store = &amp;storage.InMemoryStorage&#123;&#125;</span><br><span class="line">	c.store.Init()</span><br><span class="line">	c.MaxBodySize = <span class="number">10</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">	c.backend = &amp;httpBackend&#123;&#125;</span><br><span class="line">	jar, _ := cookiejar.New(<span class="literal">nil</span>)</span><br><span class="line">	c.backend.Init(jar)</span><br><span class="line">	c.backend.Client.CheckRedirect = c.checkRedirectFunc()</span><br><span class="line">	c.wg = &amp;sync.WaitGroup&#123;&#125;</span><br><span class="line">	c.lock = &amp;sync.RWMutex&#123;&#125;</span><br><span class="line">	c.robotsMap = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]*robotstxt.RobotsData)</span><br><span class="line">	c.IgnoreRobotsTxt = <span class="literal">true</span></span><br><span class="line">	c.ID = atomic.AddUint32(&amp;collectorCounter, <span class="number">1</span>)</span><br><span class="line">	c.TraceHTTP = <span class="literal">false</span></span><br><span class="line">	c.Context = context.Background()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// NewCollector creates a new Collector instance with default configuration</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewCollector</span><span class="params">(options ...CollectorOption)</span> *<span class="title">Collector</span></span> &#123;</span><br><span class="line">	c := &amp;Collector&#123;&#125;</span><br><span class="line">	c.Init()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _, f := <span class="keyword">range</span> options &#123;</span><br><span class="line">		f(c)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	c.parseSettingsFromEnv()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Collector)</span> <span class="title">parseSettingsFromEnv</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> _, e := <span class="keyword">range</span> os.Environ() &#123;</span><br><span class="line">		<span class="keyword">if</span> !strings.HasPrefix(e, <span class="string">"COLLY_"</span>) &#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">		pair := strings.SplitN(e[<span class="number">6</span>:], <span class="string">"="</span>, <span class="number">2</span>)</span><br><span class="line">		<span class="keyword">if</span> f, ok := envMap[pair[<span class="number">0</span>]]; ok &#123;</span><br><span class="line">			f(c, pair[<span class="number">1</span>])</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			log.Println(<span class="string">"Unknown environment variable:"</span>, pair[<span class="number">0</span>])</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-02-15 19:57:36" itemprop="dateCreated datePublished" datetime="2022-02-15T19:57:36+08:00">2022-02-15</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>1.5k</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/2411485724.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> svn <i class="label-arrow"></i>
                                    </a>
                                    <a href="/2411485724.html" class="post-title-link" itemprop="url">svn rollback</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p><code>svn</code>使用 命令行实现rollback</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 查看前100条提交日志</span></span><br><span class="line">svn <span class="built_in">log</span> -v -l 100</span><br><span class="line">svn <span class="built_in">log</span> -v -l 100 &gt; svn_do.log</span><br><span class="line"><span class="comment"># 尝试回滚</span></span><br><span class="line">svn merge --dry-run -r 当前版本号:目标版本号 target_repo_addr</span><br><span class="line"><span class="comment"># 回滚</span></span><br><span class="line">svn merge -r 当前版本号:目标版本号 target_repo_addr</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-02-11 15:22:55" itemprop="dateCreated datePublished" datetime="2022-02-11T15:22:55+08:00">2022-02-11</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>18</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/4264397657.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> neovim <i class="label-arrow"></i>
                                    </a>
                                    <a href="/4264397657.html" class="post-title-link" itemprop="url">新一代vim-neovim</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 普通安装</span></span><br><span class="line">brew install neovim</span><br><span class="line"><span class="comment"># 开发版本安装</span></span><br><span class="line">brew install --HEAD luajit</span><br><span class="line">brew install --HEAD neovim</span><br><span class="line"><span class="comment"># 包安装</span></span><br><span class="line">curl -LO https://github.com/neovim/neovim/releases/download/nightly/nvim-macos.tar.gz</span><br><span class="line">tar xzf nvim-macos.tar.gz</span><br><span class="line">./nvim-osx64/bin/nvim</span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">nvim --version</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>熟悉的所有Vim命令都可以在Neovim中使用，Neovim的配置文件格式也与Vim相同。不过，.vimrc在Neovim中不会自动加载。Neovim的配置文件遵守XDG基本目录结构，即所有的配置文件都放在<code>~/.config</code><br>目录中。Neovim的配置文件被保存在<code>~/.config/nvim</code>中</p>
                                    <ul>
                                        <li>
                                            <p><code>~/.config/nvim/init.vim</code>对应于<code>~/.vimrc</code>。</p>
                                        </li>
                                        <li>
                                            <p><code>~/.config/nvim/</code>对应于<code>~/.vim/</code>。</p>
                                        </li>
                                    </ul>
                                    <h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2>
                                    <p>当然可以将Neovim的配置文件链接到Vim的配置文件</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 创建配置文件夹</span></span><br><span class="line">mkdir -p <span class="variable">$HOME</span>/.config</span><br><span class="line"><span class="comment"># 创建文件夹软连接</span></span><br><span class="line">ln -s <span class="variable">$HOME</span>/.vim <span class="variable">$HOME</span>/.config/nvim</span><br><span class="line"><span class="comment"># 创建配置文件软连接</span></span><br><span class="line">ln -s <span class="variable">$HOME</span>/.vimrc <span class="variable">$HOME</span>/.config/nvim/init.vim</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h2 id="初次使用neovim"><a href="#初次使用neovim" class="headerlink" title="初次使用neovim"></a>初次使用neovim</h2>
                                    <p>当在终端输入<code>nvim</code>时，将展示如下界面</p>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyprbge7raj30m50930te.jpg" alt="image-20220125112813654"></p>
                                    <p>使用<code>shfit + :</code> 并输入<code>checkhealth</code>进行依赖检查</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">python3 -m pip install neovim</span><br><span class="line">npm install -g neovim</span><br><span class="line">cpan Neovim::ext</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p>Neovim的默认选项与Vim有很大的不同。在现代的计算机世界里，文本编辑器的默认值需要对用户比较友好。默认情况下Vim的.vimrc文件并不包含任何默认设置，而Neovim默认已经设置好语法高亮、合理的缩进设置、wildmenu、高亮显示搜索结果和增量搜索（incsearch）等。可通过查看<code>:help nvim-defaults</code><br>了解Neovim的默认选项。</p>
                                    <p>我的配置：<a href="https://github.com/Payne-Wu/Bracket/blob/master/SystemInitialization/Vim/vimrc" target="_blank" rel="noopener">https://github.com/Payne-Wu/Bracket/blob/master/SystemInitialization/Vim/vimrc</a></p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-01-25 10:46:27" itemprop="dateCreated datePublished" datetime="2022-01-25T10:46:27+08:00">2022-01-25</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>560</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
                            <link itemprop="mainEntityOfPage" href="https://paynewu.com/3601801146.html">
                            <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <meta itemprop="image" content="/images/favicon/android-chrome-512x512.png">
                                <meta itemprop="name" content="吴志鹏">
                                <meta itemprop="description" content="Talk is free，please state clearly">
                            </span>
                            <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                                <meta itemprop="name" content="吴志鹏｜Payne-Wu">
                            </span>
                            <header class="post-header">
                                <h2 class="post-title" itemprop="name headline">
                                    <a class="label"> miniconda <i class="label-arrow"></i>
                                    </a>
                                    <a href="/3601801146.html" class="post-title-link" itemprop="url">miniconda安装与配置</a>
                                </h2>
                            </header>
                            <div class="post-body" itemprop="articleBody">
                                <div class="thumb">
                                    <img itemprop="contentUrl" class="random">
                                </div>
                                <div class="excerpt">
                                    <p>
                                    <p>在科学计算、深度学习、机器学习等领域 Python 语言拥有举足轻重的地位,Python 开发环境,相关链接如下：</p>
                                    <ul>
                                        <li>
                                            <p>PyPi(第三方库)地址： <a href="https://pypi.org/" target="_blank" rel="noopener">https://pypi.org/</a></p>
                                        </li>
                                        <li>
                                            <p>Anconda 官方地址： <a href="https://www.anaconda.com/" target="_blank" rel="noopener">https://www.anaconda.com/</a></p>
                                        </li>
                                        <li>
                                            <p>Anconda 官方文档： <a href="https://docs.conda.io/projects/conda/en/latest/userguide/install/index.html" target="_blank" rel="noopener">https://docs.conda.io/projects/conda/en/latest/userguide/install/index.html</a></p>
                                        </li>
                                        <li>
                                            <p>Anconda 下载地址： <a href="https://www.anaconda.com/products/individual#Downloads" target="_blank" rel="noopener">https://www.anaconda.com/products/individual#Downloads</a></p>
                                        </li>
                                        <li>
                                            <p>Anconda Installer repo: <a href="https://repo.anaconda.com/archive/" target="_blank" rel="noopener">https://repo.anaconda.com/archive/</a></p>
                                        </li>
                                        <li>
                                            <p>Miniconda 下载地址：<a href="https://docs.conda.io/en/latest/miniconda.html" target="_blank" rel="noopener">https://docs.conda.io/en/latest/miniconda.html</a></p>
                                        </li>
                                        <li>
                                            <p>Miniconda Installer repo: <a href="https://repo.anaconda.com/miniconda/" target="_blank" rel="noopener">https://repo.anaconda.com/miniconda/</a></p>
                                        </li>
                                    </ul>
                                    <p>安装 Python 的方式有很多种，但根据所需，Anconda 无疑是最好的选择。在这里以 Miniconda 为例，在 Windows、macOS 平台下的安装。</p>
                                    <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                                    <figure class="highlight sh">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># Mac x86</span></span><br><span class="line">wget -c https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh &amp;&amp; sh Miniconda3-latest-MacOSX-x86_64.sh </span><br><span class="line"><span class="comment"># Mac m1</span></span><br><span class="line">wget -c https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-arm64.sh &amp;&amp; sh Miniconda3-latest-MacOSX-arm64.sh </span><br><span class="line"><span class="comment"># Linux</span></span><br><span class="line">wget -c https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh &amp;&amp; sh Miniconda3-latest-Linux-x86_64.sh</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>点击此<a href="https://repo.anaconda.com/miniconda/Miniconda3-latest-Windows-x86_64.exe" target="_blank" rel="noopener">Windows</a> 下载安装程序</p>
                                    </blockquote>
                                    <h2 id="配置终端显示"><a href="#配置终端显示" class="headerlink" title="配置终端显示"></a>配置终端显示</h2>
                                    <h3 id="Linux-or-Mac"><a href="#Linux-or-Mac" class="headerlink" title="Linux or Mac"></a>Linux or Mac</h3>
                                    <figure class="highlight sh">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">conda config --<span class="built_in">set</span> auto_activate_base <span class="literal">false</span></span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3>
                                    <figure class="highlight powershell">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> <span class="literal">-ExecutionPolicy</span> RemoteSigned</span><br><span class="line">conda init -<span class="literal">-all</span></span><br><span class="line">conda config -<span class="literal">-set</span> changeps1 false</span><br><span class="line">conda config -<span class="literal">-set</span> auto_activate_base false</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <blockquote>
                                        <p>注意: 需要在管理员权限下</p>
                                    </blockquote>
                                    <h2 id="设置镜像源"><a href="#设置镜像源" class="headerlink" title="设置镜像源"></a>设置镜像源</h2>
                                    <p>不得不说<code>Anconda</code>是个非常不错的科学计算包管理工具（当然不限与Python，而笔者主要用conda来管理虚拟环境等），使用conda来管理的时 候难免会遇到国外网络的各种意外。对于此最简单的方法就是使用咱们国内的镜像源。使用方式如下</p>
                                    <figure class="highlight bash">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line"><span class="comment"># 增加 镜像地址</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><strong>查看配置</strong></p>
                                    <figure class="highlight routeros">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">conda<span class="built_in"> config </span>--show-sources</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>
                                    <p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gx43066thhj30i503qwes.jpg" alt="image-20211206140953931"></p>
                                    <p>当然也可以通过配置文件<code>.condarc</code>来修改，但笔者并不建议。在此遍不再过多赘述。</p>
                                    </p>
                                </div>
                            </div>
                            <div class="post-meta">
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-user"></i>
                                    </span>
                                    <span class="post-meta-item-text">作者</span>
                                    <span><a href="/authors/Payne" class="author" itemprop="url" rel="index">Payne</a></span>
                                </span>
                                <span class="post-meta-item">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-calendar"></i>
                                    </span>
                                    <span class="post-meta-item-text">发表于</span>
                                    <time title="创建时间：2022-01-10 13:29:40" itemprop="dateCreated datePublished" datetime="2022-01-10T13:29:40+08:00">2022-01-10</time>
                                </span>
                                <br>
                                <span class="post-meta-item" title="本文字数">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-file-word"></i>
                                    </span>
                                    <span class="post-meta-item-text">本文字数：</span>
                                    <span>743</span>
                                </span>
                                <span class="post-meta-item" title="阅读时长">
                                    <span class="post-meta-item-icon">
                                        <i class="far fa-clock"></i>
                                    </span>
                                    <span class="post-meta-item-text">阅读时长 &asymp;</span>
                                    <span>1 分钟</span>
                                </span>
                            </div>
                        </article>
                        <script>
                            document.querySelectorAll('.random').forEach(item => item.src = "https://picsum.photos/id/" + Math.floor(Math.random() * Math.floor(300)) + "/200/133")

                        </script>
                        <nav class="pagination">
                            <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
                        </nav>
                    </div>
                    <script>
                        window.addEventListener('tabs:register', () =>
                        {
                            let
                            {
                                activeClass
                            } = CONFIG.comments;
                            if (CONFIG.comments.storage)
                            {
                                activeClass = localStorage.getItem('comments_active') || activeClass;
                            }
                            if (activeClass)
                            {
                                let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
                                if (activeTab)
                                {
                                    activeTab.click();
                                }
                            }
                        });
                        if (CONFIG.comments.storage)
                        {
                            window.addEventListener('tabs:click', event =>
                            {
                                if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
                                let commentClass = event.target.classList[1];
                                localStorage.setItem('comments_active', commentClass);
                            });
                        }

                    </script>
                </div>
                <div class="toggle sidebar-toggle">
                    <span class="toggle-line toggle-line-first"></span>
                    <span class="toggle-line toggle-line-middle"></span>
                    <span class="toggle-line toggle-line-last"></span>
                </div>
                <aside class="sidebar">
                    <div class="sidebar-inner">
                        <ul class="sidebar-nav motion-element">
                            <li class="sidebar-nav-toc"> 文章目录 </li>
                            <li class="sidebar-nav-overview"> 站点概览 </li>
                        </ul>
                        <!--noindex-->
                        <div class="post-toc-wrap sidebar-panel">
                        </div>
                        <!--/noindex-->
                        <div class="site-overview-wrap sidebar-panel">
                            <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
                                <img class="site-author-image" itemprop="image" alt="吴志鹏" src="/images/favicon/android-chrome-512x512.png">
                                <p class="site-author-name" itemprop="name">吴志鹏</p>
                                <div class="site-description" itemprop="description">Talk is free，please state clearly</div>
                            </div>
                            <div class="site-state-wrap motion-element">
                                <nav class="site-state">
                                    <div class="site-state-item site-state-posts">
                                        <a href="/archives/">
                                            <span class="site-state-item-count">136</span>
                                            <span class="site-state-item-name">日志</span>
                                        </a>
                                    </div>
                                    <div class="site-state-item site-state-categories">
                                        <a href="/categories/">
                                            <span class="site-state-item-count">158</span>
                                            <span class="site-state-item-name">分类</span></a>
                                    </div>
                                    <div class="site-state-item site-state-tags">
                                        <a href="/tags/">
                                            <span class="site-state-item-count">89</span>
                                            <span class="site-state-item-name">标签</span></a>
                                    </div>
                                </nav>
                            </div>
                            <div class="links-of-author motion-element">
                                <span class="links-of-author-item">
                                    <a href="https://github.com/Payne-Wu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Payne-Wu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
                                </span>
                                <span class="links-of-author-item">
                                    <a href="mailto:wuzhipeng1289690157@gmail.com" title="E-Mail → mailto:wuzhipeng1289690157@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
                                </span>
                                <span class="links-of-author-item">
                                    <a href="https://www.zhihu.com/people/wu-zhi-peng-72-78" title="ZhiHu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;wu-zhi-peng-72-78" rel="noopener" target="_blank"><i class="fa fa-magic fa-fw"></i>ZhiHu</a>
                                </span>
                                <span class="links-of-author-item">
                                    <a href="https://weibo.com/u/6987234483" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6987234483" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
                                </span>
                            </div>
                        </div>
                    </div>
                </aside>
                <div id="sidebar-dimmer"></div>
            </div>
        </main>
        <footer class="footer">
            <div class="footer-inner">
                <div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span>
                    <span class="with-love">
                        <i class="fa fa-heart"></i>
                    </span>
                    <span class="author" itemprop="copyrightHolder">PayneWu</span>
                    <span class="post-meta-divider">|</span>
                    <span class="post-meta-item-icon">
                        <i class="fa fa-chart-area"></i>
                    </span>
                    <span title="站点总字数">255k</span>
                    <span class="post-meta-divider">|</span>
                    <span class="post-meta-item-icon">
                        <i class="fa fa-coffee"></i>
                    </span>
                    <span title="站点阅读时长">3:51</span>
                </div>
                <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">湘ICP备2021019893号-1 </a>
                </div>
                <div style="display: none;">
                    <script src="//s95.cnzz.com/z_stat.php?id=true&web_id=true"></script>
                </div>
            </div>
        </footer>
    </div>
    <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/.js"></script>
    <script src="/js/schemes/pisces.js"></script>
    <script src="/.js"></script>
    <script src="/js/next-boot.js"></script>
    <script src="/.js"></script>
    <script>
        (function ()
        {
            var canonicalURL, curProtocol;
            //Get the <link> tag
            var x = document.getElementsByTagName("link");
            //Find the last canonical URL
            if (x.length > 0)
            {
                for (i = 0; i < x.length; i++)
                {
                    if (x[i].rel.toLowerCase() == 'canonical' && x[i].href)
                    {
                        canonicalURL = x[i].href;
                    }
                }
            }
            //Get protocol
            if (!canonicalURL)
            {
                curProtocol = window.location.protocol.split(':')[0];
            }
            else
            {
                curProtocol = canonicalURL.split(':')[0];
            }
            //Get current URL if the canonical URL does not exist
            if (!canonicalURL) canonicalURL = window.location.href;
            //Assign script content. Replace current URL with the canonical URL
            ! function ()
            {
                var e = /([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,
                    r = canonicalURL,
                    t = document.referrer;
                if (!e.test(r))
                {
                    var n = (String(curProtocol).toLowerCase() === 'https') ? "https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif" : "//api.share.baidu.com/s.gif";
                    t ? (n += "?r=" + encodeURIComponent(document.referrer), r && (n += "&l=" + r)) : r && (n += "?l=" + r);
                    var i = new Image;
                    i.src = n
                }
            }(window);
        })();

    </script>
    <script src="/js/local-search.js"></script>
    <script src="/.js"></script>
</body>

</html>
